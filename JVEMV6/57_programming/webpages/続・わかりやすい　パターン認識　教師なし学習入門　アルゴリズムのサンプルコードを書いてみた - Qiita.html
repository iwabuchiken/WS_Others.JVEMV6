<!DOCTYPE html>
<!-- saved from url=(0058)https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca -->
<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport"><meta content="#55c500" name="theme-color"><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification"><meta content="telephone=no" name="format-detection"><link rel="canonical" href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca"><link href="https://qiita.com/manifest.json" rel="manifest"><link href="https://qiita.com/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml"><link as="script" href="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/gpt.js" rel="preload"><link href="https://securepubads.g.doubleclick.net/" rel="preconnect"><script type="text/javascript" charset="UTF-8" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/lift.json"></script><script type="text/javascript" charset="UTF-8" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/im-uid-hook.js"></script><script async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/im-uid.js"></script><script type="text/javascript" charset="UTF-8" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/lift.json"></script><script type="text/javascript" charset="UTF-8" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/im-uid-hook.js"></script><script type="text/javascript" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/combo" async=""></script><script async="">window.a1tracker&&a1tracker.ready(function(tracker){var doh="ff9a3577423c8ed5";if(!doh)return;var params={"event":"","url":"","referrer":"","metakeywords":"","callback":""};if(params.url)tracker.setParams(doh,"url",params.url);if(params.referrer)tracker.setParams(doh,"referrer",params.referrer);if(params.metakeywords){var mk=tracker.getParams(doh,"metakeywords");Array.prototype.push.apply(mk,params.metakeywords.split(","));tracker.setParams(doh,"metakeywords",mk)}tracker.setParams(doh,"tagsource","itm_a1common");var callback=params.callback&&typeof window[params.callback]==="function"?function(err,data){if(!err&&data.segments.length>0)window[params.callback](data.segments);return}:function(){};if(params.event)tracker.send(doh,params.event.split(","),callback);else tracker.send(doh,callback)});</script><script async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/tracking.min.js"></script><script type="text/javascript" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/analytics.js"></script><script type="text/javascript" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/js"></script><script type="text/javascript" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/f.txt"></script><script async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/ff9a3577423c8ed5_4330.js"></script><script type="text/javascript" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/td.min.js"></script><script src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/1792588824374455" async=""></script><script src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/305156090176370" async=""></script><script async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/fbevents.js"></script><script async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/gpt.js"></script><meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="Jf/ereZJrXPZbx9tM0NTHbO1RI3qoyoWAmZTtsWH04DXUuDWsVozBhRxkhOqnuUQiCmyEkvUKKzQRpnhfMyGcg=="><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico"><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png"><link rel="stylesheet" media="all" href="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/article-f83500ef89752973ac6ebd32f26c1985.min.css"><script src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/v3-article-bundle-22eca92616d7bdfaabf58388544806f1.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site"><meta property="og:type" content="article"><meta property="og:title" content="続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-9f5428127621718a910c8b63951390ad.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTkxNiZ0eHQ9JUU3JUI2JTlBJUUzJTgzJUJCJUUzJTgyJThGJUUzJTgxJThCJUUzJTgyJThBJUUzJTgyJTg0JUUzJTgxJTk5JUUzJTgxJTg0JUUzJTgwJTgwJUUzJTgzJTkxJUUzJTgyJUJGJUUzJTgzJUJDJUUzJTgzJUIzJUU4JUFBJThEJUU4JUFEJTk4JUUzJTgwJTgwJUU2JTk1JTk5JUU1JUI4JUFCJUUzJTgxJUFBJUUzJTgxJTk3JUU1JUFEJUE2JUU3JUJGJTkyJUU1JTg1JUE1JUU5JTk2JTgwJUUzJTgwJTgwJUUzJTgyJUEyJUUzJTgzJUFCJUUzJTgyJUI0JUUzJTgzJUFBJUUzJTgyJUJBJUUzJTgzJUEwJUUzJTgxJUFFJUUzJTgyJUI1JUUzJTgzJUIzJUUzJTgzJTk3JUUzJTgzJUFCJUUzJTgyJUIzJUUzJTgzJUJDJUUzJTgzJTg5JUUzJTgyJTkyJUU2JTlCJUI4JUUzJTgxJTg0JUUzJTgxJUE2JUUzJTgxJUJGJUUzJTgxJTlGJnR4dC1jb2xvcj0lMjMyMTIxMjEmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTYmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWxlZnQlMkN0b3Amcz1hNWE1OGFlZjFkZGY5ODVjYTA1NzEwOTdhNzg3NGE0MA&amp;mark-x=142&amp;mark-y=112&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTYxNiZ0eHQ9JTQwYWtpcmFpY2hpNTQzMCZ0eHQtY29sb3I9JTIzMjEyMTIxJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTM2JnR4dC1hbGlnbj1sZWZ0JTJDdG9wJnM9NzFkZmYxN2MyNzY3OTRkNmE2YzJhYjQzOTBjNmNkNWM&amp;blend-x=142&amp;blend-y=491&amp;blend-mode=normal&amp;s=5969c6653d598e6310198517b551d2a9"><meta property="og:description" content="「続・わかりやすい パターン認識 教師なし学習入門」ではアルゴリズムのサンプルコードが公開されていません。そこで、自分で書いてみました。
なお、具体的に実験をした結果はGithubで公開しています。


目次



5章 教師付き学習..."><meta content="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca" property="og:url"><meta content="Qiita" property="og:site_name"><meta content="564524038" property="fb:admins"><meta content="Python3,パターン認識" name="keywords"><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '305156090176370');
fbq('trackSingle', '305156090176370', 'PageView');</script><meta http-equiv="origin-trial" content="A+cA2PUOfIOKAdSDJOW5CP9ZlxONy1yu+hqAq72zUtKw4rLdihqRp6Nui/jUyCyegr+BUtH+C+Elv0ufn05yBQEAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A+zsdH3aNZT/bkjT8U/o5ACzyaeNYzTvtoVmwf/KOilfv39pxY2AIsOwhQJv+YnXp98i3TqrQibIVtMWs5UHjgoAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="AxceVEhIegcDEHqLXFQ2+vPKqzCppoJYsRCZ/BdfVnbM/sUUF2BXV8lwNosyYjvoxnTh2FC8cOlAnA5uULr/zAUAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><script src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/pubads_impl_2022081701.js" async=""></script><noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=305156090176370&ev=PageView&noscript=1"/></noscript><style data-emotion-css="92283 vnk55c 1ibnx62 1x8nfy4 1duml6f nje458 1otwww0 tubf1g nb6j9u kfddif 19m4w61 cgslon 79elbk 1ydfkyi l40u17 1gj7nt 1g6mqq7 amwp7n 1ode1bp x9qlq8 2ycz42 1nt9rv7 qgrf2v 1hbd3g7 u681u4 hxgmls r67lmd 8qb8m4 2imjyh 17zza1i 70qvj9 6su6fj 1ndxrmk 1r4slzx 772dpg 17ay39c 1ay9vb9 188vyrl 1wa99t2 1l3zk9f 1a610x3 189rs1q 1yzj1fm l1ga49 1un4bh8 1zr5f9 dwar2a 1n56tva 1ty75sn 16dbybf st6exv gjiyxx 5jpx49 10h2231 3ebp5j 1o09fmu 7i7f4d" }="">.css-92283{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.css-vnk55c{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1199px){.css-vnk55c{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:991px){.css-vnk55c{-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:769px){.css-vnk55c{display:block;}}@media (max-width:479px){.css-vnk55c{padding-top:0;}}.css-1ibnx62{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}@media (max-width:769px){.css-1ibnx62{display:none;}}.css-1x8nfy4{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-bottom:16px;}.css-1duml6f{height:40px;width:40px;position:relative;}.css-1duml6f svg{cursor:auto;pointer-events:none;}.css-nje458{background-color:transparent;border:none;cursor:pointer;height:40px;padding:0;position:absolute;width:40px;}.css-1otwww0{color:#55c500;cursor:pointer;font-size:14px;font-weight:bold;}.css-tubf1g{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-bottom:16px;}.css-nb6j9u{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#ffffff;border:2px solid #5f6161;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:2px 0px 0px;width:40px;}.css-kfddif{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#5f6161;}.css-19m4w61{color:#5f6161;font-size:14px;font-weight:bold;}.css-cgslon{border:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;border-radius:50%;color:rgba(0,0,0,0.6);cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-bottom:16px;padding:0;width:32px;}.css-79elbk{position:relative;}.css-1ydfkyi{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;border-radius:50%;color:rgba(0,0,0,0.6);cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:0;width:32px;}.css-l40u17{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:-187px;}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-1g6mqq7{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-1g6mqq7:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#edeeee;}.css-amwp7n{color:rgba(0,0,0,0.6);font-size:14px;margin-right:4px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-x9qlq8{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:4px;width:18px;}.css-2ycz42{display:inline-block;vertical-align:middle;height:14px;width:14px;fill:rgba(0,0,0,0.6);}.css-1nt9rv7{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#ffffff;color:rgba(0,0,0,0.87);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:16px;line-height:1.8;padding:4px 16px;width:100%;}.css-1nt9rv7:hover{background-color:#edeeee;}.css-qgrf2v{box-sizing:border-box;cursor:pointer;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:600;line-height:1.8;margin-bottom:0;min-height:34px;min-width:64px;padding:8px 12px;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;white-space:nowrap;-webkit-transition:.1s ease-out;transition:.1s ease-out;-webkit-transition-property:background-color,border-color;transition-property:background-color,border-color;background-color:#55c500;border:2px solid #55c500;color:#ffffff;}.css-qgrf2v:disabled{box-shadow:none;cursor:not-allowed;opacity:0.38;}.css-qgrf2v:active{background-color:#46a900;border-color:#46a900;}@media (hover:hover) and (pointer:fine){.css-qgrf2v:hover{background-color:#46a900;border-color:#46a900;}}.css-1hbd3g7{height:250px;}.css-u681u4{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#fcf0bf;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:769px){.css-u681u4{padding:16px;}}.css-hxgmls{color:#d58d2c;margin-right:4px;}.css-r67lmd{background-color:#ffffff;padding:32px;margin-bottom:24px;}@media (max-width:991px){.css-r67lmd{margin:0 auto 40px;}}@media (max-width:479px){.css-r67lmd{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-17zza1i{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:14px;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;line-height:1.8;width:100%;}@media (max-width:769px){.css-17zza1i{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-6su6fj{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}.css-1ndxrmk{display:inline-block;border-radius:50%;height:24px;line-height:1;object-fit:contain;overflow:hidden;vertical-align:middle;width:24px;}.css-1r4slzx{line-height:1.5;margin-left:4px;}.css-772dpg{color:rgba(0,0,0,0.87);font-weight:600;word-break:break-all;}.css-17ay39c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;color:rgba(0,0,0,0.6);}.css-1ay9vb9{margin-right:16px;}.css-188vyrl{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-1a610x3{color:inherit;font-size:14px;line-height:1.8;z-index:1;}.css-189rs1q{margin-left:2px;margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-l1ga49{border:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:rgba(0,0,0,0.6);cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-1un4bh8{max-width:840px;width:90%;margin:40px auto;padding:16px;border:1px solid #55c500;background-position:95% 85%;background-image:url(//cdn.qiita.com/assets/public/qiitan-for-login-modal-014e085d3e40a240e3fe8d61b70b29a9.png);background-size:150px;background-repeat:no-repeat;}@media (max-width:769px){.css-1un4bh8{width:100%;background-image:none;padding-left:8px;padding-right:8px;}}.css-1zr5f9{font-size:24px;font-weight:600;text-align:center;margin-top:16px;margin-bottom:16px;}@media (max-width:769px){.css-1zr5f9{text-align:left;margin-top:24px;}}.css-dwar2a{text-align:left;font-weight:600;font-size:20px;margin-top:32px;margin-bottom:24px;margin-left:32px;}@media (max-width:769px){.css-dwar2a{display:none;}}.css-1n56tva{font-size:16px;color:rgba(0,0,0,0.6);margin-top:8px;margin-bottom:24px;max-width:420px;word-break:break-all;}.css-1ty75sn{color:#55c500;font-size:16px;margin-top:16px;margin-bottom:16px;}.css-16dbybf{box-sizing:border-box;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:600;line-height:1.8;min-height:34px;min-width:64px;opacity:1;padding:8px 12px;pointer-events:auto;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;white-space:nowrap;-webkit-transition:.1s ease-out;transition:.1s ease-out;-webkit-transition-property:background-color,border-color;transition-property:background-color,border-color;background-color:#55c500;border:2px solid #55c500;color:#ffffff;margin:16px;}.css-16dbybf:hover{-webkit-text-decoration:none;text-decoration:none;}.css-16dbybf:active{background-color:#46a900;border-color:#46a900;}@media (hover:hover) and (pointer:fine){.css-16dbybf:hover{background-color:#46a900;border-color:#46a900;}}@media (max-width:769px){.css-16dbybf{display:block;width:auto;margin-left:0;margin-right:0;font-size:16px;}}.css-st6exv{box-sizing:border-box;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:600;line-height:1.8;min-height:34px;min-width:64px;opacity:1;padding:8px 12px;pointer-events:auto;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;white-space:nowrap;-webkit-transition:.1s ease-out;transition:.1s ease-out;-webkit-transition-property:background-color,border-color;transition-property:background-color,border-color;background-color:#ffffff;border:2px solid #bcbdbd;color:#5f6161;margin:16px;}.css-st6exv:hover{-webkit-text-decoration:none;text-decoration:none;}.css-st6exv:active{background-color:#f5f6f6;}@media (hover:hover) and (pointer:fine){.css-st6exv:hover{background-color:#f5f6f6;}}@media (max-width:769px){.css-st6exv{display:block;width:auto;margin-left:0;margin-right:0;font-size:16px;}}.css-gjiyxx{background-color:#ffffff;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:769px){.css-gjiyxx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-10h2231{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.css-3ebp5j{color:#55c500;cursor:pointer;font-size:14px;font-weight:bold;margin-left:8px;}.css-1o09fmu{color:#5f6161;font-size:14px;font-weight:bold;margin-left:8px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style><script>window.frtn=window.frtn||function(){ (frtn.q=frtn.q||[]).push(arguments) };
frtn("init",{
service_id:"cova_248",
site_id:"site_134",
tag_id:"tag_283"
});
frtn("send","pageview");</script><script defer="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/insight.js" type="text/javascript"></script><script>!function(t,e){if(void 0===e[t]){e[t]=function(){e[t].clients.push(this),this._init=[Array.prototype.slice.call(arguments)]},e[t].clients=[];for(var r=function(t){return function(){return this["_"+t]=this["_"+t]||[],this["_"+t].push(Array.prototype.slice.call(arguments)),this}},s=["addRecord","blockEvents","fetchServerCookie","fetchGlobalID","fetchUserSegments","resetUUID","ready","setSignedMode","setAnonymousMode","set","trackEvent","trackPageview","trackClicks","unblockEvents"],n=0;n<s.length;n++){var c=s[n];e[t].prototype[c]=r(c)}var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=("https:"===document.location.protocol?"https:":"http:")+"//cdn.treasuredata.com/sdk/2.5/td.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)}}("Treasure",this);

// Configure an instance for your database
var td = new Treasure({
  host: 'in.treasuredata.com',
  writeKey: '10614/e3887673c1849754466b09ad01b4fbbc22b88f30',
  database: 'qiita_public',
  startInSignedMode: true
});

var success = function() {
  syncGoogleDDPv2();
};

var failure = function() {
  syncGoogleDDPv2();
}

var syncGoogleDDPv2 = function() {
  var ddp_destination = 'cm.g.doubleclick.net/pixel'
      + '?google_nid=treasuredata_dmp'
      + '&google_hm=' + btoa(self.td.client.track.uuid).replace(/\//g, '_').replace(/\+/g, '-').replace(/=/g, '');

  var n = document.createElement("img");
  n.src = ("https:" == document.location.protocol ? "https://" : "http://") + ddp_destination;
  n.width = 1;
  n.height = 1;
  n.style.display = "none";
  document.body.appendChild(n);
}

// Enable cross-domain tracking
td.set('$global', 'td_global_id', 'td_global_id');
// Track pageview information to 'pageviews' table
td.set('pageviews_all', {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"akiraichi5430","type":"items","id":"60ce2829a1b72dce5bca"},"request_id":"2aa290eb-9132-486b-a090-f0a93b706118","user_id":null})
td.trackPageview('pageviews_all', success, failure);</script><script src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/js(1)"></script><meta http-equiv="origin-trial" content="A7bG5hJ4XpMV5a3V1wwAR0PalkFSxLOZeL9D/YBYdupYUIgUgGhfVJ1zBFOqGybb7gRhswfJ+AmO7S2rNK2IOwkAAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1RoaXJkUGFydHkiOnRydWV9"><style data-emotion="css"></style><style data-jss="" data-meta="MuiTooltip">
.MuiTooltip-popper {
  z-index: 1500;
  pointer-events: none;
}
.MuiTooltip-popperInteractive {
  pointer-events: auto;
}
.MuiTooltip-popperArrow[x-placement*="bottom"] .MuiTooltip-arrow {
  top: 0;
  left: 0;
  margin-top: -0.71em;
  margin-left: 4px;
  margin-right: 4px;
}
.MuiTooltip-popperArrow[x-placement*="top"] .MuiTooltip-arrow {
  left: 0;
  bottom: 0;
  margin-left: 4px;
  margin-right: 4px;
  margin-bottom: -0.71em;
}
.MuiTooltip-popperArrow[x-placement*="right"] .MuiTooltip-arrow {
  left: 0;
  width: 0.71em;
  height: 1em;
  margin-top: 4px;
  margin-left: -0.71em;
  margin-bottom: 4px;
}
.MuiTooltip-popperArrow[x-placement*="left"] .MuiTooltip-arrow {
  right: 0;
  width: 0.71em;
  height: 1em;
  margin-top: 4px;
  margin-right: -0.71em;
  margin-bottom: 4px;
}
.MuiTooltip-popperArrow[x-placement*="left"] .MuiTooltip-arrow::before {
  transform-origin: 0 0;
}
.MuiTooltip-popperArrow[x-placement*="right"] .MuiTooltip-arrow::before {
  transform-origin: 100% 100%;
}
.MuiTooltip-popperArrow[x-placement*="top"] .MuiTooltip-arrow::before {
  transform-origin: 100% 0;
}
.MuiTooltip-popperArrow[x-placement*="bottom"] .MuiTooltip-arrow::before {
  transform-origin: 0 100%;
}
.MuiTooltip-tooltip {
  color: #fff;
  padding: 4px 8px;
  font-size: 0.625rem;
  max-width: 300px;
  word-wrap: break-word;
  font-family: "Roboto", "Helvetica", "Arial", sans-serif;
  font-weight: 500;
  line-height: 1.4em;
  border-radius: 4px;
  background-color: rgba(97, 97, 97, 0.9);
}
.MuiTooltip-tooltipArrow {
  margin: 0;
  position: relative;
}
.MuiTooltip-arrow {
  color: rgba(97, 97, 97, 0.9);
  width: 1em;
  height: 0.71em;
  overflow: hidden;
  position: absolute;
  box-sizing: border-box;
}
.MuiTooltip-arrow::before {
  width: 100%;
  height: 100%;
  margin: auto;
  content: "";
  display: block;
  transform: rotate(45deg);
  background-color: currentColor;
}
.MuiTooltip-touch {
  padding: 8px 16px;
  font-size: 0.875rem;
  font-weight: 400;
  line-height: 1.14286em;
}
.MuiTooltip-tooltipPlacementLeft {
  margin: 0 24px ;
  transform-origin: right center;
}
@media (min-width:600px) {
  .MuiTooltip-tooltipPlacementLeft {
    margin: 0 14px;
  }
}
.MuiTooltip-tooltipPlacementRight {
  margin: 0 24px;
  transform-origin: left center;
}
@media (min-width:600px) {
  .MuiTooltip-tooltipPlacementRight {
    margin: 0 14px;
  }
}
.MuiTooltip-tooltipPlacementTop {
  margin: 24px 0;
  transform-origin: center bottom;
}
@media (min-width:600px) {
  .MuiTooltip-tooltipPlacementTop {
    margin: 14px 0;
  }
}
.MuiTooltip-tooltipPlacementBottom {
  margin: 24px 0;
  transform-origin: center top;
}
@media (min-width:600px) {
  .MuiTooltip-tooltipPlacementBottom {
    margin: 14px 0;
  }
}
</style><script type="text/x-mathjax-config">MathJax.Hub.Config({
    skipStartupTypeset: true,
    showProcessingMessages: false,
    tex2jax: {
      inlineMath: [['$', '$']],
      displayMath: [['$$', '$$']],
      processEscapes: true,
      processEnvironments: false,
      processRefs: false,
      skipTags: ['script','noscript','style','textarea','pre','code','a','h1','h2','h3','h4','h5','h6']
    },
    "HTML-CSS": { 
      linebreaks: { automatic: true }
   }
   })</script><link rel="preload" href="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/f(1).txt" as="script"><script type="text/javascript" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/f(1).txt"></script><link rel="preload" href="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/f(2).txt" as="script"><script type="text/javascript" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/f(2).txt"></script><script type="text/javascript" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/f(3).txt"></script><script type="text/javascript" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/f(4).txt"></script><script type="text/javascript" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/f(5).txt"></script><script type="text/javascript" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/f(6).txt"></script><script type="text/javascript" async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/f(7).txt"></script><link rel="prefetch" href="https://qiita.com/organizations" as="document"><script src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/lift_widget.js"></script><style type="text/css">#logly-lift-4279493 #logly-lift-widget {
  
  width: 100%;
  
  
  
  clear: both;
}

#logly-lift-4279493 #logly-lift-widget-label {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  
  border-bottom-color: #5C97FF;
  
}

#logly-lift-4279493 #logly-lift-widget-label-caption {
  padding: 5px 10px;
  
  background-color: #5C97FF;
  
  float: left;
}

#logly-lift-4279493 #logly-lift-widget-label-caption a {
  
  color: #FFFFFF;
  
  
  text-decoration: none;
}

#logly-lift-4279493 .logly-lift-ad {
  display: inline-block;
  zoom: 1;
  vertical-align:top;
  
  width: 100%;
  
  margin: 5px 0;
  padding: 0;
}



#logly-lift-4279493 .logly-lift-ad-image {
  
  vertical-align: top;
  width: 120px;
  height: 90px;
  padding-right: 0;
}

#logly-lift-4279493 .logly-lift-ad-image-inner {
  position: relative;
  overflow: hidden;
  width: 120px;
  height: 90px;
}

#logly-lift-4279493 .logly-lift-ad-image-inner a {
  display: block;
  height: 100%;
}

#logly-lift-4279493 .logly-lift-ad-image-inner a .logly-lift-ad-img-inner {
  height: 100%;
  background-position: center;
  background-size: cover;
}

#logly-lift-4279493 .logly-lift-ad-content {
  
  word-break: break-all;
}



#logly-lift-4279493 .logly-lift-ad-title {
  
  
}



#logly-lift-4279493 .logly-lift-ad-lead {
  
  
}



#logly-lift-4279493 a.logly-lift-ad-site {
  
  
}





#logly-lift-4279493 .logly-lift-ad-disclosure {
  
  
  
  text-align: left;
  
}

#logly-lift-4279493 .logly-lift-ad-disclosure a {
  
  
  color: #999999;
  
}

#logly-lift-4279493 .logly-lift-clear {
  clear: both;
}



#logly-lift-4279493 .ie-lte9 .logly-lift-ad {
  display: inline;
}

#logly-lift-toaster .logly-lift-credit,
#logly-lift-4279493 .logly-lift-credit {
  clear:both;
  padding:0 8px 10px;
  text-align:right;
}

#logly-lift-toaster .logly-lift-credit {
  padding-right:0;
}

#logly-lift-toaster .logly-lift-credit a,
#logly-lift-4279493 .logly-lift-credit a {
  color: #999;
  text-decoration: none;
  font-size:13px;
}

#logly-lift-toaster .logly-lift-credit a .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit a .logly-lift-credit-logo {
  display:inline-block;
  background: url('https://cdn.logly.co.jp/spritesource-s5c12c753d2.webp') no-repeat 0 -103px;
  color:transparent;
  margin-left:3px;
  width:36px;
  height:14px;
  vertical-align:middle;
  *display:inline;
  *zoom:1;
}

#logly-lift-toaster .logly-lift-credit a:hover .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit a:hover .logly-lift-credit-logo {
  background: url('https://cdn.logly.co.jp/spritesource-s5c12c753d2.webp') no-repeat 0 -117px;
}

#logly-lift-toaster .logly-lift-credit2 a .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a .logly-lift-credit-logo,
#logly-lift-toaster .logly-lift-credit2 a:hover .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a:hover .logly-lift-credit-logo,
#logly-lift-modal-contents-inner h3 {
  background-image: url('https://cdn.logly.co.jp/spritesource-v74j50a002.webp');
  background-repeat: no-repeat;
}

#logly-lift-toaster .logly-lift-credit2 a .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a .logly-lift-credit-logo {
  background-position: 0 -110px;
  height: 14px;
  width: 68px;
}

#logly-lift-toaster .logly-lift-credit2 a:hover .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a:hover .logly-lift-credit-logo {
  background-position: 0 -196px;
  height: 14px;
  width: 68px;
}
#logly-lift-modal-contents-inner h3 {
  background-position: 0 -232px;
  height: 40px;
  width: 194px;
}

#logly-lift-toaster .logly-lift-credit2 {
  padding-right: 0;
}
#logly-lift-toaster .logly-lift-credit2,
#logly-lift-4279493 .logly-lift-credit2 {
  clear: both;
  padding: 0 8px 10px;
  text-align: right;
}
#logly-lift-toaster .logly-lift-credit2 a,
#logly-lift-4279493 .logly-lift-credit2 a {
  color: #999;
  text-decoration: none;
  font-size: 11px;
}
#logly-lift-toaster .logly-lift-credit2 a .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a .logly-lift-credit-logo {
  display: inline-block;
  color: transparent;
  margin-left: 3px;
  vertical-align: middle;
  margin-top: -2px;
}
@media only screen and (-webkit-min-device-pixel-ratio: 2),
only screen and (min-device-pixel-ratio: 2),
(min-resolution: 2dppx) {
  #logly-lift-toaster .logly-lift-credit2 a .logly-lift-credit-logo,
  #logly-lift-4279493 .logly-lift-credit2 a .logly-lift-credit-logo {
    display: inline-block;
    background-position: 0 -62px;
    height: 14px;
    width: 68px;
    background-size: 106px 136px;
  }
}
@media only screen and (-webkit-min-device-pixel-ratio: 2),
only screen and (min-device-pixel-ratio: 2),
(min-resolution: 2dppx) {
  #logly-lift-toaster .logly-lift-credit2 a:hover .logly-lift-credit-logo,
  #logly-lift-4279493 .logly-lift-credit2 a:hover .logly-lift-credit-logo {
    display: inline-block;
    background-position: 0 -62px;
    height: 14px;
    width: 68px;
    background-size: 106px 136px;
  }
}

#logly-lift-4279493 .logly-lift-widget-video-content {
  padding: 20px;
  background: #fff;
}

#logly-lift-4279493 .logly-lift-video {
  width: auto;
  height: auto;
  margin: 0 -20px;
  position: relative;
  overflow: hidden;
  box-sizing: border-box;
  box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.17);
}

#logly-lift-4279493 .logly-lift-video-header {
  padding-bottom: 15px;
}

#logly-lift-4279493 .logly-lift-video-footer {
  padding-top: 15px;
}

#logly-lift-4279493 .logly-lift-video-header .logly-lift-video-headerlink,
#logly-lift-4279493 .logly-lift-video-footer .logly-lift-video-footerlink {
  display: block;
  text-decoration: none;
}

#logly-lift-4279493 .logly-lift-video-header .logly-lift-video-headerlink::after,
#logly-lift-4279493 .logly-lift-video-footer .logly-lift-video-footerlink::after {
  content: "";
  display: block;
  clear:both;
}

#logly-lift-4279493 .logly-lift-video-title {
  font-size: 16px;
  line-height: 25px;
  font-weight: bold;
  margin-bottom: 8px;
  color: #333;
}

#logly-lift-4279493 .logly-lift-video-adv {
  font-size: 11px;
  line-height: 1;
  color: #CCC;
  text-align: right;
}

#logly-lift-4279493 .logly-lift-video-cv {
  display: block;
  text-align: center;
  background: #4285f4;
  color: #FFF;
  border-radius: 3px;
}

#logly-lift-4279493 .logly-lift-video-cv:hover {
  opacity: 0.85;
}

/* type-1 */
#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-footer .logly-lift-video-title,
#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-header .logly-lift-video-adv {
  display: none;
}

#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-footer .logly-lift-video-adv {
  text-align: left;
}

#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-footer .logly-lift-video-cv {
  float: right;
  padding: 3px 20px;
  line-height: 1.8;
  font-size: 14px;
}

#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-footer .logly-lift-video-cv::before {
  content: "詳細を見る";
}


  /*
---
name: Anonymous
category: LoglyFeed/Anonymous
---


To reflect this design, you must copy and paste it to https://www.logly.co.jp design settings


!![](LoglyFeed/Anonymous.html)

*/

#logly-lift-4279493 #logly-lift-widget-header {
  font-size: 16px;
  margin-bottom: 12px;
  font-weight: 400;
  font-feature-settings: "palt";
  position: relative;
}

#logly-lift-4279493 #logly-lift-widget-content {
  display: block;
  flex-wrap: wrap;
}

#logly-lift-4279493 .logly-lift-ad {
  display: flex;
  align-items: center;
  border-bottom: 1px solid #e8e8e8;
  margin: 0;
  padding: 16px;
}

#logly-lift-4279493 .logly-lift-ad:first-child {
  border-top: 1px solid #e8e8e8;
}

#logly-lift-4279493 .logly-lift-ad .fa {
  color: #55c500;
  font-size: 40px;
}

#logly-lift-4279493 .logly-lift-ad .fa-fw {
  width: 40px;
  height: 40px;
  text-align: left;
}

#logly-lift-4279493 .logly-lift-ad-icon {
  overflow: hidden;
  border-radius: 0.2em;
  width: 40px;
  height: 40px;
  flex-shrink: 0;
  margin-top: 2px;
}

#logly-lift-4279493 .logly-lift-ad-icon img {
  width: 100%;
  height: 100%;
}

#logly-lift-4279493 .logly-lift-ad-content {
  display: block;
}

#logly-lift-4279493 .logly-lift-ad-link {
  margin-right: 8px;
}

#logly-lift-4279493 .logly-lift-ad-title {
  display: inline-block;
  font-size: 1.6rem;
  font-weight: bold;
  color: #333;
  line-height: 1.4;
  margin-bottom: 4px;
  word-wrap: break-word;
  word-break: break-all;
  margin-left: 8px;
}

#logly-lift-4279493 .logly-lift-ad-title:visited {
  color: #777;
}

#logly-lift-4279493 .logly-lift-ad-link:hover .logly-lift-ad-title {
  text-decoration: underline;
}

#logly-lift-4279493 .logly-lift-ad-author {
  display: block;
  color: #999;
  margin-left: 8px;
  font-size: 0.9rem;
}

#logly-lift-4279493 .logly-lift-ad-adv {
  display: block;
  color: #999;
  margin-left: 8px;
  font-size: 0.9rem;
}



</style><script src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/lift_widget.js"></script><style type="text/css">#logly-lift-4279493 #logly-lift-widget {
  
  width: 100%;
  
  
  
  clear: both;
}

#logly-lift-4279493 #logly-lift-widget-label {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  
  border-bottom-color: #5C97FF;
  
}

#logly-lift-4279493 #logly-lift-widget-label-caption {
  padding: 5px 10px;
  
  background-color: #5C97FF;
  
  float: left;
}

#logly-lift-4279493 #logly-lift-widget-label-caption a {
  
  color: #FFFFFF;
  
  
  text-decoration: none;
}

#logly-lift-4279493 .logly-lift-ad {
  display: inline-block;
  zoom: 1;
  vertical-align:top;
  
  width: 100%;
  
  margin: 5px 0;
  padding: 0;
}



#logly-lift-4279493 .logly-lift-ad-image {
  
  vertical-align: top;
  width: 120px;
  height: 90px;
  padding-right: 0;
}

#logly-lift-4279493 .logly-lift-ad-image-inner {
  position: relative;
  overflow: hidden;
  width: 120px;
  height: 90px;
}

#logly-lift-4279493 .logly-lift-ad-image-inner a {
  display: block;
  height: 100%;
}

#logly-lift-4279493 .logly-lift-ad-image-inner a .logly-lift-ad-img-inner {
  height: 100%;
  background-position: center;
  background-size: cover;
}

#logly-lift-4279493 .logly-lift-ad-content {
  
  word-break: break-all;
}



#logly-lift-4279493 .logly-lift-ad-title {
  
  
}



#logly-lift-4279493 .logly-lift-ad-lead {
  
  
}



#logly-lift-4279493 a.logly-lift-ad-site {
  
  
}





#logly-lift-4279493 .logly-lift-ad-disclosure {
  
  
  
  text-align: left;
  
}

#logly-lift-4279493 .logly-lift-ad-disclosure a {
  
  
  color: #999999;
  
}

#logly-lift-4279493 .logly-lift-clear {
  clear: both;
}



#logly-lift-4279493 .ie-lte9 .logly-lift-ad {
  display: inline;
}

#logly-lift-toaster .logly-lift-credit,
#logly-lift-4279493 .logly-lift-credit {
  clear:both;
  padding:0 8px 10px;
  text-align:right;
}

#logly-lift-toaster .logly-lift-credit {
  padding-right:0;
}

#logly-lift-toaster .logly-lift-credit a,
#logly-lift-4279493 .logly-lift-credit a {
  color: #999;
  text-decoration: none;
  font-size:13px;
}

#logly-lift-toaster .logly-lift-credit a .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit a .logly-lift-credit-logo {
  display:inline-block;
  background: url('https://cdn.logly.co.jp/spritesource-s5c12c753d2.webp') no-repeat 0 -103px;
  color:transparent;
  margin-left:3px;
  width:36px;
  height:14px;
  vertical-align:middle;
  *display:inline;
  *zoom:1;
}

#logly-lift-toaster .logly-lift-credit a:hover .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit a:hover .logly-lift-credit-logo {
  background: url('https://cdn.logly.co.jp/spritesource-s5c12c753d2.webp') no-repeat 0 -117px;
}

#logly-lift-toaster .logly-lift-credit2 a .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a .logly-lift-credit-logo,
#logly-lift-toaster .logly-lift-credit2 a:hover .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a:hover .logly-lift-credit-logo,
#logly-lift-modal-contents-inner h3 {
  background-image: url('https://cdn.logly.co.jp/spritesource-v74j50a002.webp');
  background-repeat: no-repeat;
}

#logly-lift-toaster .logly-lift-credit2 a .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a .logly-lift-credit-logo {
  background-position: 0 -110px;
  height: 14px;
  width: 68px;
}

#logly-lift-toaster .logly-lift-credit2 a:hover .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a:hover .logly-lift-credit-logo {
  background-position: 0 -196px;
  height: 14px;
  width: 68px;
}
#logly-lift-modal-contents-inner h3 {
  background-position: 0 -232px;
  height: 40px;
  width: 194px;
}

#logly-lift-toaster .logly-lift-credit2 {
  padding-right: 0;
}
#logly-lift-toaster .logly-lift-credit2,
#logly-lift-4279493 .logly-lift-credit2 {
  clear: both;
  padding: 0 8px 10px;
  text-align: right;
}
#logly-lift-toaster .logly-lift-credit2 a,
#logly-lift-4279493 .logly-lift-credit2 a {
  color: #999;
  text-decoration: none;
  font-size: 11px;
}
#logly-lift-toaster .logly-lift-credit2 a .logly-lift-credit-logo,
#logly-lift-4279493 .logly-lift-credit2 a .logly-lift-credit-logo {
  display: inline-block;
  color: transparent;
  margin-left: 3px;
  vertical-align: middle;
  margin-top: -2px;
}
@media only screen and (-webkit-min-device-pixel-ratio: 2),
only screen and (min-device-pixel-ratio: 2),
(min-resolution: 2dppx) {
  #logly-lift-toaster .logly-lift-credit2 a .logly-lift-credit-logo,
  #logly-lift-4279493 .logly-lift-credit2 a .logly-lift-credit-logo {
    display: inline-block;
    background-position: 0 -62px;
    height: 14px;
    width: 68px;
    background-size: 106px 136px;
  }
}
@media only screen and (-webkit-min-device-pixel-ratio: 2),
only screen and (min-device-pixel-ratio: 2),
(min-resolution: 2dppx) {
  #logly-lift-toaster .logly-lift-credit2 a:hover .logly-lift-credit-logo,
  #logly-lift-4279493 .logly-lift-credit2 a:hover .logly-lift-credit-logo {
    display: inline-block;
    background-position: 0 -62px;
    height: 14px;
    width: 68px;
    background-size: 106px 136px;
  }
}

#logly-lift-4279493 .logly-lift-widget-video-content {
  padding: 20px;
  background: #fff;
}

#logly-lift-4279493 .logly-lift-video {
  width: auto;
  height: auto;
  margin: 0 -20px;
  position: relative;
  overflow: hidden;
  box-sizing: border-box;
  box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.17);
}

#logly-lift-4279493 .logly-lift-video-header {
  padding-bottom: 15px;
}

#logly-lift-4279493 .logly-lift-video-footer {
  padding-top: 15px;
}

#logly-lift-4279493 .logly-lift-video-header .logly-lift-video-headerlink,
#logly-lift-4279493 .logly-lift-video-footer .logly-lift-video-footerlink {
  display: block;
  text-decoration: none;
}

#logly-lift-4279493 .logly-lift-video-header .logly-lift-video-headerlink::after,
#logly-lift-4279493 .logly-lift-video-footer .logly-lift-video-footerlink::after {
  content: "";
  display: block;
  clear:both;
}

#logly-lift-4279493 .logly-lift-video-title {
  font-size: 16px;
  line-height: 25px;
  font-weight: bold;
  margin-bottom: 8px;
  color: #333;
}

#logly-lift-4279493 .logly-lift-video-adv {
  font-size: 11px;
  line-height: 1;
  color: #CCC;
  text-align: right;
}

#logly-lift-4279493 .logly-lift-video-cv {
  display: block;
  text-align: center;
  background: #4285f4;
  color: #FFF;
  border-radius: 3px;
}

#logly-lift-4279493 .logly-lift-video-cv:hover {
  opacity: 0.85;
}

/* type-1 */
#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-footer .logly-lift-video-title,
#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-header .logly-lift-video-adv {
  display: none;
}

#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-footer .logly-lift-video-adv {
  text-align: left;
}

#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-footer .logly-lift-video-cv {
  float: right;
  padding: 3px 20px;
  line-height: 1.8;
  font-size: 14px;
}

#logly-lift-4279493 .logly-lift-video-type-1 .logly-lift-video-footer .logly-lift-video-cv::before {
  content: "詳細を見る";
}


  /*
---
name: Anonymous
category: LoglyFeed/Anonymous
---


To reflect this design, you must copy and paste it to https://www.logly.co.jp design settings


!![](LoglyFeed/Anonymous.html)

*/

#logly-lift-4279493 #logly-lift-widget-header {
  font-size: 16px;
  margin-bottom: 12px;
  font-weight: 400;
  font-feature-settings: "palt";
  position: relative;
}

#logly-lift-4279493 #logly-lift-widget-content {
  display: block;
  flex-wrap: wrap;
}

#logly-lift-4279493 .logly-lift-ad {
  display: flex;
  align-items: center;
  border-bottom: 1px solid #e8e8e8;
  margin: 0;
  padding: 16px;
}

#logly-lift-4279493 .logly-lift-ad:first-child {
  border-top: 1px solid #e8e8e8;
}

#logly-lift-4279493 .logly-lift-ad .fa {
  color: #55c500;
  font-size: 40px;
}

#logly-lift-4279493 .logly-lift-ad .fa-fw {
  width: 40px;
  height: 40px;
  text-align: left;
}

#logly-lift-4279493 .logly-lift-ad-icon {
  overflow: hidden;
  border-radius: 0.2em;
  width: 40px;
  height: 40px;
  flex-shrink: 0;
  margin-top: 2px;
}

#logly-lift-4279493 .logly-lift-ad-icon img {
  width: 100%;
  height: 100%;
}

#logly-lift-4279493 .logly-lift-ad-content {
  display: block;
}

#logly-lift-4279493 .logly-lift-ad-link {
  margin-right: 8px;
}

#logly-lift-4279493 .logly-lift-ad-title {
  display: inline-block;
  font-size: 1.6rem;
  font-weight: bold;
  color: #333;
  line-height: 1.4;
  margin-bottom: 4px;
  word-wrap: break-word;
  word-break: break-all;
  margin-left: 8px;
}

#logly-lift-4279493 .logly-lift-ad-title:visited {
  color: #777;
}

#logly-lift-4279493 .logly-lift-ad-link:hover .logly-lift-ad-title {
  text-decoration: underline;
}

#logly-lift-4279493 .logly-lift-ad-author {
  display: block;
  color: #999;
  margin-left: 8px;
  font-size: 0.9rem;
}

#logly-lift-4279493 .logly-lift-ad-adv {
  display: block;
  color: #999;
  margin-left: 8px;
  font-size: 0.9rem;
}



</style><link rel="prefetch" href="https://qiita.com/official-columns" as="document"><link rel="prefetch" href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" as="document"></head><body><iframe src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/sync.html" scrolling="no" style="display: none; border: none;"></iframe><iframe src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/sync(1).html" scrolling="no" style="display: none; border: none;"></iframe><div class="allWrapper"><div id="New2GlobalHeader-react-component-bf29052c-ee14-4070-ab9d-b86c65b1aedc"><div class="st-NewHeader"><div class="st-NewHeader_container"><div class="st-NewHeader_start"><a href="https://qiita.com/" class="st-NewHeader_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a></div><div class="st-NewHeader_end"><form class="st-NewHeader_search" action="https://qiita.com/search" method="get"><span class="fa fa-fw fa-search st-NewHeader_searchIcon"></span><input type="search" class="st-NewHeader_searchInput" autocomplete="off" placeholder="記事を検索" value="" name="q" required=""></form><form class="st-NewHeader_searchModal" action="https://qiita.com/search" method="get"><input type="text" class="st-NewHeader_searchModalInput" autocomplete="off" placeholder="記事を検索" value="" name="q" required=""></form><div class="st-NewHeader_searchButton st-NewHeader_searchButton_notLoginOrBeta"><span class="fa fa-fw fa-search"></span></div><a class="st-NewHeader_loginLink" href="https://qiita.com/login?redirectTo=%2Fakiraichi5430%2Fitems%2F60ce2829a1b72dce5bca" rel="nofollow">ログイン</a><a class="st-NewHeader_signupButton" href="https://qiita.com/signup?redirectTo=%2Fakiraichi5430%2Fitems%2F60ce2829a1b72dce5bca" rel="nofollow">ユーザー登録</a></div><div class="st-NewHeader_overlay"></div></div></div><div class="st-NewHeader_mainNavigation"><div class="st-NewHeader_navigationTabContainer"><a class="st-NewHeader_mainNavigationItem" href="https://qiita.com/">トレンド</a><a class="st-NewHeader_mainNavigationItem" href="https://qiita.com/question-trend">質問</a><a class="st-NewHeader_mainNavigationItem" href="https://qiita.com/official-events">公式イベント</a><a class="st-NewHeader_mainNavigationItem" href="https://qiita.com/official-columns">公式コラム</a><a class="st-NewHeader_mainNavigationItem" href="https://qiita.com/opportunities">募集</a><a class="st-NewHeader_mainNavigationItem" href="https://qiita.com/organizations">Organization</a><a class="st-NewHeader_mainNavigationItem" href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" target="_blank">Qiita Blog<span class="fa fa-fw fa-window-restore st-NewHeader_mainNavigationBlankIcon"></span></a></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="New2GlobalHeader" data-dom-id="New2GlobalHeader-react-component-bf29052c-ee14-4070-ab9d-b86c65b1aedc">{"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"type":null,"isHideGlobalNavigation":false,"isAdventCalendarRankingBeingHeld":false,"isShowTfaDownloadAlert":null}</script>
      
<script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/python3","name":"Python3"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2020-08-11T14:19:52.000+09:00","dateModified":"2020-08-11T19:45:15.000+09:00","headline":"続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-9f5428127621718a910c8b63951390ad.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTkxNiZ0eHQ9JUU3JUI2JTlBJUUzJTgzJUJCJUUzJTgyJThGJUUzJTgxJThCJUUzJTgyJThBJUUzJTgyJTg0JUUzJTgxJTk5JUUzJTgxJTg0JUUzJTgwJTgwJUUzJTgzJTkxJUUzJTgyJUJGJUUzJTgzJUJDJUUzJTgzJUIzJUU4JUFBJThEJUU4JUFEJTk4JUUzJTgwJTgwJUU2JTk1JTk5JUU1JUI4JUFCJUUzJTgxJUFBJUUzJTgxJTk3JUU1JUFEJUE2JUU3JUJGJTkyJUU1JTg1JUE1JUU5JTk2JTgwJUUzJTgwJTgwJUUzJTgyJUEyJUUzJTgzJUFCJUUzJTgyJUI0JUUzJTgzJUFBJUUzJTgyJUJBJUUzJTgzJUEwJUUzJTgxJUFFJUUzJTgyJUI1JUUzJTgzJUIzJUUzJTgzJTk3JUUzJTgzJUFCJUUzJTgyJUIzJUUzJTgzJUJDJUUzJTgzJTg5JUUzJTgyJTkyJUU2JTlCJUI4JUUzJTgxJTg0JUUzJTgxJUE2JUUzJTgxJUJGJUUzJTgxJTlGJnR4dC1jb2xvcj0lMjMyMTIxMjEmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTYmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWxlZnQlMkN0b3Amcz1hNWE1OGFlZjFkZGY5ODVjYTA1NzEwOTdhNzg3NGE0MA\u0026mark-x=142\u0026mark-y=112\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTYxNiZ0eHQ9JTQwYWtpcmFpY2hpNTQzMCZ0eHQtY29sb3I9JTIzMjEyMTIxJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTM2JnR4dC1hbGlnbj1sZWZ0JTJDdG9wJnM9NzFkZmYxN2MyNzY3OTRkNmE2YzJhYjQzOTBjNmNkNWM\u0026blend-x=142\u0026blend-y=491\u0026blend-mode=normal\u0026s=5969c6653d598e6310198517b551d2a9","mainEntityOfPage":"https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca","author":{"@type":"Person","address":"","email":null,"identifier":"akiraichi5430","name":"akiraichi5430","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F252164%2Fedfa4333ea66c515f9341ae8532143aaff509495%2Fx_large.png%3F1597115905?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=20be48fdd07aa0c0c2efa2642a10c1b9","url":"https://qiita.com/akiraichi5430","description":"高専生でした。今は専攻科生です。そして大学院生になりました。（時が経つのは早いな…）","memberOf":[]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><script>td.trackEvent('pageviews_article',{
    user_id: "",
    article_id: "1279896",
    article_uuid: "60ce2829a1b72dce5bca",
    td_description: "&quot;「続・わかりやすい パターン認識 教師なし学習入門」ではアルゴリズムのサンプルコードが公開されていません。そこで、自分で書いてみました。\nなお、具体的に実験をした結果は[Github](https://github.com/Akiraichi/Code_for_Algorithms)で公開しています。\n\n\n# 目次\n- [5章 教師付き学習、教師なし学習](#5章教師付き学習教師なし学習)\n    - [データ作成](#データ作成)\n    - [教師付き学習](#教師付き学習)\n    - [教師なし学習](#教師なし学習)\n- [7章 マルコフモデル](#7章マルコフモデル)\n    - [データ作成](#データ作成-1) \n    - [マルコフモデルのパラメータ推定](#マルコフモデルのパラメータ推定)\n- [8章 隠れマルコフモデル](#8章隠れマルコフモデル)\n    - [データ作成](#データ作成-2)\n    - [隠れマルコフモデルのパラメータ推定](#隠れマルコフモデルのパラメータ推定)\n- [9章 混合正規分布](#9章混合正規分布)\n    - [データ作成](#データ作成-3)\n    - [混合正規分布のパラメータ推定](#混合正規分布のパラメータ推定)\n- [10章 凸クラスタリング](#10章凸クラスタリング)\n    - [データ作成](#データ作成-4)\n    - [凸クラスタリング法](#凸クラスタリング法)\n- [最後に](#最後に)\n\n## 5章　教師付き学習、教師なし学習\n\n### データ作成\n\n教師付き学習、教師なし学習を適用するためのデータを作るクラスです\n\n```python\n\nclass dice(object):\n\n    def __init__(self, theta, pi):\n        self.theta = theta\n        self.pi = pi\n\n    def generate_data(self, num):\n        x, s = [], []\n        for _ in range(num):\n            s.append(self.__spots(self.pi))\n            x.append(self.__spots(self.theta[s[-1]]))\n\n        return x, s\n\n    @staticmethod\n    def __spots(pi):\n        p = np.random.rand()\n        for i in range(len(pi)):\n            if p \u0026amp;lt; pi[:i + 1].sum():\n                return i\n```\n### 教師付き学習\n教師付き学習のクラスです。\n\n```python\nclass Supervised_learning(object):\n    def __init__(self):\n        self.pi = None\n        self.theta = None\n        self.n = None\n\n    def estimate(self, x, s):\n        self.n = self.__count(x, s)\n        self.pi = self.n.sum(axis=1) / self.n.sum()\n        self.theta = self.n / np.tile(self.n.sum(axis=1), (self.n.shape[1], 1)).T\n\n    @staticmethod\n    def __count(x, s):\n        n = np.zeros((max(s) + 1, max(x) + 1))\n        for x_, s_ in zip(x, s):\n            n[s_][x_] += 1\n        return n\n```\n### 教師なし学習\n教師なし学習のクラスです。\n\n```python\n\nclass Unsupervised_learning(object):\n    def __init__(self, theta=None, pi=None, c=3, m=2):\n        self.c = c\n        self.m = m\n\n        # Step1 If no initial value is specified, it will be determined at random\n        if pi is None:\n            pi = np.random.rand(self.c)\n        if theta is None:\n            rand = np.random.rand(self.c, self.m)\n            theta = rand / rand.sum(axis=1).reshape(-1, 1)  # normalisation\n        self.pi = pi\n        self.theta = theta\n        self.r = None\n        self.p = None\n\n    def estimate(self, x):\n        self.r = np.array([i for i in collections.Counter(x).values()])\n\n        # Step2\n        self.__update_p()\n\n        # termination condition\n        epsilon = 1e-6\n        log_p = -sys.float_info.max\n        delta = None\n\n        while delta is None or delta \u0026amp;gt;= epsilon:\n            # Step3\n            self.__update_param()\n\n            # Step4\n            log_p_new = self.__log_likelihood()\n            delta = log_p_new - log_p\n            log_p = log_p_new\n\n    def __update_p(self):\n        numer = self.pi.reshape(-1, 1) * self.theta\n        self.p = numer / numer.sum(axis=0)\n\n    def __update_param(self):\n        self.pi = (self.r * self.p).sum(axis=1) / self.r.sum()\n        self.__update_p()\n        numer = self.r * self.p\n        # self.theta = (numer.T / numer.sum(axis=1)).T  # if theta is known, comment out on this line.\n\n    def __log_likelihood(self):\n        log_p = np.log((self.pi.reshape(-1, 1) * self.theta).sum(axis=0))\n        return (self.r * log_p).sum(axis=0)\n```\n\n\n## 7章　マルコフモデル\n\n### データ作成\nマルコフモデルに従ったデータを作るクラスです。\n\n```python\n\nclass Markov_dice(object):\n\n    def __init__(self, A, B, rho):\n        self.A = A\n        self.B = B\n        self.rho = rho\n\n    def generate_spots(self, n):\n        s, x = [], []\n        s += self.__spots(self.rho.reshape(1, -1), 0)\n        for n in range(n):\n            x += self.__spots(self.B, s[-1])\n            s += self.__spots(self.A, s[-1])\n        return np.array(s[:-1]), np.array(x)\n\n    def __spots(self, theta, s_t):\n        p = np.random.rand()\n        for i in range(theta.shape[0]):\n            if p \u0026amp;lt; theta[s_t, :i + 1].sum():\n                break\n        return [i]\n```\n\n\n### マルコフモデルのパラメータ推定\nマルコフモデルのパラメータを推定するクラスです\n\n```python\n\nclass Markov(object):\n    def __init__(self):\n        self.A = None\n        self.B = None\n        self.n = None\n        self.m = None\n\n    def estimate(self, x, s):\n        self.__initialize(x, s)\n        self.n, self.m = self.__count(x, s)\n        self.A = self.m / self.n.sum(axis=1).reshape(-1, 1)\n        self.B = self.n / self.n.sum(axis=1).reshape(-1, 1)\n\n    def __initialize(self, x, s):\n        self.A = np.zeros((max(s) + 1, max(s) + 1))\n        self.B = np.zeros((max(s) + 1, max(x) + 1))\n\n    @staticmethod\n    def __count(x, s):\n        n = np.zeros((max(s) + 1, max(x) + 1))\n        for x_, s_ in zip(x, s):\n            n[s_][x_] += 1\n\n        m = np.zeros((max(s) + 1, max(s) + 1))\n        for i in range(len(s) - 1):\n            m[s[i]][s[i + 1]] += 1\n\n        return n, m\n```\n\n## 8章　隠れマルコフモデル\n\n### データ作成\n[7章 マルコフモデルと同様の方法](#データ作成-1)でデータを作成します\n\n### 隠れマルコフモデルのパラメータ推定\n\n隠れマルコフモデルのパラメータ推定は[pythonでHMMのパラメータ推定実装](https://qiita.com/ta-ka/items/3e5306d0432c05909992)で詳しく説明されています。\n\n\n## 9章  混合正規分布\n\n## データ作成\n\n混合正規分布に従ったデータを作成するクラスです。\n\n```python\n\nclass mixed_normal_dice(object):\n    \u0026amp;quot;\u0026amp;quot;\u0026amp;quot;mixed normal distribution model\u0026amp;quot;\u0026amp;quot;\u0026amp;quot;\n\n    def __init__(self, K=3, mu=None, sigma=None):\n        self.K = K\n        # If no initial value is specified, it will be determined at random\n        if mu is None:\n            mu = []\n            for i in range(self.K):\n                mu += [(np.random.rand() - 0.5) * 10.0]  # range: -5.0 - 5.0\n        if sigma is None:\n            sigma = []\n            for i in range(self.K):\n                sigma += [np.random.rand() * 3.0]  # range: 0.0 - 3.0:\n\n        self.mu = mu\n        self.scale = sigma\n\n    def generate_data(self, N):\n        X = []\n        mu_star = []\n        sigma_star = []\n        for i in range(self.K):\n            if self.mu.ndim \u0026amp;gt;= 2:\n                # In the case of multidimensional normal distribution\n                X = np.append(X, np.random.multivariate_normal(self.mu[i], self.scale[i], N // self.K))\n                result = X.reshape(-1, self.mu.ndim), mu_star, sigma_star\n            else:\n                # In the case of one-dimensional normal distribution\n                X = np.append(X, np.random.normal(self.mu[i], self.scale[i], N // self.K))\n                result = X, mu_star, sigma_star\n            mu_star = np.append(mu_star, self.mu[i])\n            sigma_star = np.append(sigma_star, self.scale[i])\n\n        return result\n```\n\n### 混合正規分布のパラメータ推定\n混合正規分布に従ったデータをパラメータ推定するクラスです。（グラフを描画する関数も含めています）\n[pythonで混合正規分布実装](https://qiita.com/ta-ka/items/3e8b127620ac92a32864#pythonでの実装)を参考にしました。\n\n```python\n\nclass mixed_normal_distribution(object):\n    \u0026amp;quot;\u0026amp;quot;\u0026amp;quot;Parameter Estimation for Mixed Normal Distribution\u0026amp;quot;\u0026amp;quot;\u0026amp;quot;\n\n    def __init__(self, K, pi=None, mu=None, sigma=None):\n        self.K = K\n        # If no initial value is specified, it will be determined at random\n        if pi is None:\n            pi = np.random.rand(self.K)\n        if mu is None:\n            mu = np.random.randn(K)\n        if sigma is None:\n            sigma = np.abs(np.random.randn(K))\n        self.pi = pi\n        self.mu = mu\n        self.sigma = sigma\n\n    def estimate(self, X):\n        # termination condition\n        epsilon = 0.000001\n\n        # Step1 initialize gmm parameter\n        Q = -sys.float_info.max\n        delta = None\n\n        # EM algorithm\n\n        while delta is None or delta \u0026amp;gt;= epsilon:\n            gf = self.__gaussian(self.mu, self.sigma)\n            # E step: example posterior probability of hidden variable gamma\n            gamma = self.__estimate_posterior_likelihood(X, self.pi, gf)\n\n            # M step: miximize Q function by estimating mu, sigma and pi\n            self.__estimate_gmm_parameter(X, gamma)\n\n            # calculate Q function\n            Q_new = self.__calc_Q(X, gamma)\n            delta = Q_new - Q\n            Q = Q_new\n\n    @staticmethod\n    def __estimate_posterior_likelihood(X, pi, gf):\n        l = np.zeros((X.size, pi.size))\n        for (i, x) in enumerate(X):\n            l[i, :] = gf(x)\n\n        return pi * l * np.vectorize(lambda y: 1 / y)(l.sum(axis=1).reshape(-1, 1))\n\n    @staticmethod\n    def __gaussian(mu, sigma):\n        def f(x):\n            return np.exp(-0.5 * (x - mu) ** 2 / sigma) / np.sqrt(2 * np.pi * sigma)\n\n        return f\n\n    def __estimate_gmm_parameter(self, X, gamma):\n        N = gamma.sum(axis=0)\n        self.mu = (gamma * X.reshape((-1, 1))).sum(axis=0) / N\n        self.sigma = (gamma * (X.reshape(-1, 1) - self.mu) ** 2).sum(axis=0) / N\n        self.pi = N / X.size\n\n    def __calc_Q(self, X, gamma):\n        Q = (gamma * (np.log(self.pi * (2 * np.pi * self.sigma) ** (-0.5)))).sum()\n        for (i, x) in enumerate(X):\n            Q += (gamma[i, :] * (-0.5 * (x - self.mu) ** 2 / self.sigma)).sum()\n        return Q\n\n    def result(self, mu_star, sigma_star):\n        print(u\u0026amp;#39;mu*: %s, sigma*: %s\u0026amp;#39; % (str(np.sort(np.around(mu_star, 3))), str(np.sort(np.around(sigma_star, 3)))))\n        print(u\u0026amp;#39;mu : %s, sigma : %s\u0026amp;#39; % (str(np.sort(np.around(self.mu, 3))), str(np.sort(np.around(self.sigma, 3)))))\n\n    def graph(self, X):\n        n, bins, _ = plt.hist(X, 50, density=True, alpha=0.3)\n        seq = np.arange(-15, 15, 0.02)\n        for i in range(self.K):\n            plt.plot(seq, self.__gaussian(self.mu[i], self.sigma[i])(seq), linewidth=2.0)\n        plt.savefig(\u0026amp;#39;gmm_graph.png\u0026amp;#39;)\n        plt.show()\n```\n\n## 10章　凸クラスタリング\n\n### データ作成\n\n[9章 混合正規分布と同様の方法](#データ作成-3)でデータを作成します\n\n### 凸クラスタリング法\n\nデータを凸クラスタリングするクラスです。（グラフを描画する関数も含めています）\n[凸クラスタリング法の実装と実験](https://qiita.com/drumichiro/items/00d4e3f6ba4be7e23fad)とそのコードが載っている[Convex Clustering](https://github.com/drumichiro/convex-clustering)を一部参考にしました。\n\n```python\n\nclass convex_clustering(object):\n    def __init__(self, sigma):\n        # Step1 Set the variance to an appropriate value.\n        self.sigma = sigma\n        self.pi = None\n        self.n = None\n        self.X = Non...&quot;",
    td_title: "&quot;続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた&quot;"
  })</script><script async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/qiita_bigmining.js"></script><div style="display:none"><div class="TagList__label"><span></span><span>Python3</span></div><div class="TagList__label"><span></span><span>パターン認識</span></div></div><img style="display:block;margin:0;padding:0;border:0;outline:0;width:0;height:0;line-height:0;" alt="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/bizmatrix"><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"ja","i18nDefaultLocale":"en","href":"https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca","location":"/akiraichi5430/items/60ce2829a1b72dce5bca","scheme":"https","host":"qiita.com","port":null,"pathname":"/akiraichi5430/items/60ce2829a1b72dce5bca","search":null,"httpAcceptLanguage":"ja,en-US;q=0.9,en;q=0.8","actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"Wy+9yD3s0U0G2ox0OGQ0AM/cJTfpX2XoPPr0xWlWcEapgoOzav9POMvEAQqhuYIN9EDTqEgoZ1Lu2j6S0B0ltA==","locale":"ja"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","errorIconPath":"//cdn.qiita.com/assets/icons/large/missing-profile-image-828ed5829a93fbb35746a6c0f7c8107e.png","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-e6ddce6b-4526-4acb-9e00-38f7342202ee"><div class="p-items_wrapper"><div class=" css-vnk55c"><div class="css-1ibnx62"><div class="css-1x8nfy4"><div class="css-1duml6f"><div style="width:64px;height:64px;overflow:hidden;margin:0 auto;outline:none;left:50%;position:absolute;top:50%;transform:translate(-50%, -50%)" title="" role="" aria-label="animation" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="64" height="64" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: 100%; transform: translate3d(0px, 0px, 0px); content-visibility: visible;"><defs><clippath id="__lottie_element_2"><rect width="64" height="64" x="0" y="0"></rect></clippath><mask id="__lottie_element_33" mask-type="alpha"><g style="display: none;"><g><path></path></g></g></mask></defs><g clip-path="url(#__lottie_element_2)"><g transform="matrix(1,0,0,1,11,11)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,21,21)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M0,-19 C0,-19 0,-19 0,-19 C10.493000030517578,-19 19,-10.494000434875488 19,0 C19,10.493000030517578 10.493000030517578,19 0,19 C-10.494000434875488,19 -19,10.493000030517578 -19,0 C-19,-10.494000434875488 -10.494000434875488,-19 0,-19z"></path><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="4" stroke="rgb(85,197,0)" stroke-opacity="1" stroke-width="2" d=" M0,-19 C0,-19 0,-19 0,-19 C10.493000030517578,-19 19,-10.494000434875488 19,0 C19,10.493000030517578 10.493000030517578,19 0,19 C-10.494000434875488,19 -19,10.493000030517578 -19,0 C-19,-10.494000434875488 -10.494000434875488,-19 0,-19z"></path></g></g><g transform="matrix(1,0,0,1,31.253000259399414,32.73200225830078)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,5.218999862670898,4.959000110626221)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-0.33500000834465027,2.4159998893737793 C-0.33500000834465027,2.4159998893737793 -2.3550000190734863,-0.5899999737739563 -2.3550000190734863,-0.5899999737739563 C-2.3550000190734863,-0.5899999737739563 -2.3550000190734863,4.709000110626221 -2.3550000190734863,4.709000110626221 C-2.3550000190734863,4.709000110626221 -4.968999862670898,4.709000110626221 -4.968999862670898,4.709000110626221 C-4.968999862670898,4.709000110626221 -4.968999862670898,-4.709000110626221 -4.968999862670898,-4.709000110626221 C-4.968999862670898,-4.709000110626221 -2.6670000553131104,-4.709000110626221 -2.6670000553131104,-4.709000110626221 C-2.6670000553131104,-4.709000110626221 -0.01600000075995922,-0.9629999995231628 -0.01600000075995922,-0.9629999995231628 C-0.01600000075995922,-0.9629999995231628 2.694999933242798,-4.709000110626221 2.694999933242798,-4.709000110626221 C2.694999933242798,-4.709000110626221 4.968999862670898,-4.709000110626221 4.968999862670898,-4.709000110626221 C4.968999862670898,-4.709000110626221 4.968999862670898,4.709000110626221 4.968999862670898,4.709000110626221 C4.968999862670898,4.709000110626221 2.3550000190734863,4.709000110626221 2.3550000190734863,4.709000110626221 C2.3550000190734863,4.709000110626221 2.3550000190734863,-0.5609999895095825 2.3550000190734863,-0.5609999895095825 C2.3550000190734863,-0.5609999895095825 0.3009999990463257,2.4159998893737793 0.3009999990463257,2.4159998893737793 C0.3009999990463257,2.4159998893737793 -0.33500000834465027,2.4159998893737793 -0.33500000834465027,2.4159998893737793z"></path></g></g><g transform="matrix(1,0,0,1,22.149999618530273,32.72599792480469)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,4.031000137329102,4.961999893188477)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-1.2940000295639038,-2.5350000858306885 C-1.2940000295639038,-2.5350000858306885 -3.7809998989105225,-2.5350000858306885 -3.7809998989105225,-2.5350000858306885 C-3.7809998989105225,-2.5350000858306885 -3.7809998989105225,-4.711999893188477 -3.7809998989105225,-4.711999893188477 C-3.7809998989105225,-4.711999893188477 3.7809998989105225,-4.711999893188477 3.7809998989105225,-4.711999893188477 C3.7809998989105225,-4.711999893188477 3.7809998989105225,-2.5350000858306885 3.7809998989105225,-2.5350000858306885 C3.7809998989105225,-2.5350000858306885 1.2990000247955322,-2.5350000858306885 1.2990000247955322,-2.5350000858306885 C1.2990000247955322,-2.5350000858306885 1.2990000247955322,4.711999893188477 1.2990000247955322,4.711999893188477 C1.2990000247955322,4.711999893188477 -1.2940000295639038,4.711999893188477 -1.2940000295639038,4.711999893188477 C-1.2940000295639038,4.711999893188477 -1.2940000295639038,-2.5350000858306885 -1.2940000295639038,-2.5350000858306885z"></path></g></g><g transform="matrix(1,0,0,1,31.006000518798828,21.350000381469727)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,5.2769999504089355,5.206999778747559)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M0.09700000286102295,-0.40400001406669617 C0.09700000286102295,-0.40400001406669617 4.982999801635742,-0.40400001406669617 4.982999801635742,-0.40400001406669617 C5.0269999504089355,0.4059999883174896 4.934000015258789,1.1369999647140503 4.705999851226807,1.7960000038146973 C4.484000205993652,2.4549999237060547 4.1539998054504395,3.0169999599456787 3.7219998836517334,3.48799991607666 C3.2909998893737793,3.9570000171661377 2.7730000019073486,4.322000026702881 2.1659998893737793,4.573999881744385 C1.5609999895095825,4.830999851226807 0.8970000147819519,4.955999851226807 0.18400000035762787,4.955999851226807 C-0.5389999747276306,4.955999851226807 -1.2170000076293945,4.824999809265137 -1.847000002861023,4.567999839782715 C-2.4769999980926514,4.310999870300293 -3.0299999713897705,3.9579999446868896 -3.5,3.507999897003174 C-3.9700000286102295,3.056999921798706 -4.3429999351501465,2.5339999198913574 -4.614999771118164,1.9279999732971191 C-4.886000156402588,1.3220000267028809 -5.0269999504089355,0.6809999942779541 -5.0269999504089355,-0.007000000216066837 C-5.0269999504089355,-0.6949999928474426 -4.890999794006348,-1.340000033378601 -4.614999771118164,-1.940999984741211 C-4.339000225067139,-2.5369999408721924 -3.9700000286102295,-3.065999984741211 -3.5,-3.51200008392334 C-3.0299999713897705,-3.9630000591278076 -2.4769999980926514,-4.310999870300293 -1.847000002861023,-4.567999839782715 C-1.2170000076293945,-4.824999809265137 -0.5389999747276306,-4.955999851226807 0.18400000035762787,-4.955999851226807 C0.9100000262260437,-4.955999851226807 1.5889999866485596,-4.824999809265137 2.2200000286102295,-4.567999839782715 C2.8499999046325684,-4.310999870300293 3.4079999923706055,-3.947000026702881 3.8970000743865967,-3.4769999980926514 C3.8970000743865967,-3.4769999980926514 2.196000099182129,-1.7769999504089355 2.196000099182129,-1.7769999504089355 C1.968000054359436,-2.0820000171661377 1.6820000410079956,-2.322999954223633 1.3320000171661377,-2.503000020980835 C0.984000027179718,-2.681999921798706 0.6010000109672546,-2.7750000953674316 0.17900000512599945,-2.7750000953674316 C-0.17900000512599945,-2.7750000953674316 -0.5189999938011169,-2.7019999027252197 -0.8339999914169312,-2.561000108718872 C-1.1490000486373901,-2.4210000038146973 -1.4210000038146973,-2.2269999980926514 -1.6579999923706055,-1.9800000190734863 C-1.8899999856948853,-1.7319999933242798 -2.075000047683716,-1.4420000314712524 -2.2160000801086426,-1.1019999980926514 C-2.3510000705718994,-0.7630000114440918 -2.4200000762939453,-0.39399999380111694 -2.4200000762939453,0.003000000026077032 C-2.4200000762939453,0.3959999978542328 -2.3510000705718994,0.7630000114440918 -2.2160000801086426,1.1019999980926514 C-2.0799999237060547,1.4420000314712524 -1.8960000276565552,1.7389999628067017 -1.6579999923706055,1.9859999418258667 C-1.4249999523162842,2.2330000400543213 -1.1490000486373901,2.4260001182556152 -0.8339999914169312,2.565999984741211 C-0.5189999938011169,2.7070000171661377 -0.17900000512599945,2.7809998989105225 0.17900000512599945,2.7809998989105225 C0.8330000042915344,2.7809998989105225 1.3320000171661377,2.6589999198913574 1.687000036239624,2.4170000553131104 C2.0399999618530273,2.174999952316284 2.2730000019073486,1.840000033378601 2.3889999389648438,1.4229999780654907 C2.3889999389648438,1.4229999780654907 0.09200000017881393,1.4229999780654907 0.09200000017881393,1.4229999780654907 C0.09200000017881393,1.4229999780654907 0.09700000286102295,-0.40400001406669617 0.09700000286102295,-0.40400001406669617z"></path></g></g><g transform="matrix(1,0,0,1,22.730998992919922,21.097000122070312)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,3.73799991607666,4.961999893188477)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-3.48799991607666,-4.711999893188477 C-3.48799991607666,-4.711999893188477 -0.875,-4.711999893188477 -0.875,-4.711999893188477 C-0.875,-4.711999893188477 -0.875,2.5360000133514404 -0.875,2.5360000133514404 C-0.875,2.5360000133514404 3.48799991607666,2.5360000133514404 3.48799991607666,2.5360000133514404 C3.48799991607666,2.5360000133514404 3.48799991607666,4.711999893188477 3.48799991607666,4.711999893188477 C3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 C-3.48799991607666,4.711999893188477 -3.48799991607666,-4.711999893188477 -3.48799991607666,-4.711999893188477z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-123.23100280761719,105.90299987792969"></path></g></g><g style="display: none;"><g><path></path></g></g><g mask="url(#__lottie_element_33)" style="display: block;"><g transform="matrix(1,0,0,1,22.730998992919922,21.097000122070312)" opacity="1"><g opacity="1" transform="matrix(1,0,0,1,3.73799991607666,4.961999893188477)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M-3.48799991607666,-4.711999893188477 C-3.48799991607666,-4.711999893188477 -0.875,-4.711999893188477 -0.875,-4.711999893188477 C-0.875,-4.711999893188477 -0.875,2.5360000133514404 -0.875,2.5360000133514404 C-0.875,2.5360000133514404 3.48799991607666,2.5360000133514404 3.48799991607666,2.5360000133514404 C3.48799991607666,2.5360000133514404 3.48799991607666,4.711999893188477 3.48799991607666,4.711999893188477 C3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 C-3.48799991607666,4.711999893188477 -3.48799991607666,-4.711999893188477 -3.48799991607666,-4.711999893188477z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M-123.23100280761719,105.90299987792969"></path></g></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g></g></svg></div><div class=""><button class="css-nje458"></button></div></div><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca/likers" aria-label="2LGTM" class="css-1otwww0">2</a></div><div class="css-tubf1g"><button class=" css-nb6j9u"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#5f6161" class="css-kfddif e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-19m4w61">3</span></div><button class="css-cgslon" type="button" aria-label="twitterでシェア"><span class="fa fa-fw fa-twitter"></span></button><button class="css-cgslon" type="button" aria-label="facebookでシェア"><span class="fa fa-fw fa-facebook"></span></button><div class="css-79elbk"><button type="button" aria-label="オプションを開く" class="css-1ydfkyi"><span class="fa fa-fw fa-ellipsis-h"></span></button><div class="css-l40u17"><div class="css-1gj7nt">記事の改善</div><a href="https://qiita.com/drafts/60ce2829a1b72dce5bca/edit" rel="nofollow" class="css-1g6mqq7"><span class="fa fa-fw fa-code-fork css-amwp7n" aria-hidden="true"></span>編集リクエストを送る</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">記事の情報</div><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca/revisions" rel="nofollow" class="css-1g6mqq7"><span class="fa fa-fw fa-history css-amwp7n" aria-hidden="true"></span>編集履歴</a><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca/patches" class="css-1g6mqq7"><span class="fa fa-fw fa-inbox css-amwp7n" aria-hidden="true"></span>編集リクエスト一覧</a><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca/likers" class="css-1g6mqq7"><span class="css-x9qlq8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="css-2ycz42"><path d="M19.1734 4.42307H14.4619L14.2696 6.15384H16.4811C16.385 6.53845 16.1927 6.92307 15.8081 7.11538C15.5196 7.40384 15.0388 7.49999 14.3658 7.49999C14.0773 7.49999 13.6927 7.40384 13.4042 7.30768C13.1158 7.11538 12.8273 6.92307 12.635 6.73076C12.3465 6.4423 12.1542 6.15384 12.0581 5.86538C11.9619 5.57692 11.8658 5.1923 11.8658 4.80769C11.8658 4.42307 11.9619 4.03846 12.0581 3.75C12.2504 3.36538 12.4427 3.07692 12.635 2.88461C12.8273 2.59615 13.1158 2.40384 13.4042 2.30769C13.6927 2.21154 13.9811 2.11538 14.3658 2.11538C14.8465 2.11538 15.2311 2.21154 15.5196 2.40384C15.9042 2.59615 16.1927 2.78846 16.385 3.07692L18.0196 1.44231C17.5388 0.961537 16.9619 0.673076 16.385 0.384615C15.8081 0.0961533 15.135 0 14.4619 0C13.7888 0 13.1158 0.0961533 12.5388 0.384615C11.8658 0.673076 11.385 0.961537 10.9042 1.44231C10.4235 1.92307 10.135 2.40384 9.84653 2.98077C9.55807 3.55769 9.46191 4.13461 9.46191 4.80769C9.46191 5.48076 9.55807 6.05768 9.84653 6.63461C10.135 7.21153 10.4235 7.6923 10.9042 8.17307C11.385 8.65384 11.9619 8.9423 12.5388 9.23076C13.1158 9.51922 13.7888 9.61537 14.4619 9.61537C15.135 9.61537 15.8081 9.51922 16.385 9.23076C16.9619 8.9423 17.5388 8.65384 17.9234 8.17307C18.3081 7.6923 18.6927 7.21153 18.885 6.53845C19.1734 5.86538 19.1734 5.19229 19.1734 4.42307Z"></path><path d="M4.07715 0.192322H1.57715V9.23077H8.30791V7.11539H4.07715V0.192322Z"></path><path d="M3.40384 13.0769H1V10.9615H8.30768V13.0769H5.90384V20H3.40384V13.0769Z"></path><path d="M12.25 14.9039L14.1731 17.7885H14.8461L16.8654 14.9039V20H19.3654V10.9615H17.1538L14.5577 14.5192L11.9615 10.9615H9.75V20H12.25V14.9039Z"></path></svg></span>LGTMしたユーザー一覧</a><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca.md" rel="nofollow" class="css-1g6mqq7"><span class="fa fa-fw fa-file-text-o css-amwp7n" aria-hidden="true"></span>Markdown で本文を見る</a><div class="css-1ode1bp"></div><button class="css-1nt9rv7"><span class="fa fa-fw fa-flag css-amwp7n" aria-hidden="true"></span>問題がある記事を報告する</button></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">どのような問題がありますか？</span></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="CommunityGuidelineViolation">コミュニティガイドライン違反</label></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="IllegalViolation">法律違反</label></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="SociallyInappropriate">社会的に不適切</label></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="SuspectedSpam">スパムの疑い</label></div><div class="st-Form st-Form-right"><button type="submit" class="css-qgrf2v e1rb7ucl0" disabled="" font-size="14">送信</button></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div id="dfp-slot-article-sidebar-top" class="ad-300x250" data-test-adunitpath="/383564218/qiita.com_items-show_sidebar-top" elementtiming="gpt-dfp-slot-article-sidebar-top" data-testid="ArticleAdsSidebarTop_AdUnit" data-google-query-id="COX26sjZ3vkCFVraTAIdmKEBXg"><div id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-top_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-top_0" name="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-top_0" title="3rd party ad content" width="300" height="250" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" role="region" aria-label="Advertisement" tabindex="0" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" style="border: 0px; vertical-align: bottom;" data-load-complete="true" data-google-container-id="1" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/saved_resource.html"></iframe></div></div></div></div><div class="p-items_toc"><div class="mt-2"><div id="dfp-slot-article-sidebar-bottom" class="ad-300x250" data-test-adunitpath="/383564218/qiita.com_items-show_sidebar-bottom" elementtiming="gpt-dfp-slot-article-sidebar-bottom" data-testid="ArticleAdsSidebarBottom_AdUnit" data-google-query-id="CP-f68jZ3vkCFfWWwgodzKML4w"><div id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-bottom_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-bottom_0" name="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-bottom_0" title="3rd party ad content" width="300" height="250" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" role="region" aria-label="Advertisement" tabindex="0" style="border: 0px; vertical-align: bottom;" data-load-complete="true" data-google-container-id="2" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/saved_resource(1).html"></iframe></div></div></div><div class="css-jm6hra"><div class="css-11ygya4"><ul>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E7%9B%AE%E6%AC%A1" class="">目次</a>
<ul>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#5%E7%AB%A0%E6%95%99%E5%B8%AB%E4%BB%98%E3%81%8D%E5%AD%A6%E7%BF%92%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92" class="">5章　教師付き学習、教師なし学習</a>
<ul>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90" class="">データ作成</a>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E6%95%99%E5%B8%AB%E4%BB%98%E3%81%8D%E5%AD%A6%E7%BF%92" class="">教師付き学習</a>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92" class="">教師なし学習</a>
</li>
</ul>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#7%E7%AB%A0%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB" class="">7章　マルコフモデル</a>
<ul>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-1" class="">データ作成</a>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A" class="">マルコフモデルのパラメータ推定</a>
</li>
</ul>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#8%E7%AB%A0%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB" class="">8章　隠れマルコフモデル</a>
<ul>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-2" class="">データ作成</a>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A" class="">隠れマルコフモデルのパラメータ推定</a>
</li>
</ul>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#9%E7%AB%A0--%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83" class="">9章  混合正規分布</a>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-3" class="">データ作成</a>
<ul>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A" class="">混合正規分布のパラメータ推定</a>
</li>
</ul>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#10%E7%AB%A0%E5%87%B8%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0" class="">10章　凸クラスタリング</a>
<ul>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-4" class="">データ作成</a>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E5%87%B8%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0%E6%B3%95" class="">凸クラスタリング法</a>
</li>
</ul>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E6%9C%80%E5%BE%8C%E3%81%AB" class="focus">最後に</a>
</li>
</ul>
</li>
</ul>
</div></div></div><div class="p-items_main"><div class="css-u681u4"><span class="fa fa-fw fa-warning css-hxgmls"></span><p>この記事は最終更新日から1年以上が経過しています。</p></div><div class="css-r67lmd"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-17zza1i"><div><div class="css-70qvj9"><a href="https://qiita.com/akiraichi5430" class="css-6su6fj"><img class="css-1ndxrmk eyfquo10" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/x_large.png" width="24" height="24" size="24" loading="lazy"></a><div class="css-1r4slzx"><a href="https://qiita.com/akiraichi5430" class="css-772dpg">@<!-- -->akiraichi5430</a></div></div><div class="css-17ay39c"><p class="css-1ay9vb9">投稿日 <time datetime="2020-08-11T05:19:52Z">2020年08月11日</time></p><p class="css-1ay9vb9">更新日 <time datetime="2020-08-11T10:45:15Z">2020年08月11日</time></p></div></div></div></div><h1 class="css-188vyrl">続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="https://qiita.com/tags/python3" class="css-1a610x3">Python3</a><span class="css-189rs1q">,</span><a href="https://qiita.com/tags/%e3%83%91%e3%82%bf%e3%83%bc%e3%83%b3%e8%aa%8d%e8%ad%98" class="css-1a610x3">パターン認識</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div><p>「続・わかりやすい パターン認識 教師なし学習入門」ではアルゴリズムのサンプルコードが公開されていません。そこで、自分で書いてみました。<br>
なお、具体的に実験をした結果は<a href="https://github.com/Akiraichi/Code_for_Algorithms" rel="nofollow noopener" target="_blank">Github</a>で公開しています。</p>

<h1>
<span id="目次" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E7%9B%AE%E6%AC%A1"><i class="fa fa-link"></i></a>目次</h1>

<ul>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#5%E7%AB%A0%E6%95%99%E5%B8%AB%E4%BB%98%E3%81%8D%E5%AD%A6%E7%BF%92%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92">5章 教師付き学習、教師なし学習</a>

<ul>
<li><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90">データ作成</a></li>
<li><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E6%95%99%E5%B8%AB%E4%BB%98%E3%81%8D%E5%AD%A6%E7%BF%92">教師付き学習</a></li>
<li><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92">教師なし学習</a></li>
</ul>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#7%E7%AB%A0%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB">7章 マルコフモデル</a>

<ul>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-1">データ作成</a> </li>
<li><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A">マルコフモデルのパラメータ推定</a></li>
</ul>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#8%E7%AB%A0%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB">8章 隠れマルコフモデル</a>

<ul>
<li><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-2">データ作成</a></li>
<li><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A">隠れマルコフモデルのパラメータ推定</a></li>
</ul>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#9%E7%AB%A0%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83">9章 混合正規分布</a>

<ul>
<li><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-3">データ作成</a></li>
<li><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A">混合正規分布のパラメータ推定</a></li>
</ul>
</li>
<li>
<a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#10%E7%AB%A0%E5%87%B8%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0">10章 凸クラスタリング</a>

<ul>
<li><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-4">データ作成</a></li>
<li><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E5%87%B8%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0%E6%B3%95">凸クラスタリング法</a></li>
</ul>
</li>
<li><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E6%9C%80%E5%BE%8C%E3%81%AB">最後に</a></li>
</ul>

<h2>
<span id="5章教師付き学習教師なし学習" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#5%E7%AB%A0%E6%95%99%E5%B8%AB%E4%BB%98%E3%81%8D%E5%AD%A6%E7%BF%92%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92"><i class="fa fa-link"></i></a>5章　教師付き学習、教師なし学習</h2>

<h3>
<span id="データ作成" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>データ作成</h3>

<p>教師付き学習、教師なし学習を適用するためのデータを作るクラスです</p>

<div class="code-frame" data-lang="python"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre><code>
<span class="k">class</span> <span class="nc">dice</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">pi</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pi</span> <span class="o">=</span> <span class="n">pi</span>

    <span class="k">def</span> <span class="nf">generate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
            <span class="n">s</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">__spots</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">pi</span><span class="p">))</span>
            <span class="n">x</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">__spots</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">theta</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]))</span>

        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span>

    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">__spots</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pi</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">pi</span><span class="p">[:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="nb">sum</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">i</span>
</code></pre></div></div>

<h3>
<span id="教師付き学習" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E6%95%99%E5%B8%AB%E4%BB%98%E3%81%8D%E5%AD%A6%E7%BF%92"><i class="fa fa-link"></i></a>教師付き学習</h3>

<p>教師付き学習のクラスです。</p>

<div class="code-frame" data-lang="python"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre><code><span class="k">class</span> <span class="nc" style="background-color: transparent; font-weight: normal;">Supervised_learning</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pi</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">theta</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">estimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__count</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pi</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">n</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="n">tile</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)).</span><span class="n">T</span>

    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">__count</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">x_</span><span class="p">,</span> <span class="n">s_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
            <span class="n">n</span><span class="p">[</span><span class="n">s_</span><span class="p">][</span><span class="n">x_</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">n</span>
</code></pre></div></div>

<h3>
<span id="教師なし学習" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92"><i class="fa fa-link"></i></a>教師なし学習</h3>

<p>教師なし学習のクラスです。</p>

<div class="code-frame" data-lang="python"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre><code>
<span class="k">class</span> <span class="nc">Unsupervised_learning</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pi</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">m</span>

        <span class="c1"># Step1 If no initial value is specified, it will be determined at random
</span>        <span class="k">if</span> <span class="n">pi</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">c</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">theta</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">m</span><span class="p">)</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">rand</span> <span class="o">/</span> <span class="n">rand</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># normalisation
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">pi</span> <span class="o">=</span> <span class="n">pi</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">p</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">estimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">collections</span><span class="p">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">values</span><span class="p">()])</span>

        <span class="c1"># Step2
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">__update_p</span><span class="p">()</span>

        <span class="c1"># termination condition
</span>        <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-6</span>
        <span class="n">log_p</span> <span class="o">=</span> <span class="o">-</span><span class="n">sys</span><span class="p">.</span><span class="n">float_info</span><span class="p">.</span><span class="nb">max</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">while</span> <span class="n">delta</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">delta</span> <span class="o">&gt;=</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="c1"># Step3
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">__update_param</span><span class="p">()</span>

            <span class="c1"># Step4
</span>            <span class="n">log_p_new</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__log_likelihood</span><span class="p">()</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">log_p_new</span> <span class="o">-</span> <span class="n">log_p</span>
            <span class="n">log_p</span> <span class="o">=</span> <span class="n">log_p_new</span>

    <span class="k">def</span> <span class="nf">__update_p</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">numer</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">pi</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">theta</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">numer</span> <span class="o">/</span> <span class="n">numer</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__update_param</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pi</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">r</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">p</span><span class="p">).</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">r</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">__update_p</span><span class="p">()</span>
        <span class="n">numer</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">r</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">p</span>
        <span class="c1"># self.theta = (numer.T / numer.sum(axis=1)).T  # if theta is known, comment out on this line.
</span>
    <span class="k">def</span> <span class="nf">__log_likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">log_p</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">((</span><span class="bp">self</span><span class="p">.</span><span class="n">pi</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">theta</span><span class="p">).</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">r</span> <span class="o">*</span> <span class="n">log_p</span><span class="p">).</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<h2>
<span id="7章マルコフモデル" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#7%E7%AB%A0%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB"><i class="fa fa-link"></i></a>7章　マルコフモデル</h2>

<h3>
<span id="データ作成-1" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-1"><i class="fa fa-link"></i></a>データ作成</h3>

<p>マルコフモデルに従ったデータを作るクラスです。</p>

<div class="code-frame" data-lang="python"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre><code>
<span class="k">class</span> <span class="nc" style="background-color: transparent; font-weight: normal;">Markov_dice</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">rho</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">rho</span>

    <span class="k">def</span> <span class="nf">generate_spots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">s</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__spots</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rho</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__spots</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">B</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__spots</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">A</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__spots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">s_t</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">theta</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">theta</span><span class="p">[</span><span class="n">s_t</span><span class="p">,</span> <span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="nb">sum</span><span class="p">():</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>
</code></pre></div></div>

<h3>
<span id="マルコフモデルのパラメータ推定" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A"><i class="fa fa-link"></i></a>マルコフモデルのパラメータ推定</h3>

<p>マルコフモデルのパラメータを推定するクラスです</p>

<div class="code-frame" data-lang="python"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre><code>
<span class="k">class</span> <span class="nc">Markov</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">A</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">B</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">m</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">estimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">__initialize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__count</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">m</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">n</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">__count</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">x_</span><span class="p">,</span> <span class="n">s_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
            <span class="n">n</span><span class="p">[</span><span class="n">s_</span><span class="p">][</span><span class="n">x_</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">m</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span>
</code></pre></div></div>

<h2>
<span id="8章隠れマルコフモデル" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#8%E7%AB%A0%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB"><i class="fa fa-link"></i></a>8章　隠れマルコフモデル</h2>

<h3>
<span id="データ作成-2" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-2"><i class="fa fa-link"></i></a>データ作成</h3>

<p><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-1">7章 マルコフモデルと同様の方法</a>でデータを作成します</p>

<h3>
<span id="隠れマルコフモデルのパラメータ推定" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A"><i class="fa fa-link"></i></a>隠れマルコフモデルのパラメータ推定</h3>

<p>隠れマルコフモデルのパラメータ推定は<a href="https://qiita.com/ta-ka/items/3e5306d0432c05909992" id="reference-8f8bb020c5585c205ebc">pythonでHMMのパラメータ推定実装</a>で詳しく説明されています。</p>

<h2>
<span id="9章--混合正規分布" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#9%E7%AB%A0--%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83"><i class="fa fa-link"></i></a>9章  混合正規分布</h2>

<h2>
<span id="データ作成-3" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-3"><i class="fa fa-link"></i></a>データ作成</h2>

<p>混合正規分布に従ったデータを作成するクラスです。</p>

<div class="code-frame" data-lang="python"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre><code>
<span class="k">class</span> <span class="nc">mixed_normal_dice</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s">"""mixed normal distribution model"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">K</span> <span class="o">=</span> <span class="n">K</span>
        <span class="c1"># If no initial value is specified, it will be determined at random
</span>        <span class="k">if</span> <span class="n">mu</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">mu</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">K</span><span class="p">):</span>
                <span class="n">mu</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">]</span>  <span class="c1"># range: -5.0 - 5.0
</span>        <span class="k">if</span> <span class="n">sigma</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sigma</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">K</span><span class="p">):</span>
                <span class="n">sigma</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mf">3.0</span><span class="p">]</span>  <span class="c1"># range: 0.0 - 3.0:
</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">sigma</span>

    <span class="k">def</span> <span class="nf">generate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mu_star</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sigma_star</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">K</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">mu</span><span class="p">.</span><span class="n">ndim</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c1"># In the case of multidimensional normal distribution
</span>                <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">scale</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">N</span> <span class="o">//</span> <span class="bp">self</span><span class="p">.</span><span class="n">K</span><span class="p">))</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">mu</span><span class="p">.</span><span class="n">ndim</span><span class="p">),</span> <span class="n">mu_star</span><span class="p">,</span> <span class="n">sigma_star</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># In the case of one-dimensional normal distribution
</span>                <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">scale</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">N</span> <span class="o">//</span> <span class="bp">self</span><span class="p">.</span><span class="n">K</span><span class="p">))</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span> <span class="n">mu_star</span><span class="p">,</span> <span class="n">sigma_star</span>
            <span class="n">mu_star</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">mu_star</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">sigma_star</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigma_star</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">scale</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<h3>
<span id="混合正規分布のパラメータ推定" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A"><i class="fa fa-link"></i></a>混合正規分布のパラメータ推定</h3>

<p>混合正規分布に従ったデータをパラメータ推定するクラスです。（グラフを描画する関数も含めています）<br>
<a href="https://qiita.com/ta-ka/items/3e8b127620ac92a32864#python%E3%81%A7%E3%81%AE%E5%AE%9F%E8%A3%85" id="reference-08e16dc0b791c3056e08">pythonで混合正規分布実装</a>を参考にしました。</p>

<div class="code-frame" data-lang="python"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre><code>
<span class="k">class</span> <span class="nc">mixed_normal_distribution</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s">"""Parameter Estimation for Mixed Normal Distribution"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">pi</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">K</span> <span class="o">=</span> <span class="n">K</span>
        <span class="c1"># If no initial value is specified, it will be determined at random
</span>        <span class="k">if</span> <span class="n">pi</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">K</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mu</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sigma</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="n">K</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pi</span> <span class="o">=</span> <span class="n">pi</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>

    <span class="k">def</span> <span class="nf">estimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="c1"># termination condition
</span>        <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.000001</span>

        <span class="c1"># Step1 initialize gmm parameter
</span>        <span class="n">Q</span> <span class="o">=</span> <span class="o">-</span><span class="n">sys</span><span class="p">.</span><span class="n">float_info</span><span class="p">.</span><span class="nb">max</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># EM algorithm
</span>
        <span class="k">while</span> <span class="n">delta</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">delta</span> <span class="o">&gt;=</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="n">gf</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__gaussian</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">sigma</span><span class="p">)</span>
            <span class="c1"># E step: example posterior probability of hidden variable gamma
</span>            <span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__estimate_posterior_likelihood</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">gf</span><span class="p">)</span>

            <span class="c1"># M step: miximize Q function by estimating mu, sigma and pi
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">__estimate_gmm_parameter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>

            <span class="c1"># calculate Q function
</span>            <span class="n">Q_new</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__calc_Q</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">Q_new</span> <span class="o">-</span> <span class="n">Q</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="n">Q_new</span>

    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">__estimate_posterior_likelihood</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">gf</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="n">pi</span><span class="p">.</span><span class="n">size</span><span class="p">))</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
            <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">gf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">l</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">y</span><span class="p">)(</span><span class="n">l</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">__gaussian</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span>

    <span class="k">def</span> <span class="nf">__estimate_gmm_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">X</span><span class="p">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))).</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">mu</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">).</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pi</span> <span class="o">=</span> <span class="n">N</span> <span class="o">/</span> <span class="n">X</span><span class="p">.</span><span class="n">size</span>

    <span class="k">def</span> <span class="nf">__calc_Q</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">sigma</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)))).</span><span class="nb">sum</span><span class="p">()</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
            <span class="n">Q</span> <span class="o">+=</span> <span class="p">(</span><span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">mu</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">sigma</span><span class="p">)).</span><span class="nb">sum</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Q</span>

    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu_star</span><span class="p">,</span> <span class="n">sigma_star</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">u</span><span class="s">'mu*: %s, sigma*: %s'</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">around</span><span class="p">(</span><span class="n">mu_star</span><span class="p">,</span> <span class="mi">3</span><span class="p">))),</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">around</span><span class="p">(</span><span class="n">sigma_star</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))))</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">u</span><span class="s">'mu : %s, sigma : %s'</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">mu</span><span class="p">,</span> <span class="mi">3</span><span class="p">))),</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))))</span>

    <span class="k">def</span> <span class="nf">graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">K</span><span class="p">):</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">__gaussian</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">])(</span><span class="n">seq</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'gmm_graph.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<h2>
<span id="10章凸クラスタリング" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#10%E7%AB%A0%E5%87%B8%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>10章　凸クラスタリング</h2>

<h3>
<span id="データ作成-4" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-4"><i class="fa fa-link"></i></a>データ作成</h3>

<p><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-3">9章 混合正規分布と同様の方法</a>でデータを作成します</p>

<h3>
<span id="凸クラスタリング法" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E5%87%B8%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0%E6%B3%95"><i class="fa fa-link"></i></a>凸クラスタリング法</h3>

<p>データを凸クラスタリングするクラスです。（グラフを描画する関数も含めています）<br>
<a href="https://qiita.com/drumichiro/items/00d4e3f6ba4be7e23fad" id="reference-0256c05069847c969dfe">凸クラスタリング法の実装と実験</a>とそのコードが載っている<a href="https://github.com/drumichiro/convex-clustering" rel="nofollow noopener" target="_blank">Convex Clustering</a>を一部参考にしました。</p>

<div class="code-frame" data-lang="python"><div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre><code>
<span class="k">class</span> <span class="nc">convex_clustering</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
        <span class="c1"># Step1 Set the variance to an appropriate value.
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pi</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">X</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">clustering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">x</span>
        <span class="c1"># Step2 Calculating a prior f
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__calc_f</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">sigma</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">__gaussian</span><span class="p">)</span>

        <span class="c1"># Step3 Set the initial value of prior probability pi
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">)</span>

        <span class="c1"># termination condition
</span>        <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-6</span>
        <span class="n">log_p</span> <span class="o">=</span> <span class="o">-</span><span class="n">sys</span><span class="p">.</span><span class="n">float_info</span><span class="p">.</span><span class="nb">max</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># Step4 Update parameters
</span>        <span class="k">while</span> <span class="n">delta</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">__update_pi</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">log_p_new</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__log_likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">log_p_new</span> <span class="o">-</span> <span class="n">log_p</span>
            <span class="n">log_p</span> <span class="o">=</span> <span class="n">log_p_new</span>

    <span class="k">def</span> <span class="nf">__calc_f</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">gauss_func</span><span class="p">):</span>
        <span class="s">"""Calculating f

        Args:
            x: pattern
            sigma: variance
            gauss_func: normal distribution function

        Returns: f

        """</span>
        <span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="n">gauss_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__update_pi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="n">numer</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">pi</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="n">numer</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">numer</span> <span class="o">/</span> <span class="n">denom</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">n</span>
        <span class="c1"># To improve the convergence efficiency, set the pi near zero to zero
</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pi_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">pi</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">pi_i</span> <span class="o">&lt;</span> <span class="mf">1e-7</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">__log_likelihood</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">((</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span><span class="p">.</span><span class="n">T</span><span class="p">).</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)).</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__gaussian</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">sigma</span><span class="p">.</span><span class="n">ndim</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># In the case of multidimensional normal distribution
</span>            <span class="n">result</span> <span class="o">=</span> <span class="n">scs</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># In the case of 1D normal distribution
</span>            <span class="n">result</span> <span class="o">=</span> <span class="n">scs</span><span class="p">.</span><span class="n">norm</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">tile</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">np</span><span class="p">.</span><span class="n">tile</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="n">sigma</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">graph</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Half an initial pi is used as threshold.
</span>        <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.01</span>
        <span class="n">mu_valid</span><span class="p">,</span> <span class="n">pi_valid</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__select_valid_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
        <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mu_valid</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"The number of used centroids is (</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="si">}</span><span class="s">) using sigma:(</span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">sigma</span><span class="p">)</span><span class="si">}</span><span class="s">)."</span><span class="p">)</span>
        <span class="n">const_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="p">.</span><span class="n">sigma</span><span class="p">,</span> <span class="p">]</span> <span class="o">*</span> <span class="n">K</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">__plot_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">X</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">__plot_gauss</span><span class="p">(</span><span class="n">mu_valid</span><span class="p">,</span> <span class="n">const_sigma</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">X</span><span class="p">,</span> <span class="n">pi_valid</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__plot_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">sigma</span><span class="p">.</span><span class="n">ndim</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">T</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">"bo"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span> <span class="o">*</span> <span class="mi">4</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s">"b"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__plot_gauss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">pi</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">sigma</span><span class="p">.</span><span class="n">ndim</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># In the case of multidimensional normal distribution
</span>            <span class="n">delta</span> <span class="o">=</span> <span class="mf">0.025</span>  <span class="c1"># Sampling rate of contour.
</span>            <span class="n">x_min</span><span class="p">,</span> <span class="n">y_min</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">floor</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="nb">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">x_max</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">delta</span><span class="p">),</span>
                               <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">delta</span><span class="p">))</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">X</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">.</span><span class="n">T</span><span class="p">]).</span><span class="n">T</span>

            <span class="n">circle_rate</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Adjust size of a drawn circle.
</span>            <span class="n">Z</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mu</span><span class="p">)):</span>
                <span class="n">Z</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__gaussian</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">circle_rate</span><span class="p">)</span> <span class="o">*</span> <span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s">"g"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># In the case of 1D normal distribution
</span>            <span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">floor</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="nb">min</span><span class="p">()),</span> <span class="n">np</span><span class="p">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="nb">max</span><span class="p">()),</span> <span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">)</span>
            <span class="n">weight</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">n</span> <span class="o">/</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">)</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mu</span><span class="p">)):</span>
                <span class="n">dist</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__gaussian</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="s">"g"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">__select_valid_centroid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
        <span class="s">"""
        1 Get the index of the most probable pi
        2 Add the highest prior probability x value (centroid) to mu
        3 Add the highest prior probability pi value to the ratio
        4 If it is below the threshold, break

        Args:
            x: Data (centroid)
            pi: prior probability
            threshold: The threshold for judging prior probability pi as valid

        Returns: Prior probability pi determined to be valid and its centroid

        """</span>
        <span class="n">mu_valid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">pi_valid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">indexs</span> <span class="o">=</span> <span class="n">pi</span><span class="p">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">indexs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">pi</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">row</span><span class="p">:</span>
                    <span class="n">mu_valid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">mu_valid</span><span class="p">,</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">mu_valid</span><span class="p">.</span><span class="n">size</span> <span class="o">//</span> <span class="n">row</span><span class="p">))</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mu_valid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">mu_valid</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                <span class="n">pi_valid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pi_valid</span><span class="p">,</span> <span class="n">pi</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">mu_valid</span><span class="p">,</span> <span class="n">pi_valid</span>

</code></pre></div></div>

<h2>
<span id="最後に" class="fragment"></span><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca#%E6%9C%80%E5%BE%8C%E3%81%AB"><i class="fa fa-link"></i></a>最後に</h2>

<p>11章〜13章は勉強中です。<br>
間違い等あれば、コメントにてご指摘お願いします。</p>
</div></div></section><div class="css-1yzj1fm"><button class="css-l1ga49" type="button" aria-label="twitterでシェア"><span class="fa fa-fw fa-twitter"></span></button><button class="css-l1ga49" type="button" aria-label="facebookでシェア"><span class="fa fa-fw fa-facebook"></span></button></div><div class="css-1un4bh8"><div class="css-1zr5f9">ユーザー登録して、Qiitaをもっと便利に使ってみませんか。</div><ol class="css-dwar2a"><li>あなたにマッチした記事をお届けします<div class="css-1n56tva">ユーザーやタグをフォローすることで、あなたが興味を持つ技術分野の情報をまとめてキャッチアップできます</div></li><li>便利な情報をあとで効率的に読み返せます<div class="css-1n56tva">気に入った記事を「ストック」することで、あとからすぐに検索できます</div></li><div><a href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank" class="css-1ty75sn"><i class="fa fa-fw fa-arrow-circle-right"></i>より詳しく</a></div></ol><a href="https://qiita.com/signup?callback_action=login_or_signup&amp;redirect_to=%2Fakiraichi5430%2Fitems%2F60ce2829a1b72dce5bca&amp;realm=qiita" rel="nofollow" class="css-16dbybf">ユーザー登録</a><a href="https://qiita.com/login?callback_action=login_or_signup&amp;redirect_to=%2Fakiraichi5430%2Fitems%2F60ce2829a1b72dce5bca&amp;realm=qiita" rel="nofollow" class="css-st6exv">ログイン</a></div></div><div class="css-r67lmd"><div><div class="css-k008qs"><div class="css-1jbemfh"><a href="https://qiita.com/akiraichi5430"><img loading="lazy" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/https___s3-ap-northeast-1.amazonaws.com_qiita-image-store_0_252164_edfa4333ea66c515f9341ae8532143aaff509495_x_large.png_1597115905" alt="akiraichi5430" class="css-yj4pll"></a></div><div><div><a href="https://qiita.com/akiraichi5430" class="css-1j67hsy"></a></div><div><a href="https://qiita.com/akiraichi5430" class="css-k4iwtg">@akiraichi5430</a></div><div class="css-1lrubrq">高専生でした。今は専攻科生です。そして大学院生になりました。（時が経つのは早いな…）</div><div class="css-mifb2i"><div class="css-52rh9n"><button class="css-10keyvc">フォロー</button></div><div class="css-1b0wzno"><a href="https://qiita.com/akiraichi5430/feed" target="_blank" class="css-9exaa8"><span class="fa fa-fw fa-rss css-8fyty9"></span></a></div></div></div></div></div></div><div class="css-r67lmd"><div><div class="css-1gx4cfw"><div class="css-1hp6i1l"><div id="dfp-slot-article-after-body-for-mobile" class="ad-336x280" data-test-adunitpath="/383564218/qiita.com_items-show_under-article-mobile" elementtiming="gpt-dfp-slot-article-after-body-for-mobile" data-testid="ArticleAdsAfterBody_AdUnit" data-google-query-id="CL23qsnZ3vkCFY17Kgod-2UAHQ"><div id="google_ads_iframe_/383564218/qiita.com_items-show_under-article-mobile_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/383564218/qiita.com_items-show_under-article-mobile_0" name="google_ads_iframe_/383564218/qiita.com_items-show_under-article-mobile_0" title="3rd party ad content" width="336" height="280" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" role="region" aria-label="Advertisement" tabindex="0" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" style="border: 0px; vertical-align: bottom;" data-load-complete="true" data-google-container-id="3" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/saved_resource(2).html"></iframe></div></div></div></div></div></div><div class="css-cejglh"><div class="css-lkue19"><div id="logly-lift-4279493" visibility="visible"><div id="logly-lift-widget">  <div id="logly-lift-widget-header">    <span>関連記事</span>    <span class="logly-lift-credit logly-lift-credit2"><a href="https://www.logly.co.jp/privacy.html" target="_top" rel="nofollow noopener">Recommended by <span class="logly-lift-credit-logo" title="logly"></span></a></span>  </div>  <div id="logly-lift-widget-content">    <div class="logly-lift-ad logly-lift-loaded">  <span class="logly-lift-ad-icon"><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/a5d64ed2965371460f368c30aef445ef.webp" width="18"></span>  <div　class="logly-lift-ad-content">    <a class="logly-lift-ad-link" href="https://qiita.com/rana_kualu/items/c66f84235c2dd6bbe51f" target="_top" style="text-decoration:none;" data-click-url="https://dsp.logly.co.jp/click?ad=4AG4hpsDG-R5qSvd0lQJ1yITvUvCcTLBfyCWW-o9WfSRXTPc7YsJfxQYlLjutj6_3Kf1K2N1tLvWJXk1eGdTMbqrYCwfS5zvU6mB6uY14HLIrte6ztXcid0sT-N6-Ldz7shcXnP_W4W5UCnv42NA0yoV2CH4H1EfMr5FbhSh8V___5rekf12fSVsrN1N4mxyPKmSedvj61I0i4mzwAMsuJMbeM1rdYw05rNS6OYcNHXRHwyZekviOf2e8jdTqmW44FvWd5oWjsLJb75GKnY3Vt2FbX3Z0Jpjq-XuH0X-rSbnyrR-7fJyZDjshnboDLAmMseauevCwER6ZzqErvRsOhq3TsodYpt-0lZbM9VJ_Vd0raz1aSwVLIT09DiDbqmc3RMUrmrCaFzvbQChwY2MDTSZ9S4ByLmzELrtoTYvco2Kw7Q6j4IlfEIzXQHbJmwiKXzLVTQ928bOHq9kQF2epG1Jk4nI2tGcF51hNv9taDPzscfxWH4UkH5hMJY2yo5Rysb1Apx1I3D2voycTwBr4vzgsjcgBe2yG_lyvvqQNXyjveXa9kYPPn1_XmouX7xRxvwIU1KCS_gmEdMIkA5BC8qhUctoJbnWDXyhjkUlHLFpC_OH3PqbrPT3AnuwO2h_T-OyLdAvllqrAV72NJ5ixg">      <span class="logly-lift-ad-title">JavaScriptの生みの親「自動セミコロン挿入やめときゃよかった……」</span>    </a>    <span class="logly-lift-ad-author">by rana_kualu</span><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/abc" width="1" height="1" style="position: absolute; width: 1px; height: 1px; top: -32767px; left: -32767px;" alt="">  </div　class="logly-lift-ad-content"></div></div><div class="logly-lift-ad logly-lift-loaded">  <span class="logly-lift-ad-icon"><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/0cd4533db241817db7edeee5688fccea.webp" width="18"></span>  <div　class="logly-lift-ad-content">    <a class="logly-lift-ad-link" href="https://qiita.com/soh_mitian/items/feb5f9d2d81d0db5d606" target="_top" style="text-decoration:none;" data-click-url="https://dsp.logly.co.jp/click?ad=4AG4hpsDG-R5qSvd0lQJ1yITvUvCcTLBfyCWW-o9WfQwOsX3dHTxvt-bmXWemlbtqcnWG5dSn_untWcc8EUZ0uN0Cy8P3V4hg3Fz-f-v-KxhYHEdNEZG4nZkc8z8rBl6hoPUTnSyZ5RPFyh63IUFr1UMKFC--M0n_aZfH8XwmeShHYRDOrtMcsTLrNqpdUWqsyxkhn_ayaHe6we1Uta_Dh35bAEJKVAClq3plWjetMyVlyWAxoN4oQjnwiShBk8Y0B1mfEPDJ2-v6wyaOCg8vV184w5dKWoP1O3iu5mc2Dcb8Wy88k8pzmjPcBQ0NYScgeq5LOK8SX6btYeibdgZAtnNmHFxUBWORUFXBlJOojX5jkA_7ItcQdi5CCQcCj44x-7l-l1J2GXpeQwXRS1usKciha1CHnraKZGUoHrhSb9yy2PCa6Did5kwWkorMKcxe93An_9UZj_OuizhVbg88fi_AaXSn-_P7CEKvH5UQhxDPdZ4MQeJ016lBrNx7Tf1Xr3DSVn7iO9gEbWw_GgRp0fXmbYH7dpTIY2iOH4e47SLWYhM-0K15fQBST4awk05rAE0KTXyFUtY_noIu10d-D7MM8H9r4igHfndf4tw-oBCAZqxup4DMjFWQa6Z57QzvRUWTGPgwzc8zIG3sCN26g">      <span class="logly-lift-ad-title">あの最強ハッカー「ウォールナット」の七つ道具の一つ「Internet Automatic Searc...</span>    </a>    <span class="logly-lift-ad-author">by soh_mitian</span>  </div　class="logly-lift-ad-content"></div></div><div class="logly-lift-ad logly-lift-loaded">  <span class="logly-lift-ad-icon"><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/307ac3fb9ba6cea613a1f1194a54951f.webp" width="18"></span>  <div　class="logly-lift-ad-content">    <a class="logly-lift-ad-link" href="https://qiita.com/yz2cm/items/486fd3f57491f6544431" target="_top" style="text-decoration:none;" data-click-url="https://dsp.logly.co.jp/click?ad=4AG4hpsDG-R5qSvd0lQJ1yITvUvCcTLBfyCWW-o9WfR_L8mrAV9z_vYuKDhrr4fz55UrgXP-9TJSo_IL3VK-fle3bq2unn6DTHM1lnURVxsqySv61gYvxnIiyjvD2tEwmBFO9viVcAj-6S3RdG9vV4aBgmVojbMiHPxxHOS9EXbHw0lJQ9YihA66dMz8NoITPskMru5dO4wyKd94JetIm09S1zylngOIPa3fhNCWc1dutQMohE47SsnN0LSy5ljKeFuFw8nzvhMlJXic4IIloOLRSxVBKP1R2fVyCoRgE5lhe9KCMA2Wcqv7xxjzA7nmOviFPh2W-xL1DBO_i-Prgjebu4MQegS-4sBFzt7OSu0103N-KJoP-zn3lnD6CUbCEW9Ln8--RV937mbppQbyW65v3xWFvp4tEsfwUSuj_VoQ5G3uZ3oXkCQnmpl3i-gt0-IiEq3Y0kLeuQU1hN4PKoHqMkjja0KUZQlz5SiAMryByzOuYW3QxJ1i85_gSCFJeWszd5xsPHnlh_PuagbsPa82ziL1O_k5kg74k3fq8ytJnUkXhOaEt25n_KNCfKYmIFfJDvlJXcAveaQW0SXWZTxJC19maP7Iuay1REjquAgRBc0JSHvggQqziBC91eYW">      <span class="logly-lift-ad-title">「何を言っているのか分からない」と言われないための「伝え方」のノウハウ</span>    </a>    <span class="logly-lift-ad-author">by yz2cm</span>  </div　class="logly-lift-ad-content"></div><div class="logly-lift-ad logly-lift-loaded">  <span class="logly-lift-ad-icon"><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/a0a96ccc097bf17f62072af2d301df2f.webp" width="18"></span>  <div　class="logly-lift-ad-content">    <a class="logly-lift-ad-link" href="https://qiita.com/narupo/items/b9ee0f3b567708a2addf" target="_top" style="text-decoration:none;" data-click-url="https://dsp.logly.co.jp/click?ad=4AG4hpsDG-R5qSvd0lQJ1yITvUvCcTLBfyCWW-o9WfRgsfsXUxhpHvQPvtCq5Z0Le0CEU81dneOmEKNfs81eOOzQIpRp9O2gOBBuLfEbw-KzYyLZ6hG3wXSTcjAwl45fLuaR-mLMalw5zAVT0qLWZLmvlLZMjiN3N5MNvPSrOPWHwkLcIbNz527CwEt9Q2UniGfOBfypBfRlViaqrXhORPg_Zl3qzVDBxmPWEEcP7KnZksds9TxRla7vaq0uotpxp5QKBE0LEwRzpOwfnus9TqRGVE-ZEbLgSb6KIPo94m3V2ygCtuy-44MBjBLhHlm_Skud0Cr_o5hgj3UP_XEI1TC-f-kyrB6GT-i-D1I9rOn2DpnTiBUbDKr89LuqukyFOa5J7uABX0mqcbPNKIAyIRg0-g0Ve8qO8Nu_PGbDFEGFg6pXbyukoyaWoLkAlfnE_z8FPVQW_mNfLHR76EPgpUB4BH9iZHPbnAlfQlPwYUtXs-tbgn7deTYcSMF6bkDLCDmKB3kd9MbZeiIO8xy8c4280o8L2cK3MZEKaJkKmcFAy7KraVjbBE8jVpMuI-5dg9OhEIVp1qmzeB9gwiwTqV3-xdDxjIsA_dsHLVAKNH50C-LnAkBC4Y8Cy1QGo2yO">      <span class="logly-lift-ad-title">【小説】バグ解決できない新人女子と怪しいおっさん</span>    </a>    <span class="logly-lift-ad-author">by narupo</span>  </div　class="logly-lift-ad-content"></div><div class="logly-lift-ad logly-lift-loaded">    <span class="logly-lift-ad-icon"><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/normal.webp" width="18"></span>    <div　class="logly-lift-ad-content">      <a class="logly-lift-ad-link" href="https://dsp.logly.co.jp/click?ad=4AG4hpsDG-R5qSvd0lQJ1yITvUvCcTLB5mNZ0Ri8mAX4LdN2zFAFP1WtfHf6VlwY52n3J0zEAaAAdme2hrGfaYkS9E3SrySPbuJYEM2RYC4ogHm883y3QUUBmq4lp1xWldnzUEU2HjSSPTPleTmXcZFSfS55GIJndPtDOPp3ftvEI10qQmWYmooGEw8peypN0cABwtUMZ5BuJV9_8QUdoeKFcLcBOTK_ajZ3NY0eSqECTCOUIzydfoQBzlhZO0czlQH8SodH8dPVVHFdY6BMCwM8p_De9jd63bOmeX5c35SHr1qPPQkKRaKyR5JU8OQxJ_E67RXt9P51IGuRiIi_bRdejyTMDVYVxDLFmx2RGKFQp2G_Iga27P-mvY_CTgZzRzBi6M_CL_tX_yvt0rPoXIzplHy3bU6wbtvCA7j3GXbOFNVYPDRVnmcze8hhjPRjwubC5OlfUBtr__YYcdutYaCTOUAy-0AegwwmXnmYCgDRWHcbVv2shI84iDxOT6bHFqfuT_MxPlqkwEeLAgNFFYaP5eazr_CkBfT7GmYMYAhtDGipN9AhiggN3UjaD-vPw3Ei4J0wTUZSgmmKoW2jG9zrZPm5Sa8xaE3tukH3xuXJ_RuIAQ8su-_YtyWPJSbT_MsjbTceYXMYSJXbikmoPiUF7iXhcqq8UM1zo7fPNr-hQFZouRODW3mwTx002IwJW6Tdxkj7NQc" target="_blank" style="text-decoration:none;" rel="nofollow noopener">        <span class="logly-lift-ad-title">アメリカ人社長が日本人採用で用いる評価基準が興味深い</span>      </a><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/bc" width="1" height="1" style="position: absolute; width: 1px; height: 1px; top: -32767px; left: -32767px;" alt="">      <span class="logly-lift-ad-adv">PR ビズヒント</span>    </div　class="logly-lift-ad-content"></div><div class="logly-lift-ad logly-lift-loaded">    <span class="logly-lift-ad-icon"><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/original.webp" width="18"></span>    <div　class="logly-lift-ad-content">      <a class="logly-lift-ad-link" href="https://dsp.logly.co.jp/click?ad=4AG4hpsDG-R5qSvd0lQJ1yITvUvCcTLBbUEI2BRw3XlzA6617Tg0w-VptMPEi5Haj6JxsiasoIIMYrdTt4slJiQpRVsv3iHBPtOSI0BmoTZ2VojV1lwS6H9GhO7A1p4KAP7kGBRAUaNX7SlhK5GuYTfQzDrwDLlW54g9j7aCFDAu-gm2gJKjL9L5s7ghav7FTcNEjqjXuscRNL8bIt_Hh5qWywLWCpawCmmARvnS-0oE_Do0mMMz8nzWU1-6Kq3g9SeW-ytIBGrREqfX0-mwSG8hAJGIvgg34elJshP0xTyMLhHb2DW3EQ4pk6r-tmBl3dF-lacME3jsKHZS-Cbkblzk-RdtWaeXqMnWvrLMs3wpHEe5r6v4GJTp6fDuYD-aXiV_sTIe_KDyUQ7wWISLIV3APtooLu5V92-iChU9YE5OJ-fxtMJ6xzi1KFbyIe1WZNh0oMrJGB4rWVaG8jZ_OZFvVfTktTsUtEGPIaOgOn1rQigaIvPzpiSLcHHpyBUp-m3LAOgpA4e_-eYk5ezE7wqa6BCXn5ZbkYwjQ2vlGZXu5plhyQ_qufb6QuyxaRHnNRh7L6HTU_XR8tCxkkN0J8KZIwTomW1ATHY1wGgfsZA" target="_blank" style="text-decoration:none;" rel="nofollow noopener">        <span class="logly-lift-ad-title">優秀なRubyエンジニアが集うパソナテックの「島根Lab」とは</span>      </a><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/bc(1)" width="1" height="1" style="position: absolute; width: 1px; height: 1px; top: -32767px; left: -32767px;" alt="">      <span class="logly-lift-ad-adv">PR 株式会社パソナテック</span>    </div　class="logly-lift-ad-content"></div>    <div class="logly-lift-clear"></div></div></div></div><div><div class="css-cejglh"><div id="comments" class="css-8atqhb"><p class="css-1r0y2zt">コメント</p><div class="css-1gbpb5n">この記事にコメントはありません。</div><div class="css-13b2478"><div class="css-15k3zid">あなたもコメントしてみませんか :)</div><a href="https://qiita.com/signup?callback_action=login_or_signup&amp;redirect_to=https%3A%2F%2Fqiita.com%2Fakiraichi5430%2Fitems%2F60ce2829a1b72dce5bca&amp;realm=qiita" rel="nofollow" class="css-1f5p3ds">ユーザー登録</a><div class="css-164r41r">すでにアカウントを持っている方は<a href="https://qiita.com/login?callback_action=login_or_signup&amp;redirect_to=https%3A%2F%2Fqiita.com%2Fakiraichi5430%2Fitems%2F60ce2829a1b72dce5bca&amp;realm=qiita" rel="nofollow">ログイン</a></div></div></div></div></div><div class="css-t60cq9"><span class="css-1t1ffag">記事投稿イベント開催中</span><div class="css-14g0l14"><div class="css-1uyxiwx"><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/original.jpg" alt="" class="css-7wh13m"></div><div class="css-1bsp11"><span class="css-rcex3m">Go強化月間～開発する上で知っておくべき知見を共有しよう～</span><div class="css-bibwyp"><time datetime="2022-08-14T15:00:00Z">2022/08/15</time><span>~</span><time datetime="2022-09-16T14:59:00Z">2022/09/16</time></div><a href="https://qiita.com/official-events/ae80b010f51f7018891a" class="css-xhf1f8"><button class="css-qgrf2v e1rb7ucl0" font-size="14">イベント詳細を見る</button></a></div></div><div class="css-14g0l14"><div class="css-1uyxiwx"><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/original(1).jpg" alt="" class="css-7wh13m"></div><div class="css-1bsp11"><span class="css-rcex3m">エンジニア夏休み企画！～自由研究や読書感想文を発表しよう～</span><div class="css-bibwyp"><time datetime="2022-08-14T15:00:00Z">2022/08/15</time><span>~</span><time datetime="2022-09-16T14:59:00Z">2022/09/16</time></div><a href="https://qiita.com/official-events/6d31965c499a69377c0b" class="css-xhf1f8"><button class="css-qgrf2v e1rb7ucl0" font-size="14">イベント詳細を見る</button></a></div></div><div class="css-14vcyta"><span class="fa fa-fw fa-arrow-circle-right css-15ro776"></span><a href="https://qiita.com/official-events" class="css-p9qzma">すべて見る</a></div></div></div></div></div><div class="css-gjiyxx"><div class="css-5jpx49"><div class="css-10h2231"><div class="css-1duml6f"><div style="width:64px;height:64px;overflow:hidden;margin:0 auto;outline:none;left:50%;position:absolute;top:50%;transform:translate(-50%, -50%)" title="" role="" aria-label="animation" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="64" height="64" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: 100%; transform: translate3d(0px, 0px, 0px); content-visibility: visible;"><defs><clippath id="__lottie_element_58"><rect width="64" height="64" x="0" y="0"></rect></clippath><mask id="__lottie_element_89" mask-type="alpha"><g style="display: none;"><g><path></path></g></g></mask></defs><g clip-path="url(#__lottie_element_58)"><g transform="matrix(1,0,0,1,11,11)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,21,21)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M0,-19 C0,-19 0,-19 0,-19 C10.493000030517578,-19 19,-10.494000434875488 19,0 C19,10.493000030517578 10.493000030517578,19 0,19 C-10.494000434875488,19 -19,10.493000030517578 -19,0 C-19,-10.494000434875488 -10.494000434875488,-19 0,-19z"></path><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="4" stroke="rgb(85,197,0)" stroke-opacity="1" stroke-width="2" d=" M0,-19 C0,-19 0,-19 0,-19 C10.493000030517578,-19 19,-10.494000434875488 19,0 C19,10.493000030517578 10.493000030517578,19 0,19 C-10.494000434875488,19 -19,10.493000030517578 -19,0 C-19,-10.494000434875488 -10.494000434875488,-19 0,-19z"></path></g></g><g transform="matrix(1,0,0,1,31.253000259399414,32.73200225830078)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,5.218999862670898,4.959000110626221)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-0.33500000834465027,2.4159998893737793 C-0.33500000834465027,2.4159998893737793 -2.3550000190734863,-0.5899999737739563 -2.3550000190734863,-0.5899999737739563 C-2.3550000190734863,-0.5899999737739563 -2.3550000190734863,4.709000110626221 -2.3550000190734863,4.709000110626221 C-2.3550000190734863,4.709000110626221 -4.968999862670898,4.709000110626221 -4.968999862670898,4.709000110626221 C-4.968999862670898,4.709000110626221 -4.968999862670898,-4.709000110626221 -4.968999862670898,-4.709000110626221 C-4.968999862670898,-4.709000110626221 -2.6670000553131104,-4.709000110626221 -2.6670000553131104,-4.709000110626221 C-2.6670000553131104,-4.709000110626221 -0.01600000075995922,-0.9629999995231628 -0.01600000075995922,-0.9629999995231628 C-0.01600000075995922,-0.9629999995231628 2.694999933242798,-4.709000110626221 2.694999933242798,-4.709000110626221 C2.694999933242798,-4.709000110626221 4.968999862670898,-4.709000110626221 4.968999862670898,-4.709000110626221 C4.968999862670898,-4.709000110626221 4.968999862670898,4.709000110626221 4.968999862670898,4.709000110626221 C4.968999862670898,4.709000110626221 2.3550000190734863,4.709000110626221 2.3550000190734863,4.709000110626221 C2.3550000190734863,4.709000110626221 2.3550000190734863,-0.5609999895095825 2.3550000190734863,-0.5609999895095825 C2.3550000190734863,-0.5609999895095825 0.3009999990463257,2.4159998893737793 0.3009999990463257,2.4159998893737793 C0.3009999990463257,2.4159998893737793 -0.33500000834465027,2.4159998893737793 -0.33500000834465027,2.4159998893737793z"></path></g></g><g transform="matrix(1,0,0,1,22.149999618530273,32.72599792480469)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,4.031000137329102,4.961999893188477)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-1.2940000295639038,-2.5350000858306885 C-1.2940000295639038,-2.5350000858306885 -3.7809998989105225,-2.5350000858306885 -3.7809998989105225,-2.5350000858306885 C-3.7809998989105225,-2.5350000858306885 -3.7809998989105225,-4.711999893188477 -3.7809998989105225,-4.711999893188477 C-3.7809998989105225,-4.711999893188477 3.7809998989105225,-4.711999893188477 3.7809998989105225,-4.711999893188477 C3.7809998989105225,-4.711999893188477 3.7809998989105225,-2.5350000858306885 3.7809998989105225,-2.5350000858306885 C3.7809998989105225,-2.5350000858306885 1.2990000247955322,-2.5350000858306885 1.2990000247955322,-2.5350000858306885 C1.2990000247955322,-2.5350000858306885 1.2990000247955322,4.711999893188477 1.2990000247955322,4.711999893188477 C1.2990000247955322,4.711999893188477 -1.2940000295639038,4.711999893188477 -1.2940000295639038,4.711999893188477 C-1.2940000295639038,4.711999893188477 -1.2940000295639038,-2.5350000858306885 -1.2940000295639038,-2.5350000858306885z"></path></g></g><g transform="matrix(1,0,0,1,31.006000518798828,21.350000381469727)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,5.2769999504089355,5.206999778747559)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M0.09700000286102295,-0.40400001406669617 C0.09700000286102295,-0.40400001406669617 4.982999801635742,-0.40400001406669617 4.982999801635742,-0.40400001406669617 C5.0269999504089355,0.4059999883174896 4.934000015258789,1.1369999647140503 4.705999851226807,1.7960000038146973 C4.484000205993652,2.4549999237060547 4.1539998054504395,3.0169999599456787 3.7219998836517334,3.48799991607666 C3.2909998893737793,3.9570000171661377 2.7730000019073486,4.322000026702881 2.1659998893737793,4.573999881744385 C1.5609999895095825,4.830999851226807 0.8970000147819519,4.955999851226807 0.18400000035762787,4.955999851226807 C-0.5389999747276306,4.955999851226807 -1.2170000076293945,4.824999809265137 -1.847000002861023,4.567999839782715 C-2.4769999980926514,4.310999870300293 -3.0299999713897705,3.9579999446868896 -3.5,3.507999897003174 C-3.9700000286102295,3.056999921798706 -4.3429999351501465,2.5339999198913574 -4.614999771118164,1.9279999732971191 C-4.886000156402588,1.3220000267028809 -5.0269999504089355,0.6809999942779541 -5.0269999504089355,-0.007000000216066837 C-5.0269999504089355,-0.6949999928474426 -4.890999794006348,-1.340000033378601 -4.614999771118164,-1.940999984741211 C-4.339000225067139,-2.5369999408721924 -3.9700000286102295,-3.065999984741211 -3.5,-3.51200008392334 C-3.0299999713897705,-3.9630000591278076 -2.4769999980926514,-4.310999870300293 -1.847000002861023,-4.567999839782715 C-1.2170000076293945,-4.824999809265137 -0.5389999747276306,-4.955999851226807 0.18400000035762787,-4.955999851226807 C0.9100000262260437,-4.955999851226807 1.5889999866485596,-4.824999809265137 2.2200000286102295,-4.567999839782715 C2.8499999046325684,-4.310999870300293 3.4079999923706055,-3.947000026702881 3.8970000743865967,-3.4769999980926514 C3.8970000743865967,-3.4769999980926514 2.196000099182129,-1.7769999504089355 2.196000099182129,-1.7769999504089355 C1.968000054359436,-2.0820000171661377 1.6820000410079956,-2.322999954223633 1.3320000171661377,-2.503000020980835 C0.984000027179718,-2.681999921798706 0.6010000109672546,-2.7750000953674316 0.17900000512599945,-2.7750000953674316 C-0.17900000512599945,-2.7750000953674316 -0.5189999938011169,-2.7019999027252197 -0.8339999914169312,-2.561000108718872 C-1.1490000486373901,-2.4210000038146973 -1.4210000038146973,-2.2269999980926514 -1.6579999923706055,-1.9800000190734863 C-1.8899999856948853,-1.7319999933242798 -2.075000047683716,-1.4420000314712524 -2.2160000801086426,-1.1019999980926514 C-2.3510000705718994,-0.7630000114440918 -2.4200000762939453,-0.39399999380111694 -2.4200000762939453,0.003000000026077032 C-2.4200000762939453,0.3959999978542328 -2.3510000705718994,0.7630000114440918 -2.2160000801086426,1.1019999980926514 C-2.0799999237060547,1.4420000314712524 -1.8960000276565552,1.7389999628067017 -1.6579999923706055,1.9859999418258667 C-1.4249999523162842,2.2330000400543213 -1.1490000486373901,2.4260001182556152 -0.8339999914169312,2.565999984741211 C-0.5189999938011169,2.7070000171661377 -0.17900000512599945,2.7809998989105225 0.17900000512599945,2.7809998989105225 C0.8330000042915344,2.7809998989105225 1.3320000171661377,2.6589999198913574 1.687000036239624,2.4170000553131104 C2.0399999618530273,2.174999952316284 2.2730000019073486,1.840000033378601 2.3889999389648438,1.4229999780654907 C2.3889999389648438,1.4229999780654907 0.09200000017881393,1.4229999780654907 0.09200000017881393,1.4229999780654907 C0.09200000017881393,1.4229999780654907 0.09700000286102295,-0.40400001406669617 0.09700000286102295,-0.40400001406669617z"></path></g></g><g transform="matrix(1,0,0,1,22.730998992919922,21.097000122070312)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,3.73799991607666,4.961999893188477)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-3.48799991607666,-4.711999893188477 C-3.48799991607666,-4.711999893188477 -0.875,-4.711999893188477 -0.875,-4.711999893188477 C-0.875,-4.711999893188477 -0.875,2.5360000133514404 -0.875,2.5360000133514404 C-0.875,2.5360000133514404 3.48799991607666,2.5360000133514404 3.48799991607666,2.5360000133514404 C3.48799991607666,2.5360000133514404 3.48799991607666,4.711999893188477 3.48799991607666,4.711999893188477 C3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 C-3.48799991607666,4.711999893188477 -3.48799991607666,-4.711999893188477 -3.48799991607666,-4.711999893188477z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-123.23100280761719,105.90299987792969"></path></g></g><g style="display: none;"><g><path></path></g></g><g mask="url(#__lottie_element_89)" style="display: block;"><g transform="matrix(1,0,0,1,22.730998992919922,21.097000122070312)" opacity="1"><g opacity="1" transform="matrix(1,0,0,1,3.73799991607666,4.961999893188477)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M-3.48799991607666,-4.711999893188477 C-3.48799991607666,-4.711999893188477 -0.875,-4.711999893188477 -0.875,-4.711999893188477 C-0.875,-4.711999893188477 -0.875,2.5360000133514404 -0.875,2.5360000133514404 C-0.875,2.5360000133514404 3.48799991607666,2.5360000133514404 3.48799991607666,2.5360000133514404 C3.48799991607666,2.5360000133514404 3.48799991607666,4.711999893188477 3.48799991607666,4.711999893188477 C3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 C-3.48799991607666,4.711999893188477 -3.48799991607666,-4.711999893188477 -3.48799991607666,-4.711999893188477z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M-123.23100280761719,105.90299987792969"></path></g></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g></g></svg></div><div class=""><button class="css-nje458"></button></div></div><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca/likers" aria-label="2LGTM" class="css-3ebp5j">2</a></div><div class="css-92283"><button class=" css-nb6j9u"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#5f6161" class="css-kfddif e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1o09fmu">3</span></div><div class="css-79elbk"><button type="button" aria-label="オプションを開く" class="css-1ydfkyi"><span class="fa fa-fw fa-ellipsis-h"></span></button><div class="css-7i7f4d"><div class="css-1gj7nt">記事の改善</div><a href="https://qiita.com/drafts/60ce2829a1b72dce5bca/edit" rel="nofollow" class="css-1g6mqq7"><span class="fa fa-fw fa-code-fork css-amwp7n" aria-hidden="true"></span>編集リクエストを送る</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">記事の情報</div><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca/revisions" rel="nofollow" class="css-1g6mqq7"><span class="fa fa-fw fa-history css-amwp7n" aria-hidden="true"></span>編集履歴</a><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca/patches" class="css-1g6mqq7"><span class="fa fa-fw fa-inbox css-amwp7n" aria-hidden="true"></span>編集リクエスト一覧</a><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca/likers" class="css-1g6mqq7"><span class="css-x9qlq8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="css-2ycz42"><path d="M19.1734 4.42307H14.4619L14.2696 6.15384H16.4811C16.385 6.53845 16.1927 6.92307 15.8081 7.11538C15.5196 7.40384 15.0388 7.49999 14.3658 7.49999C14.0773 7.49999 13.6927 7.40384 13.4042 7.30768C13.1158 7.11538 12.8273 6.92307 12.635 6.73076C12.3465 6.4423 12.1542 6.15384 12.0581 5.86538C11.9619 5.57692 11.8658 5.1923 11.8658 4.80769C11.8658 4.42307 11.9619 4.03846 12.0581 3.75C12.2504 3.36538 12.4427 3.07692 12.635 2.88461C12.8273 2.59615 13.1158 2.40384 13.4042 2.30769C13.6927 2.21154 13.9811 2.11538 14.3658 2.11538C14.8465 2.11538 15.2311 2.21154 15.5196 2.40384C15.9042 2.59615 16.1927 2.78846 16.385 3.07692L18.0196 1.44231C17.5388 0.961537 16.9619 0.673076 16.385 0.384615C15.8081 0.0961533 15.135 0 14.4619 0C13.7888 0 13.1158 0.0961533 12.5388 0.384615C11.8658 0.673076 11.385 0.961537 10.9042 1.44231C10.4235 1.92307 10.135 2.40384 9.84653 2.98077C9.55807 3.55769 9.46191 4.13461 9.46191 4.80769C9.46191 5.48076 9.55807 6.05768 9.84653 6.63461C10.135 7.21153 10.4235 7.6923 10.9042 8.17307C11.385 8.65384 11.9619 8.9423 12.5388 9.23076C13.1158 9.51922 13.7888 9.61537 14.4619 9.61537C15.135 9.61537 15.8081 9.51922 16.385 9.23076C16.9619 8.9423 17.5388 8.65384 17.9234 8.17307C18.3081 7.6923 18.6927 7.21153 18.885 6.53845C19.1734 5.86538 19.1734 5.19229 19.1734 4.42307Z"></path><path d="M4.07715 0.192322H1.57715V9.23077H8.30791V7.11539H4.07715V0.192322Z"></path><path d="M3.40384 13.0769H1V10.9615H8.30768V13.0769H5.90384V20H3.40384V13.0769Z"></path><path d="M12.25 14.9039L14.1731 17.7885H14.8461L16.8654 14.9039V20H19.3654V10.9615H17.1538L14.5577 14.5192L11.9615 10.9615H9.75V20H12.25V14.9039Z"></path></svg></span>LGTMしたユーザー一覧</a><a href="https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca.md" rel="nofollow" class="css-1g6mqq7"><span class="fa fa-fw fa-file-text-o css-amwp7n" aria-hidden="true"></span>Markdown で本文を見る</a><div class="css-1ode1bp"></div><button class="css-1nt9rv7"><span class="fa fa-fw fa-flag css-amwp7n" aria-hidden="true"></span>問題がある記事を報告する</button></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">どのような問題がありますか？</span></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="CommunityGuidelineViolation">コミュニティガイドライン違反</label></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="IllegalViolation">法律違反</label></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="SociallyInappropriate">社会的に不適切</label></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="SuspectedSpam">スパムの疑い</label></div><div class="st-Form st-Form-right"><button type="submit" class="css-qgrf2v e1rb7ucl0" disabled="" font-size="14">送信</button></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-e6ddce6b-4526-4acb-9e00-38f7342202ee">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null,"headerBanner":null,"promptLoginMessageImageSrc":"//cdn.qiita.com/assets/public/qiitan-for-login-modal-014e085d3e40a240e3fe8d61b70b29a9.png"}</script>
      
<script src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/td_qt_access.js" type="text/javascript"></script><script>microadTd.QT.start({"article_category": "Python3,パターン認識"})</script><script>(function(d,u){var b=d.getElementsByTagName("script")[0],j=d.createElement("script");j.async=true;j.src=u;b.parentNode.insertBefore(j,b);})(document,"//img.ak.impact-ad.jp/ut/ff9a3577423c8ed5_4330.js");</script><noscript><iframe frameborder="0" height="0" src="//nspt.unitag.jp/ff9a3577423c8ed5_4330.php" width="0"></iframe></noscript><script async="" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/js(2)"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'AW-878053044');</script><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1792588824374455');
fbq('track', 'PageView');</script><noscript><img height="1" src="https://www.facebook.com/tr?id=1792588824374455&amp;ev=PageView&amp;noscript=1" style="display:none" width="1" /></noscript><footer id="globalfooter" class="st-footer"><div class="st-footer_container"><div class="st-footer_start"><div class="st-footer_signature"><a class="st-footer_logo" aria-label="トップに戻る" href="https://qiita.com/"><svg alt="" role="presentation" viewBox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-footer_catchcopy">How developers code is here.</div></div><small class="st-footer_copyright">© 2011-2022<span class="ml-1of2" translate="no">Qiita Inc.</span></small></div><nav class="st-footer_navigation"><dl class="st-footer_menu"><dt class="st-footer_menuTitle">ガイドとヘルプ</dt><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/about">About</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/terms">利用規約</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/privacy">プライバシーポリシー</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="http://help.qiita.com/ja/articles/qiita-community-guideline">ガイドライン</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://help.qiita.com/ja/articles/others-brand-guideline">デザインガイドライン</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://github.com/increments/qiita-discussions/discussions/116">ご意見</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://help.qiita.com/">ヘルプ</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">広告掲載</a></dd></dl><dl class="st-footer_menu"><dt class="st-footer_menuTitle">コンテンツ</dt><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/release-notes">リリースノート</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/official-events">公式イベント</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/official-columns">公式コラム</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/opportunities">募集</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/advent-calendar/2021">アドベントカレンダー</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/qiita-award">Qiita 表彰プログラム</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/api/v2/docs">API</a></dd></dl><dl class="st-footer_menu"><dt class="st-footer_menuTitle">SNS</dt><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://twitter.com/qiita"><span aria-label="Twitter" class="fa fa-fw fa-twitter"></span><span class="ml-1of2">Qiita（キータ）公式</span></a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://twitter.com/qiita_milestone"><span aria-label="Twitter" class="fa fa-fw fa-twitter"></span><span class="ml-1of2">Qiita マイルストーン</span></a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://twitter.com/qiitapoi"><span aria-label="Twitter" class="fa fa-fw fa-twitter"></span><span class="ml-1of2">Qiita 人気の投稿</span></a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://www.facebook.com/qiita/"><span aria-label="Facebook" class="fa fa-fw fa-facebook-square"></span><span class="ml-1of2">Qiita（キータ）公式</span></a></dd></dl><dl class="st-footer_menu"><dt class="st-footer_menuTitle">Qiita 関連サービス</dt><dd class="st-footer_menuItem"><a target="_blank" rel="noopener" class="st-footer_menuLink" href="https://teams.qiita.com/">Qiita Team</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener" class="st-footer_menuLink" href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener" class="st-footer_menuLink" href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://suzuri.jp/qiita">Qiita 公式ショップ</a></dd></dl><dl class="st-footer_menu"><dt class="st-footer_menuTitle">運営</dt><dd class="st-footer_menuItem"><a target="_blank" rel="noopener" class="st-footer_menuLink" href="https://corp.qiita.com/company/">運営会社</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener" class="st-footer_menuLink" href="https://corp.qiita.com/jobs/">採用情報</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener" class="st-footer_menuLink" href="https://blog.qiita.com/">Qiita Blog</a></dd></dl></nav></div></footer><div id="Snackbar-react-component-e84b5ee6-0ffc-4ec8-95a9-ff3a58e3ef80"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-e84b5ee6-0ffc-4ec8-95a9-ff3a58e3ef80">{}</script>
      
<div id="LoginModal-react-component-2547e904-0ad1-4a88-a5a1-5b93e9280348"><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><div class="css-gg4vpm"><div class="css-1tbyqbm">ユーザー登録して、Qiitaをもっと便利に使ってみませんか</div><button aria-label="閉じる" class="fa fa-fw fa-times css-yh67nw"></button></div><p class="css-1mi8o62">この機能を利用するにはログインする必要があります。ログインするとさらに下記の機能が使えます。</p><div class="css-ryur0b"><div><ol class="css-26shl7"><li>ユーザーやタグのフォロー機能であなたにマッチした記事をお届け</li><li class="css-1yuhvjn">ストック機能で便利な情報を後から効率的に読み返せる</li></ol><a href="https://qiita.com/signup?callback_action=login_or_signup&amp;redirect_to=%2Fakiraichi5430%2Fitems%2F60ce2829a1b72dce5bca&amp;realm=qiita" rel="nofollow" class="css-eln2kn">ユーザー登録</a><a href="https://qiita.com/login?callback_action=login_or_signup&amp;redirect_to=%2Fakiraichi5430%2Fitems%2F60ce2829a1b72dce5bca&amp;realm=qiita" rel="nofollow" class="css-1197zgb">ログイン</a></div><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/qiitan-for-login-modal-014e085d3e40a240e3fe8d61b70b29a9.png" alt="" class="css-1x1nsjm"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-2547e904-0ad1-4a88-a5a1-5b93e9280348">{"imageUrl":"//cdn.qiita.com/assets/public/qiitan-for-login-modal-014e085d3e40a240e3fe8d61b70b29a9.png"}</script>
      
<div id="StockModal-react-component-2d002c25-7c2f-47aa-bff8-f50f58c19999"><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body css-tlvft"><div class="css-e5tuit"><div class="css-1gykiw6">ストックするカテゴリー</div><button type="button" class="css-g11wic"><span class="fa fa-times fa-fw css-1wvl6ln"></span></button></div><div class="css-1elw6c9"></div><div class="css-19midj6"><button type="button" class="css-1mteic8"><span class="fa fa-plus fa-fw css-45hdgn"></span><div class="css-6ozust">カテゴリーの新規作成</div></button></div><div class="css-1mkdie5"><button class="css-b1sfia e1rb7ucl0" disabled="" font-size="14">保存する</button></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-2d002c25-7c2f-47aa-bff8-f50f58c19999">{}</script>
      
</div><script type="text/javascript" charset="UTF-8">!function(t,e){if(void 0===e[t]){e[t]=function(){e[t].clients.push(this),this._init=[Array.prototype.slice.call(arguments)]},e[t].clients=[];for(var r=function(t){return function(){return this["_"+t]=this["_"+t]||[],this["_"+t].push(Array.prototype.slice.call(arguments)),this}},s=["blockEvents","unblockEvents","setSignedMode","setAnonymousMode","resetUUID","addRecord","fetchGlobalID","set","trackEvent","trackPageview","trackClicks","ready"],n=0;n<s.length;n++){var c=s[n];e[t].prototype[c]=r(c)}var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=("https:"===document.location.protocol?"https:":"http:")+"//cdn.treasuredata.com/sdk/2.1/td.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)}}("Treasure",this);</script><script type="text/javascript" charset="UTF-8" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/aid"></script><img width="0px" height="0px" src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/tr" style="display: none;"><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;Zgs/quQLR8907koTktw0bG9S2kxzY1m6c61IGvq423GUpgHRsxjZurnwx20LAYJhVM4s09IUWwChjYJNQ/OOgw==&quot;,&quot;locale&quot;:&quot;ja&quot;},&quot;currentUser&quot;:null}"><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\u003cp\u003e「続・わかりやすい パターン認識 教師なし学習入門」ではアルゴリズムのサンプルコードが公開されていません。そこで、自分で書いてみました。\u003cbr\u003e\nなお、具体的に実験をした結果は\u003ca href=\"https://github.com/Akiraichi/Code_for_Algorithms\" rel=\"nofollow noopener\" target=\"_blank\"\u003eGithub\u003c/a\u003eで公開しています。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"目次\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%9B%AE%E6%AC%A1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e目次\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#5%E7%AB%A0%E6%95%99%E5%B8%AB%E4%BB%98%E3%81%8D%E5%AD%A6%E7%BF%92%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92\"\u003e5章 教師付き学習、教師なし学習\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90\"\u003eデータ作成\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E6%95%99%E5%B8%AB%E4%BB%98%E3%81%8D%E5%AD%A6%E7%BF%92\"\u003e教師付き学習\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92\"\u003e教師なし学習\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#7%E7%AB%A0%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB\"\u003e7章 マルコフモデル\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-1\"\u003eデータ作成\u003c/a\u003e \u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A\"\u003eマルコフモデルのパラメータ推定\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#8%E7%AB%A0%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB\"\u003e8章 隠れマルコフモデル\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-2\"\u003eデータ作成\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A\"\u003e隠れマルコフモデルのパラメータ推定\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#9%E7%AB%A0%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83\"\u003e9章 混合正規分布\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-3\"\u003eデータ作成\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A\"\u003e混合正規分布のパラメータ推定\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#10%E7%AB%A0%E5%87%B8%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0\"\u003e10章 凸クラスタリング\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-4\"\u003eデータ作成\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E5%87%B8%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0%E6%B3%95\"\u003e凸クラスタリング法\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E6%9C%80%E5%BE%8C%E3%81%AB\"\u003e最後に\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"5章教師付き学習教師なし学習\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#5%E7%AB%A0%E6%95%99%E5%B8%AB%E4%BB%98%E3%81%8D%E5%AD%A6%E7%BF%92%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e5章　教師付き学習、教師なし学習\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"データ作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデータ作成\u003c/h3\u003e\n\n\u003cp\u003e教師付き学習、教師なし学習を適用するためのデータを作るクラスです\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"python\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003edice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etheta\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etheta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etheta\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003egenerate_data\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[],\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__spots\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__spots\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etheta\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]]))\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\n\n    \u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"nb\"\u003estaticmethod\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__spots\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e)):\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"教師付き学習\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%95%99%E5%B8%AB%E4%BB%98%E3%81%8D%E5%AD%A6%E7%BF%92\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e教師付き学習\u003c/h3\u003e\n\n\u003cp\u003e教師付き学習のクラスです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"python\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSupervised_learning\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etheta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eestimate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__count\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etheta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshape\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\n\n    \u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"nb\"\u003estaticmethod\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__count\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ezeros\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ex_\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es_\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003ezip\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003es_\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"n\"\u003ex_\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"教師なし学習\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e教師なし学習\u003c/h3\u003e\n\n\u003cp\u003e教師なし学習のクラスです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"python\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUnsupervised_learning\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etheta\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003em\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ec\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003em\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Step1 If no initial value is specified, it will be determined at random\n\u003c/span\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"ow\"\u003eis\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003etheta\u003c/span\u003e \u003cspan class=\"ow\"\u003eis\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003erand\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003em\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etheta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erand\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# normalisation\n\u003c/span\u003e        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etheta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etheta\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003er\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eestimate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003er\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ecollections\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eCounter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e()])\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Step2\n\u003c/span\u003e        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__update_p\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# termination condition\n\u003c/span\u003e        \u003cspan class=\"n\"\u003eepsilon\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e1e-6\u003c/span\u003e\n        \u003cspan class=\"n\"\u003elog_p\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003esys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efloat_info\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"ow\"\u003eis\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e \u003cspan class=\"ow\"\u003eor\u003c/span\u003e \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"n\"\u003eepsilon\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e# Step3\n\u003c/span\u003e            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__update_param\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e# Step4\n\u003c/span\u003e            \u003cspan class=\"n\"\u003elog_p_new\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__log_likelihood\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n            \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003elog_p_new\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003elog_p\u003c/span\u003e\n            \u003cspan class=\"n\"\u003elog_p\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003elog_p_new\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__update_p\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enumer\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etheta\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumer\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003enumer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__update_param\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003er\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__update_p\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enumer\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003er\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# self.theta = (numer.T / numer.sum(axis=1)).T  # if theta is known, comment out on this line.\n\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__log_likelihood\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003elog_p\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etheta\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003er\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003elog_p\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"7章マルコフモデル\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#7%E7%AB%A0%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e7章　マルコフモデル\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"データ作成-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデータ作成\u003c/h3\u003e\n\n\u003cp\u003eマルコフモデルに従ったデータを作るクラスです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"python\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMarkov_dice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eA\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eB\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003erho\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eA\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eB\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eB\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erho\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erho\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003egenerate_spots\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[],\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n        \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__spots\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erho\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__spots\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eB\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n            \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__spots\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]),\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__spots\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etheta\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es_t\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etheta\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshape\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]):\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003etheta\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003es_t\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"マルコフモデルのパラメータ推定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eマルコフモデルのパラメータ推定\u003c/h3\u003e\n\n\u003cp\u003eマルコフモデルのパラメータを推定するクラスです\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"python\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMarkov\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eB\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eestimate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__initialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__count\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eB\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__initialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ezeros\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eB\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ezeros\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n    \u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"nb\"\u003estaticmethod\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__count\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ezeros\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ex_\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es_\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003ezip\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003es_\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"n\"\u003ex_\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003em\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ezeros\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"n\"\u003em\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]][\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]]\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003em\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"8章隠れマルコフモデル\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#8%E7%AB%A0%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e8章　隠れマルコフモデル\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"データ作成-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデータ作成\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-1\"\u003e7章 マルコフモデルと同様の方法\u003c/a\u003eでデータを作成します\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"隠れマルコフモデルのパラメータ推定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e隠れマルコフモデルのパラメータ推定\u003c/h3\u003e\n\n\u003cp\u003e隠れマルコフモデルのパラメータ推定は\u003ca href=\"https://qiita.com/ta-ka/items/3e5306d0432c05909992\" id=\"reference-8f8bb020c5585c205ebc\"\u003epythonでHMMのパラメータ推定実装\u003c/a\u003eで詳しく説明されています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"9章--混合正規分布\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#9%E7%AB%A0--%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e9章  混合正規分布\u003c/h2\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"データ作成-3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデータ作成\u003c/h2\u003e\n\n\u003cp\u003e混合正規分布に従ったデータを作成するクラスです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"python\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003emixed_normal_dice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"s\"\u003e\"\"\"mixed normal distribution model\"\"\"\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eK\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# If no initial value is specified, it will be determined at random\n\u003c/span\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e \u003cspan class=\"ow\"\u003eis\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003emu\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n                \u003cspan class=\"n\"\u003emu\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e[(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mf\"\u003e10.0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# range: -5.0 - 5.0\n\u003c/span\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e \u003cspan class=\"ow\"\u003eis\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esigma\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n                \u003cspan class=\"n\"\u003esigma\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mf\"\u003e3.0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# range: 0.0 - 3.0:\n\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003escale\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003egenerate_data\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eX\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emu_star\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003endim\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e# In the case of multidimensional normal distribution\n\u003c/span\u003e                \u003cspan class=\"n\"\u003eX\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emultivariate_normal\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003escale\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003eN\u003c/span\u003e \u003cspan class=\"o\"\u003e//\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003endim\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003emu_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e# In the case of one-dimensional normal distribution\n\u003c/span\u003e                \u003cspan class=\"n\"\u003eX\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enormal\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003escale\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003eN\u003c/span\u003e \u003cspan class=\"o\"\u003e//\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e\n            \u003cspan class=\"n\"\u003emu_star\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003escale\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"混合正規分布のパラメータ推定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e混合正規分布のパラメータ推定\u003c/h3\u003e\n\n\u003cp\u003e混合正規分布に従ったデータをパラメータ推定するクラスです。（グラフを描画する関数も含めています）\u003cbr\u003e\n\u003ca href=\"https://qiita.com/ta-ka/items/3e8b127620ac92a32864#python%E3%81%A7%E3%81%AE%E5%AE%9F%E8%A3%85\" id=\"reference-08e16dc0b791c3056e08\"\u003epythonで混合正規分布実装\u003c/a\u003eを参考にしました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"python\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003emixed_normal_distribution\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"s\"\u003e\"\"\"Parameter Estimation for Mixed Normal Distribution\"\"\"\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eK\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# If no initial value is specified, it will be determined at random\n\u003c/span\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"ow\"\u003eis\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e \u003cspan class=\"ow\"\u003eis\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003emu\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandn\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e \u003cspan class=\"ow\"\u003eis\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esigma\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003eabs\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandn\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eestimate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# termination condition\n\u003c/span\u003e        \u003cspan class=\"n\"\u003eepsilon\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.000001\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Step1 initialize gmm parameter\n\u003c/span\u003e        \u003cspan class=\"n\"\u003eQ\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003esys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efloat_info\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# EM algorithm\n\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"ow\"\u003eis\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e \u003cspan class=\"ow\"\u003eor\u003c/span\u003e \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"n\"\u003eepsilon\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003egf\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__gaussian\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e# E step: example posterior probability of hidden variable gamma\n\u003c/span\u003e            \u003cspan class=\"n\"\u003egamma\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__estimate_posterior_likelihood\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egf\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e# M step: miximize Q function by estimating mu, sigma and pi\n\u003c/span\u003e            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__estimate_gmm_parameter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n            \u003cspan class=\"c1\"\u003e# calculate Q function\n\u003c/span\u003e            \u003cspan class=\"n\"\u003eQ_new\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__calc_Q\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eQ_new\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003eQ\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eQ\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eQ_new\u003c/span\u003e\n\n    \u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"nb\"\u003estaticmethod\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__estimate_posterior_likelihood\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egf\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003el\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ezeros\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003eenumerate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"n\"\u003el\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e:]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003el\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evectorize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003elambda\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003el\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n    \u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"nb\"\u003estaticmethod\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__gaussian\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eexp\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esqrt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__estimate_gmm_parameter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eN\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egamma\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003eN\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egamma\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003eN\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eN\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__calc_Q\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eQ\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egamma\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e\u003cspan class=\"p\"\u003e)))).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003eenumerate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eQ\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e:]\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eQ\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sa\"\u003eu\u003c/span\u003e\u003cspan class=\"s\"\u003e'mu*: %s, sigma*: %s'\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earound\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e))),\u003c/span\u003e \u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earound\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)))))\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sa\"\u003eu\u003c/span\u003e\u003cspan class=\"s\"\u003e'mu : %s, sigma : %s'\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earound\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e))),\u003c/span\u003e \u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earound\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)))))\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003egraph\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebins\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eplt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehist\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e50\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edensity\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ealpha\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eseq\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e15\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e15\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.02\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eplt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eplot\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eseq\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__gaussian\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e])(\u003c/span\u003e\u003cspan class=\"n\"\u003eseq\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003elinewidth\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mf\"\u003e2.0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eplt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esavefig\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e'gmm_graph.png'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eplt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshow\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"10章凸クラスタリング\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#10%E7%AB%A0%E5%87%B8%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e10章　凸クラスタリング\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"データ作成-4\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデータ作成\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-3\"\u003e9章 混合正規分布と同様の方法\u003c/a\u003eでデータを作成します\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"凸クラスタリング法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%87%B8%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e凸クラスタリング法\u003c/h3\u003e\n\n\u003cp\u003eデータを凸クラスタリングするクラスです。（グラフを描画する関数も含めています）\u003cbr\u003e\n\u003ca href=\"https://qiita.com/drumichiro/items/00d4e3f6ba4be7e23fad\" id=\"reference-0256c05069847c969dfe\"\u003e凸クラスタリング法の実装と実験\u003c/a\u003eとそのコードが載っている\u003ca href=\"https://github.com/drumichiro/convex-clustering\" rel=\"nofollow noopener\" target=\"_blank\"\u003eConvex Clustering\u003c/a\u003eを一部参考にしました。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"python\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003econvex_clustering\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# Step1 Set the variance to an appropriate value.\n\u003c/span\u003e        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eclustering\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# Step2 Calculating a prior f\n\u003c/span\u003e        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ef\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__calc_f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__gaussian\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Step3 Set the initial value of prior probability pi\n\u003c/span\u003e        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erepeat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# termination condition\n\u003c/span\u003e        \u003cspan class=\"n\"\u003eepsilon\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e1e-6\u003c/span\u003e\n        \u003cspan class=\"n\"\u003elog_p\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003esys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efloat_info\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# Step4 Update parameters\n\u003c/span\u003e        \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"ow\"\u003eis\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e \u003cspan class=\"ow\"\u003eor\u003c/span\u003e \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eepsilon\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__update_pi\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003elog_p_new\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__log_likelihood\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003elog_p_new\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003elog_p\u003c/span\u003e\n            \u003cspan class=\"n\"\u003elog_p\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003elog_p_new\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__calc_f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egauss_func\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\"\"Calculating f\n\n        Args:\n            x: pattern\n            sigma: variance\n            gauss_func: normal distribution function\n\n        Returns: f\n\n        \"\"\"\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ef\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003egauss_func\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__update_pi\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enumer\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edenom\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumer\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003edenom\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# To improve the convergence efficiency, set the pi near zero to zero\n\u003c/span\u003e        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi_i\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003eenumerate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003epi_i\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mf\"\u003e1e-7\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\n    \u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"nb\"\u003estaticmethod\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__log_likelihood\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__gaussian\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003endim\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e# In the case of multidimensional normal distribution\n\u003c/span\u003e            \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003escs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emultivariate_normal\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epdf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e# In the case of 1D normal distribution\n\u003c/span\u003e            \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003escs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enorm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epdf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)),\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e//\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003egraph\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# Half an initial pi is used as threshold.\n\u003c/span\u003e        \u003cspan class=\"n\"\u003ethreshold\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.01\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emu_valid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi_valid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__select_valid_centroid\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ethreshold\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eK\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu_valid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sa\"\u003ef\u003c/span\u003e\u003cspan class=\"s\"\u003e\"The number of used centroids is (\u003c/span\u003e\u003cspan class=\"si\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e/\u003c/span\u003e\u003cspan class=\"si\"\u003e{\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e) using sigma:(\u003c/span\u003e\u003cspan class=\"si\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e).\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003econst_sigma\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__plot_sample\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__plot_gauss\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu_valid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003econst_sigma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi_valid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eplt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshow\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__plot_sample\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003endim\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eplt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eplot\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"bo\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ebins\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eceil\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nb\"\u003emin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eplt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehist\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebins\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"b\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__plot_gauss\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003endim\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e# In the case of multidimensional normal distribution\n\u003c/span\u003e            \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.025\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Sampling rate of contour.\n\u003c/span\u003e            \u003cspan class=\"n\"\u003ex_min\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey_min\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efloor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003emin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ex_max\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey_max\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eceil\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eY\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emeshgrid\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex_min\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex_max\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edelta\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                               \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ey_min\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey_max\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edelta\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"n\"\u003egrid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eY\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e]).\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\n\n            \u003cspan class=\"n\"\u003ecircle_rate\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Adjust size of a drawn circle.\n\u003c/span\u003e            \u003cspan class=\"n\"\u003eZ\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e)):\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eZ\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__gaussian\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egrid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ecircle_rate\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eplt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econtour\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eY\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eZ\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003elinewidths\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecolors\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"g\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e# In the case of 1D normal distribution\n\u003c/span\u003e            \u003cspan class=\"n\"\u003egrid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elinspace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efloor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003emin\u003c/span\u003e\u003cspan class=\"p\"\u003e()),\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eceil\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e()),\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eweight\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esqrt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003edist\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ezeros\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e)):\u003c/span\u003e\n                \u003cspan class=\"n\"\u003edist\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__gaussian\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egrid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eweight\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eplt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eplot\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egrid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edist\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\"g\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003elinewidth\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mf\"\u003e2.0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"nb\"\u003estaticmethod\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__select_valid_centroid\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ethreshold\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"s\"\u003e\"\"\"\n        1 Get the index of the most probable pi\n        2 Add the highest prior probability x value (centroid) to mu\n        3 Add the highest prior probability pi value to the ratio\n        4 If it is below the threshold, break\n\n        Args:\n            x: Data (centroid)\n            pi: prior probability\n            threshold: The threshold for judging prior probability pi as valid\n\n        Returns: Prior probability pi determined to be valid and its centroid\n\n        \"\"\"\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emu_valid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e([])\u003c/span\u003e\n        \u003cspan class=\"n\"\u003epi_valid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e([])\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eindexs\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eargsort\u003c/span\u003e\u003cspan class=\"p\"\u003e()[::\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003erow\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003eenumerate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eindexs\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ethreshold\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003erow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003emu_valid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu_valid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erow\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu_valid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e \u003cspan class=\"o\"\u003e//\u003c/span\u003e \u003cspan class=\"n\"\u003erow\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"n\"\u003emu_valid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu_valid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n                \u003cspan class=\"n\"\u003epi_valid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epi_valid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003emu_valid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi_valid\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"最後に\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9C%80%E5%BE%8C%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e最後に\u003c/h2\u003e\n\n\u003cp\u003e11章〜13章は勉強中です。\u003cbr\u003e\n間違い等あれば、コメントにてご指摘お願いします。\u003c/p\u003e\n","createdAt":"2020-08-11T05:19:52Z","elapsedYearsFromLastModifiedAt":2,"encryptedId":"HA1GXj5JW6K1Ttap1aLNoOicgv0DwQcncA==--rTGKQZMgASCGva1b--beHZP7Aj8S+0ag1Ilpbpxw==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2020-08-11T10:45:15Z","likesCount":2,"linkUrl":"https://qiita.com/akiraichi5430/items/60ce2829a1b72dce5bca","organization":null,"stockedCount":3,"title":"続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%9B%AE%E6%AC%A1\"\u003e目次\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#5%E7%AB%A0%E6%95%99%E5%B8%AB%E4%BB%98%E3%81%8D%E5%AD%A6%E7%BF%92%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92\"\u003e5章　教師付き学習、教師なし学習\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90\"\u003eデータ作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%95%99%E5%B8%AB%E4%BB%98%E3%81%8D%E5%AD%A6%E7%BF%92\"\u003e教師付き学習\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%95%99%E5%B8%AB%E3%81%AA%E3%81%97%E5%AD%A6%E7%BF%92\"\u003e教師なし学習\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#7%E7%AB%A0%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB\"\u003e7章　マルコフモデル\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-1\"\u003eデータ作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A\"\u003eマルコフモデルのパラメータ推定\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#8%E7%AB%A0%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB\"\u003e8章　隠れマルコフモデル\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-2\"\u003eデータ作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%9A%A0%E3%82%8C%E3%83%9E%E3%83%AB%E3%82%B3%E3%83%95%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A\"\u003e隠れマルコフモデルのパラメータ推定\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#9%E7%AB%A0--%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83\"\u003e9章  混合正規分布\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-3\"\u003eデータ作成\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A\"\u003e混合正規分布のパラメータ推定\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#10%E7%AB%A0%E5%87%B8%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0\"\u003e10章　凸クラスタリング\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90-4\"\u003eデータ作成\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%87%B8%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0%E6%B3%95\"\u003e凸クラスタリング法\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%9C%80%E5%BE%8C%E3%81%AB\"\u003e最後に\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":3213,"uuid":"60ce2829a1b72dce5bca","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"EVXp1Jy7AlspGxiwdGBHHcvXoYUT--oEJzyNnzmzKs6PiO--zlv1cosDCUbNImtzgEfQTg==","originalId":252164,"description":"高専生でした。今は専攻科生です。そして大学院生になりました。（時が経つのは早いな…）","facebookUrl":null,"githubUrl":null,"isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"","profileImageUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-image-store/0/252164/edfa4333ea66c515f9341ae8532143aaff509495/x_large.png?1597115905","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F252164%2Fedfa4333ea66c515f9341ae8532143aaff509495%2Fx_large.png%3F1597115905?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=65bd273b3949029c32be2203f8c3879a","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fs3-ap-northeast-1.amazonaws.com%2Fqiita-image-store%2F0%2F252164%2Fedfa4333ea66c515f9341ae8532143aaff509495%2Fx_large.png%3F1597115905?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=20be48fdd07aa0c0c2efa2642a10c1b9","urlName":"akiraichi5430","websiteUrl":"","twitterUrl":null,"twitterUrlName":null,"revealedOrganizations":{"edges":[]}},"tags":[{"name":"Python3","urlName":"python3"},{"name":"パターン認識","urlName":"%e3%83%91%e3%82%bf%e3%83%bc%e3%83%b3%e8%aa%8d%e8%ad%98"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"adsEventEmitter":null}}</script><iframe src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/container.html" style="visibility: hidden; display: none;"></iframe></div><div id="itm_4330" style="visibility: hidden; display: none;"></div><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/pixel" width="1" height="1" style="display: none;"><img src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/rep" style="display: none;"><iframe src="./続・わかりやすい　パターン認識　教師なし学習入門　アルゴリズムのサンプルコードを書いてみた - Qiita_files/aframe.html" width="0" height="0" style="display: none;"></iframe></body></html>