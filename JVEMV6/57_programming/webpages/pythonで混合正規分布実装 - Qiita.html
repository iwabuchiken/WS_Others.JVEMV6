<!DOCTYPE html>
<!-- saved from url=(0095)https://qiita.com/taka256/items/3e8b127620ac92a32864#python%E3%81%A7%E3%81%AE%E5%AE%9F%E8%A3%85 -->
<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>pythonで混合正規分布実装 - Qiita</title><meta content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover" name="viewport"><meta content="#55c500" name="theme-color"><meta content="XWpkTG32-_C4joZoJ_UsmDUi-zaH-hcrjF6ZC_FoFbk" name="google-site-verification"><meta content="telephone=no" name="format-detection"><link rel="canonical" href="https://qiita.com/taka256/items/3e8b127620ac92a32864"><link href="https://qiita.com/manifest.json" rel="manifest"><link href="https://qiita.com/opensearch.xml" rel="search" title="Qiita" type="application/opensearchdescription+xml"><link as="script" href="./pythonで混合正規分布実装 - Qiita_files/gpt.js" rel="preload"><link href="https://securepubads.g.doubleclick.net/" rel="preconnect"><script type="text/javascript" src="./pythonで混合正規分布実装 - Qiita_files/combo" async=""></script><script type="text/javascript" async="" src="./pythonで混合正規分布実装 - Qiita_files/analytics.js"></script><script async="">window.a1tracker&&a1tracker.ready(function(tracker){var doh="ff9a3577423c8ed5";if(!doh)return;var params={"event":"","url":"","referrer":"","metakeywords":"","callback":""};if(params.url)tracker.setParams(doh,"url",params.url);if(params.referrer)tracker.setParams(doh,"referrer",params.referrer);if(params.metakeywords){var mk=tracker.getParams(doh,"metakeywords");Array.prototype.push.apply(mk,params.metakeywords.split(","));tracker.setParams(doh,"metakeywords",mk)}tracker.setParams(doh,"tagsource","itm_a1common");var callback=params.callback&&typeof window[params.callback]==="function"?function(err,data){if(!err&&data.segments.length>0)window[params.callback](data.segments);return}:function(){};if(params.event)tracker.send(doh,params.event.split(","),callback);else tracker.send(doh,callback)});</script><script async="" src="./pythonで混合正規分布実装 - Qiita_files/tracking.min.js"></script><script type="text/javascript" async="" src="./pythonで混合正規分布実装 - Qiita_files/js"></script><script type="text/javascript" async="" src="./pythonで混合正規分布実装 - Qiita_files/f.txt"></script><script async="" src="./pythonで混合正規分布実装 - Qiita_files/ff9a3577423c8ed5_4330.js"></script><script type="text/javascript" async="" src="./pythonで混合正規分布実装 - Qiita_files/td.min.js"></script><script src="./pythonで混合正規分布実装 - Qiita_files/1792588824374455" async=""></script><script src="./pythonで混合正規分布実装 - Qiita_files/305156090176370" async=""></script><script async="" src="./pythonで混合正規分布実装 - Qiita_files/fbevents.js"></script><script async="" src="./pythonで混合正規分布実装 - Qiita_files/gpt.js"></script><meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="S8AgWedTifCF/Ymk6rmW2NRZcvtfrgNtICeI7wJbC9O5bR4isEAXhUjjBNpzZCDV78WEZP7ZAdfyB0K4uxBeIQ=="><link rel="shortcut icon" type="image/x-icon" href="https://cdn.qiita.com/assets/favicons/public/production-c620d3e403342b1022967ba5e3db1aaa.ico"><link rel="apple-touch-icon" type="image/png" href="https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png"><link rel="stylesheet" media="all" href="./pythonで混合正規分布実装 - Qiita_files/article-f83500ef89752973ac6ebd32f26c1985.min.css"><script src="./pythonで混合正規分布実装 - Qiita_files/v3-article-bundle-22eca92616d7bdfaabf58388544806f1.min.js" defer="defer"></script><meta name="twitter:card" content="summary_large_image"><meta content="@Qiita" name="twitter:site"><meta content="@shota_takayama" name="twitter:creator"><meta property="og:type" content="article"><meta property="og:title" content="pythonで混合正規分布実装 - Qiita"><meta property="og:image" content="https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-9f5428127621718a910c8b63951390ad.png?ixlib=rb-4.0.0&amp;w=1200&amp;mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTkxNiZ0eHQ9cHl0aG9uJUUzJTgxJUE3JUU2JUI3JUI3JUU1JTkwJTg4JUU2JUFEJUEzJUU4JUE2JThGJUU1JTg4JTg2JUU1JUI4JTgzJUU1JUFFJTlGJUU4JUEzJTg1JnR4dC1jb2xvcj0lMjMyMTIxMjEmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTYmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWxlZnQlMkN0b3Amcz04OTBmZGVkZGFlZWIxMzYxYzYxYWM4OWY4ZjUyYWYzNg&amp;mark-x=142&amp;mark-y=112&amp;blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTYxNiZ0eHQ9JTQwdGFrYTI1NiZ0eHQtY29sb3I9JTIzMjEyMTIxJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTM2JnR4dC1hbGlnbj1sZWZ0JTJDdG9wJnM9OGMwZDg5YTNlYTZkNzA3Y2MxMTUzOGQ4MGQ4ZGZiYjU&amp;blend-x=142&amp;blend-y=491&amp;blend-mode=normal&amp;s=74683fb9aa322098ef1e4fe1dcfd9a51"><meta property="og:description" content="

はじめに

pythonで混合正規分布を実装しました．
教科書として『はじめてのパターン認識』を使いました．

本記事の構成


はじめに
混合正規分布


混合正規分布モデル
隠れ変数と事後確率
対数尤度とQ関数


EMアルゴ..."><meta content="https://qiita.com/taka256/items/3e8b127620ac92a32864" property="og:url"><meta content="Qiita" property="og:site_name"><meta content="564524038" property="fb:admins"><meta content="Python,機械学習" name="keywords"><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '305156090176370');
fbq('trackSingle', '305156090176370', 'PageView');</script><meta http-equiv="origin-trial" content="A+cA2PUOfIOKAdSDJOW5CP9ZlxONy1yu+hqAq72zUtKw4rLdihqRp6Nui/jUyCyegr+BUtH+C+Elv0ufn05yBQEAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A+zsdH3aNZT/bkjT8U/o5ACzyaeNYzTvtoVmwf/KOilfv39pxY2AIsOwhQJv+YnXp98i3TqrQibIVtMWs5UHjgoAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="AxceVEhIegcDEHqLXFQ2+vPKqzCppoJYsRCZ/BdfVnbM/sUUF2BXV8lwNosyYjvoxnTh2FC8cOlAnA5uULr/zAUAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><script src="./pythonで混合正規分布実装 - Qiita_files/pubads_impl_2022081701.js" async=""></script><noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=305156090176370&ev=PageView&noscript=1"/></noscript><style data-emotion-css="92283 vnk55c 1ibnx62 1x8nfy4 1duml6f nje458 1otwww0 tubf1g nb6j9u kfddif 19m4w61 cgslon 79elbk 1ydfkyi l40u17 1gj7nt 1g6mqq7 amwp7n 1ode1bp x9qlq8 2ycz42 1nt9rv7 qgrf2v 1hbd3g7 u681u4 hxgmls r67lmd 8qb8m4 2imjyh 17zza1i 70qvj9 6su6fj 1ndxrmk 1r4slzx 772dpg bjms2a 17ay39c 1ay9vb9 hpp7el 1lbjcyg 188vyrl 1wa99t2 1l3zk9f 1a610x3 189rs1q 1yzj1fm l1ga49 1un4bh8 1zr5f9 dwar2a 1n56tva 1ty75sn 16dbybf st6exv gjiyxx 5jpx49 10h2231 3ebp5j 1o09fmu 7i7f4d" }="">.css-92283{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.css-vnk55c{display:grid;display:-ms-grid;grid-template-columns:80px minmax(0,1fr) 300px;-ms-grid-columns:80px minmax(0,1fr) 300px;grid-template-rows:minmax(270px,auto) 1fr;-ms-grid-rows:minmax(270px,auto) 1fr;max-width:1280px;margin-right:auto;margin-left:auto;padding-top:24px;padding-right:24px;padding-left:24px;}@media (max-width:1199px){.css-vnk55c{padding-bottom:0;padding-left:0;padding-right:0;}}@media (max-width:991px){.css-vnk55c{-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}@media (max-width:769px){.css-vnk55c{display:block;}}@media (max-width:479px){.css-vnk55c{padding-top:0;}}.css-1ibnx62{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:5;position:-webkit-sticky;position:sticky;top:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px;width:80px;}@media (max-width:769px){.css-1ibnx62{display:none;}}.css-1x8nfy4{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-bottom:16px;}.css-1duml6f{height:40px;width:40px;position:relative;}.css-1duml6f svg{cursor:auto;pointer-events:none;}.css-nje458{background-color:transparent;border:none;cursor:pointer;height:40px;padding:0;position:absolute;width:40px;}.css-1otwww0{color:#55c500;cursor:pointer;font-size:14px;font-weight:bold;}.css-tubf1g{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-bottom:16px;}.css-nb6j9u{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#ffffff;border:2px solid #5f6161;border-radius:50%;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:2px 0px 0px;width:40px;}.css-kfddif{display:inline-block;vertical-align:bottom;height:17.77777777777778px;width:16px;fill:#5f6161;}.css-19m4w61{color:#5f6161;font-size:14px;font-weight:bold;}.css-cgslon{border:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;border-radius:50%;color:rgba(0,0,0,0.6);cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-bottom:16px;padding:0;width:32px;}.css-79elbk{position:relative;}.css-1ydfkyi{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;border-radius:50%;color:rgba(0,0,0,0.6);cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:0;width:32px;}.css-l40u17{display:none;bottom:initial;left:initial;right:initial;top:initial;left:100%;top:-187px;}.css-1gj7nt{color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:1.8;padding:8px 16px;}.css-1g6mqq7{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.87);cursor:pointer;font-size:16px;font-weight:normal;line-height:1.8;padding:4px 16px;}.css-1g6mqq7:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#edeeee;}.css-amwp7n{color:rgba(0,0,0,0.6);font-size:14px;margin-right:4px;}.css-1ode1bp{background-color:rgba(0,0,0,0.12);height:1px;width:100%;margin:8px 0;}.css-x9qlq8{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:4px;width:18px;}.css-2ycz42{display:inline-block;vertical-align:middle;height:14px;width:14px;fill:rgba(0,0,0,0.6);}.css-1nt9rv7{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#ffffff;color:rgba(0,0,0,0.87);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:16px;line-height:1.8;padding:4px 16px;width:100%;}.css-1nt9rv7:hover{background-color:#edeeee;}.css-qgrf2v{box-sizing:border-box;cursor:pointer;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:600;line-height:1.8;margin-bottom:0;min-height:34px;min-width:64px;padding:8px 12px;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;white-space:nowrap;-webkit-transition:.1s ease-out;transition:.1s ease-out;-webkit-transition-property:background-color,border-color;transition-property:background-color,border-color;background-color:#55c500;border:2px solid #55c500;color:#ffffff;}.css-qgrf2v:disabled{box-shadow:none;cursor:not-allowed;opacity:0.38;}.css-qgrf2v:active{background-color:#46a900;border-color:#46a900;}@media (hover:hover) and (pointer:fine){.css-qgrf2v:hover{background-color:#46a900;border-color:#46a900;}}.css-1hbd3g7{height:250px;}.css-u681u4{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 32px;background-color:#fcf0bf;color:rgba(0,0,0,0.87);line-height:1.5;font-weight:600;}@media (max-width:769px){.css-u681u4{padding:16px;}}.css-hxgmls{color:#d58d2c;margin-right:4px;}.css-r67lmd{background-color:#ffffff;padding:32px;margin-bottom:24px;}@media (max-width:991px){.css-r67lmd{margin:0 auto 40px;}}@media (max-width:479px){.css-r67lmd{margin:0 0 40px;padding:32px 16px;}}.css-8qb8m4{margin-bottom:48px;}.css-2imjyh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-17zza1i{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:14px;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;line-height:1.8;width:100%;}@media (max-width:769px){.css-17zza1i{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-6su6fj{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}.css-1ndxrmk{display:inline-block;border-radius:50%;height:24px;line-height:1;object-fit:contain;overflow:hidden;vertical-align:middle;width:24px;}.css-1r4slzx{line-height:1.5;margin-left:4px;}.css-772dpg{color:rgba(0,0,0,0.87);font-weight:600;word-break:break-all;}.css-bjms2a{color:rgba(0,0,0,0.87);font-weight:600;margin-left:4px;word-break:break-all;}.css-17ay39c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;color:rgba(0,0,0,0.6);}.css-1ay9vb9{margin-right:16px;}@media (max-width:769px){.css-hpp7el{margin-top:4px;}}.css-1lbjcyg{box-shadow:0 0 0 1px rgba(0,0,0,0.12) inset;color:rgba(0,0,0,0.6);font-size:14px;font-weight:bold;line-height:180%;padding:0px 4px;}.css-188vyrl{color:rgba(0,0,0,0.87);font-size:32px;font-weight:bold;line-height:1.4;margin-top:8px;word-break:break-all;}.css-1wa99t2{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,0.6);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:8px;}.css-1l3zk9f{color:rgba(0,0,0,0.6);font-size:20px;margin-right:8px;}.css-1a610x3{color:inherit;font-size:14px;line-height:1.8;z-index:1;}.css-189rs1q{margin-left:2px;margin-right:4px;}.css-1yzj1fm{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:32px;}.css-l1ga49{border:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:none;color:rgba(0,0,0,0.6);cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:20px;height:32px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-right:16px;outline:none;padding:0;width:32px;}.css-1un4bh8{max-width:840px;width:90%;margin:40px auto;padding:16px;border:1px solid #55c500;background-position:95% 85%;background-image:url(//cdn.qiita.com/assets/public/qiitan-for-login-modal-014e085d3e40a240e3fe8d61b70b29a9.png);background-size:150px;background-repeat:no-repeat;}@media (max-width:769px){.css-1un4bh8{width:100%;background-image:none;padding-left:8px;padding-right:8px;}}.css-1zr5f9{font-size:24px;font-weight:600;text-align:center;margin-top:16px;margin-bottom:16px;}@media (max-width:769px){.css-1zr5f9{text-align:left;margin-top:24px;}}.css-dwar2a{text-align:left;font-weight:600;font-size:20px;margin-top:32px;margin-bottom:24px;margin-left:32px;}@media (max-width:769px){.css-dwar2a{display:none;}}.css-1n56tva{font-size:16px;color:rgba(0,0,0,0.6);margin-top:8px;margin-bottom:24px;max-width:420px;word-break:break-all;}.css-1ty75sn{color:#55c500;font-size:16px;margin-top:16px;margin-bottom:16px;}.css-16dbybf{box-sizing:border-box;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:600;line-height:1.8;min-height:34px;min-width:64px;opacity:1;padding:8px 12px;pointer-events:auto;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;white-space:nowrap;-webkit-transition:.1s ease-out;transition:.1s ease-out;-webkit-transition-property:background-color,border-color;transition-property:background-color,border-color;background-color:#55c500;border:2px solid #55c500;color:#ffffff;margin:16px;}.css-16dbybf:hover{-webkit-text-decoration:none;text-decoration:none;}.css-16dbybf:active{background-color:#46a900;border-color:#46a900;}@media (hover:hover) and (pointer:fine){.css-16dbybf:hover{background-color:#46a900;border-color:#46a900;}}@media (max-width:769px){.css-16dbybf{display:block;width:auto;margin-left:0;margin-right:0;font-size:16px;}}.css-st6exv{box-sizing:border-box;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:600;line-height:1.8;min-height:34px;min-width:64px;opacity:1;padding:8px 12px;pointer-events:auto;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;white-space:nowrap;-webkit-transition:.1s ease-out;transition:.1s ease-out;-webkit-transition-property:background-color,border-color;transition-property:background-color,border-color;background-color:#ffffff;border:2px solid #bcbdbd;color:#5f6161;margin:16px;}.css-st6exv:hover{-webkit-text-decoration:none;text-decoration:none;}.css-st6exv:active{background-color:#f5f6f6;}@media (hover:hover) and (pointer:fine){.css-st6exv:hover{background-color:#f5f6f6;}}@media (max-width:769px){.css-st6exv{display:block;width:auto;margin-left:0;margin-right:0;font-size:16px;}}.css-gjiyxx{background-color:#ffffff;border-top:1px solid rgba(0,0,0,0.12);bottom:0;box-shadow:0px 1px 4px rgba(0,0,0,0.14);display:none;height:calc(env(safe-area-inset-bottom,0px) + 56px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding-bottom:env(safe-area-inset-bottom);position:-webkit-sticky;position:sticky;width:100%;z-index:2000;}@media (max-width:769px){.css-gjiyxx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-5jpx49{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;width:100%;}.css-10h2231{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.css-3ebp5j{color:#55c500;cursor:pointer;font-size:14px;font-weight:bold;margin-left:8px;}.css-1o09fmu{color:#5f6161;font-size:14px;font-weight:bold;margin-left:8px;}.css-7i7f4d{display:none;bottom:initial;left:initial;right:initial;top:initial;bottom:32px;right:0;}</style><script>window.frtn=window.frtn||function(){ (frtn.q=frtn.q||[]).push(arguments) };
frtn("init",{
service_id:"cova_248",
site_id:"site_134",
tag_id:"tag_283"
});
frtn("send","pageview");</script><script defer="" src="./pythonで混合正規分布実装 - Qiita_files/insight.js" type="text/javascript"></script><script>!function(t,e){if(void 0===e[t]){e[t]=function(){e[t].clients.push(this),this._init=[Array.prototype.slice.call(arguments)]},e[t].clients=[];for(var r=function(t){return function(){return this["_"+t]=this["_"+t]||[],this["_"+t].push(Array.prototype.slice.call(arguments)),this}},s=["addRecord","blockEvents","fetchServerCookie","fetchGlobalID","fetchUserSegments","resetUUID","ready","setSignedMode","setAnonymousMode","set","trackEvent","trackPageview","trackClicks","unblockEvents"],n=0;n<s.length;n++){var c=s[n];e[t].prototype[c]=r(c)}var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=("https:"===document.location.protocol?"https:":"http:")+"//cdn.treasuredata.com/sdk/2.5/td.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)}}("Treasure",this);

// Configure an instance for your database
var td = new Treasure({
  host: 'in.treasuredata.com',
  writeKey: '10614/e3887673c1849754466b09ad01b4fbbc22b88f30',
  database: 'qiita_public',
  startInSignedMode: true
});

var success = function() {
  syncGoogleDDPv2();
};

var failure = function() {
  syncGoogleDDPv2();
}

var syncGoogleDDPv2 = function() {
  var ddp_destination = 'cm.g.doubleclick.net/pixel'
      + '?google_nid=treasuredata_dmp'
      + '&google_hm=' + btoa(self.td.client.track.uuid).replace(/\//g, '_').replace(/\+/g, '-').replace(/=/g, '');

  var n = document.createElement("img");
  n.src = ("https:" == document.location.protocol ? "https://" : "http://") + ddp_destination;
  n.width = 1;
  n.height = 1;
  n.style.display = "none";
  document.body.appendChild(n);
}

// Enable cross-domain tracking
td.set('$global', 'td_global_id', 'td_global_id');
// Track pageview information to 'pageviews' table
td.set('pageviews_all', {"query_parameters":{},"path_parameters":{"controller":"public/items","action":"show","user_id":"taka256","type":"items","id":"3e8b127620ac92a32864"},"request_id":"cc1bf15e-9bb5-423e-b210-35f0f3965349","user_id":null})
td.trackPageview('pageviews_all', success, failure);</script><script src="./pythonで混合正規分布実装 - Qiita_files/js(1)"></script><style data-emotion="css"></style><style data-jss="" data-meta="MuiTooltip">
.MuiTooltip-popper {
  z-index: 1500;
  pointer-events: none;
}
.MuiTooltip-popperInteractive {
  pointer-events: auto;
}
.MuiTooltip-popperArrow[x-placement*="bottom"] .MuiTooltip-arrow {
  top: 0;
  left: 0;
  margin-top: -0.71em;
  margin-left: 4px;
  margin-right: 4px;
}
.MuiTooltip-popperArrow[x-placement*="top"] .MuiTooltip-arrow {
  left: 0;
  bottom: 0;
  margin-left: 4px;
  margin-right: 4px;
  margin-bottom: -0.71em;
}
.MuiTooltip-popperArrow[x-placement*="right"] .MuiTooltip-arrow {
  left: 0;
  width: 0.71em;
  height: 1em;
  margin-top: 4px;
  margin-left: -0.71em;
  margin-bottom: 4px;
}
.MuiTooltip-popperArrow[x-placement*="left"] .MuiTooltip-arrow {
  right: 0;
  width: 0.71em;
  height: 1em;
  margin-top: 4px;
  margin-right: -0.71em;
  margin-bottom: 4px;
}
.MuiTooltip-popperArrow[x-placement*="left"] .MuiTooltip-arrow::before {
  transform-origin: 0 0;
}
.MuiTooltip-popperArrow[x-placement*="right"] .MuiTooltip-arrow::before {
  transform-origin: 100% 100%;
}
.MuiTooltip-popperArrow[x-placement*="top"] .MuiTooltip-arrow::before {
  transform-origin: 100% 0;
}
.MuiTooltip-popperArrow[x-placement*="bottom"] .MuiTooltip-arrow::before {
  transform-origin: 0 100%;
}
.MuiTooltip-tooltip {
  color: #fff;
  padding: 4px 8px;
  font-size: 0.625rem;
  max-width: 300px;
  word-wrap: break-word;
  font-family: "Roboto", "Helvetica", "Arial", sans-serif;
  font-weight: 500;
  line-height: 1.4em;
  border-radius: 4px;
  background-color: rgba(97, 97, 97, 0.9);
}
.MuiTooltip-tooltipArrow {
  margin: 0;
  position: relative;
}
.MuiTooltip-arrow {
  color: rgba(97, 97, 97, 0.9);
  width: 1em;
  height: 0.71em;
  overflow: hidden;
  position: absolute;
  box-sizing: border-box;
}
.MuiTooltip-arrow::before {
  width: 100%;
  height: 100%;
  margin: auto;
  content: "";
  display: block;
  transform: rotate(45deg);
  background-color: currentColor;
}
.MuiTooltip-touch {
  padding: 8px 16px;
  font-size: 0.875rem;
  font-weight: 400;
  line-height: 1.14286em;
}
.MuiTooltip-tooltipPlacementLeft {
  margin: 0 24px ;
  transform-origin: right center;
}
@media (min-width:600px) {
  .MuiTooltip-tooltipPlacementLeft {
    margin: 0 14px;
  }
}
.MuiTooltip-tooltipPlacementRight {
  margin: 0 24px;
  transform-origin: left center;
}
@media (min-width:600px) {
  .MuiTooltip-tooltipPlacementRight {
    margin: 0 14px;
  }
}
.MuiTooltip-tooltipPlacementTop {
  margin: 24px 0;
  transform-origin: center bottom;
}
@media (min-width:600px) {
  .MuiTooltip-tooltipPlacementTop {
    margin: 14px 0;
  }
}
.MuiTooltip-tooltipPlacementBottom {
  margin: 24px 0;
  transform-origin: center top;
}
@media (min-width:600px) {
  .MuiTooltip-tooltipPlacementBottom {
    margin: 14px 0;
  }
}
</style><script type="text/x-mathjax-config;executed=true">MathJax.Hub.Config({
    skipStartupTypeset: true,
    showProcessingMessages: false,
    tex2jax: {
      inlineMath: [['$', '$']],
      displayMath: [['$$', '$$']],
      processEscapes: true,
      processEnvironments: false,
      processRefs: false,
      skipTags: ['script','noscript','style','textarea','pre','code','a','h1','h2','h3','h4','h5','h6']
    },
    "HTML-CSS": { 
      linebreaks: { automatic: true }
   }
   })</script><script src="./pythonで混合正規分布実装 - Qiita_files/MathJax.js"></script><meta http-equiv="origin-trial" content="A7bG5hJ4XpMV5a3V1wwAR0PalkFSxLOZeL9D/YBYdupYUIgUgGhfVJ1zBFOqGybb7gRhswfJ+AmO7S2rNK2IOwkAAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjY5NzY2Mzk5LCJpc1RoaXJkUGFydHkiOnRydWV9"><link rel="preload" href="./pythonで混合正規分布実装 - Qiita_files/f(1).txt" as="script"><script type="text/javascript" src="./pythonで混合正規分布実装 - Qiita_files/f(1).txt"></script><link rel="preload" href="./pythonで混合正規分布実装 - Qiita_files/f(2).txt" as="script"><script type="text/javascript" src="./pythonで混合正規分布実装 - Qiita_files/f(2).txt"></script><script type="text/javascript" async="" src="./pythonで混合正規分布実装 - Qiita_files/f(3).txt"></script><script type="text/javascript" async="" src="./pythonで混合正規分布実装 - Qiita_files/f(4).txt"></script><script type="text/javascript" async="" src="./pythonで混合正規分布実装 - Qiita_files/f(5).txt"></script><script type="text/javascript" async="" src="./pythonで混合正規分布実装 - Qiita_files/f(6).txt"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><script type="text/javascript" async="" src="./pythonで混合正規分布実装 - Qiita_files/f(7).txt"></script><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.6.0') format('woff'), url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.6.0') format('woff'), url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.6.0') format('woff'), url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.6.0') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_Math-bold-italic; src: url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff?rev=2.6.0') format('woff'), url('https://cdn.qiita.com/MathJax/2.6.0/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf?rev=2.6.0') format('opentype')}
</style><link rel="prefetch" href="https://qiita.com/organizations" as="document"><link rel="prefetch" href="https://qiita.com/opportunities" as="document"></head><body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><div class="allWrapper"><div id="New2GlobalHeader-react-component-d8e2e68e-1f9c-478b-8f97-f341d9c07322"><div class="st-NewHeader"><div class="st-NewHeader_container"><div class="st-NewHeader_start"><a href="https://qiita.com/" class="st-NewHeader_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 426.57 130"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a></div><div class="st-NewHeader_end"><form class="st-NewHeader_search" action="https://qiita.com/search" method="get"><span class="fa fa-fw fa-search st-NewHeader_searchIcon"></span><input type="search" class="st-NewHeader_searchInput" autocomplete="off" placeholder="記事を検索" value="" name="q" required=""></form><form class="st-NewHeader_searchModal" action="https://qiita.com/search" method="get"><input type="text" class="st-NewHeader_searchModalInput" autocomplete="off" placeholder="記事を検索" value="" name="q" required=""></form><div class="st-NewHeader_searchButton st-NewHeader_searchButton_notLoginOrBeta"><span class="fa fa-fw fa-search"></span></div><a class="st-NewHeader_loginLink" href="https://qiita.com/login?redirectTo=%2Ftaka256%2Fitems%2F3e8b127620ac92a32864" rel="nofollow">ログイン</a><a class="st-NewHeader_signupButton" href="https://qiita.com/signup?redirectTo=%2Ftaka256%2Fitems%2F3e8b127620ac92a32864" rel="nofollow">ユーザー登録</a></div><div class="st-NewHeader_overlay"></div></div></div><div class="st-NewHeader_mainNavigation"><div class="st-NewHeader_navigationTabContainer"><a class="st-NewHeader_mainNavigationItem" href="https://qiita.com/">トレンド</a><a class="st-NewHeader_mainNavigationItem" href="https://qiita.com/question-trend">質問</a><a class="st-NewHeader_mainNavigationItem" href="https://qiita.com/official-events">公式イベント</a><a class="st-NewHeader_mainNavigationItem" href="https://qiita.com/official-columns">公式コラム</a><a class="st-NewHeader_mainNavigationItem" href="https://qiita.com/opportunities">募集</a><a class="st-NewHeader_mainNavigationItem" href="https://qiita.com/organizations">Organization</a><a class="st-NewHeader_mainNavigationItem" href="https://blog.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=header" target="_blank">Qiita Blog<span class="fa fa-fw fa-window-restore st-NewHeader_mainNavigationBlankIcon"></span></a></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="New2GlobalHeader" data-dom-id="New2GlobalHeader-react-component-d8e2e68e-1f9c-478b-8f97-f341d9c07322">{"realms":[{"humanName":"Qiita","isCurrentRealm":true,"isQiita":true,"isQiitaTeam":false,"loggedInUser":null,"teamId":null,"url":"https://qiita.com/"}],"type":null,"isHideGlobalNavigation":false,"isAdventCalendarRankingBeingHeld":false,"isShowTfaDownloadAlert":null}</script>
      
<script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"/","name":"Qiita"}},{"@type":"ListItem","position":2,"item":{"@id":"/tags/python","name":"Python"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","datePublished":"2016-08-01T11:19:33.000+09:00","dateModified":"2016-12-05T21:14:50.000+09:00","headline":"pythonで混合正規分布実装","image":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-9f5428127621718a910c8b63951390ad.png?ixlib=rb-4.0.0\u0026w=1200\u0026mark64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTkxNiZ0eHQ9cHl0aG9uJUUzJTgxJUE3JUU2JUI3JUI3JUU1JTkwJTg4JUU2JUFEJUEzJUU4JUE2JThGJUU1JTg4JTg2JUU1JUI4JTgzJUU1JUFFJTlGJUU4JUEzJTg1JnR4dC1jb2xvcj0lMjMyMTIxMjEmdHh0LWZvbnQ9SGlyYWdpbm8lMjBTYW5zJTIwVzYmdHh0LXNpemU9NTYmdHh0LWNsaXA9ZWxsaXBzaXMmdHh0LWFsaWduPWxlZnQlMkN0b3Amcz04OTBmZGVkZGFlZWIxMzYxYzYxYWM4OWY4ZjUyYWYzNg\u0026mark-x=142\u0026mark-y=112\u0026blend64=aHR0cHM6Ly9xaWl0YS11c2VyLWNvbnRlbnRzLmltZ2l4Lm5ldC9-dGV4dD9peGxpYj1yYi00LjAuMCZ3PTYxNiZ0eHQ9JTQwdGFrYTI1NiZ0eHQtY29sb3I9JTIzMjEyMTIxJnR4dC1mb250PUhpcmFnaW5vJTIwU2FucyUyMFc2JnR4dC1zaXplPTM2JnR4dC1hbGlnbj1sZWZ0JTJDdG9wJnM9OGMwZDg5YTNlYTZkNzA3Y2MxMTUzOGQ4MGQ4ZGZiYjU\u0026blend-x=142\u0026blend-y=491\u0026blend-mode=normal\u0026s=74683fb9aa322098ef1e4fe1dcfd9a51","mainEntityOfPage":"https://qiita.com/taka256/items/3e8b127620ac92a32864","author":{"@type":"Person","address":"","email":null,"identifier":"taka256","name":"taka256","image":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F82527%2Fprofile-images%2F1473702483?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=788d3bbf0da2db131c8f9a34b13c9400","url":"https://qiita.com/taka256","description":"","memberOf":[{"@type":"Organization","address":"東京都渋谷区渋谷二丁目24番12号 渋谷スクランブルスクエア40F","legalName":"株式会社ディー・エヌ・エー","image":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/2d269c3551c6ad1f3e5bc4be0b507dcb5ab31318/original.jpg?1630536428","logo":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/77fe0bc145892664d307e63dcfbc7a381345ca47/original.jpg?1539161148","identifier":"dena_coltd","description":"We delight people beyond their wildest dreams."}]},"publisher":{"@type":"Organization","name":"Qiita","logo":{"@type":"ImageObject","url":"//cdn.qiita.com/assets/public/qiita-logo-c39ded593afa388e2e1ba435b110554e.png"}}}</script><script>td.trackEvent('pageviews_article',{
    user_id: "",
    article_id: "412199",
    article_uuid: "3e8b127620ac92a32864",
    td_description: "&quot;# はじめに\n\npythonで混合正規分布を実装しました．\n教科書として[『はじめてのパターン認識』](https://www.amazon.co.jp/はじめてのパターン認識-平井-有三/dp/4627849710)を使いました．\n\n本記事の構成\n\n* はじめに\n* 混合正規分布\n    * 混合正規分布モデル\n    * 隠れ変数と事後確率\n    * 対数尤度とQ関数\n* EMアルゴリズムによるパラメータ推定\n* pythonでの実装\n* 結果\n* おわりに\n\n\n# 混合正規分布\n\nデータ分布に確率モデルを当てはめると，各データがどのクラスタに属するかを確率的に決めることができます．\n多くの確率モデルは単峰性の確率分布しか表現できないため，全体の確率分布を複数の確率モデルの重み付け線形和でモデル化する必要があります．\nクラスタ数を $K$，$k$ 番目のクラスタの確率モデルを $p_k(\\boldsymbol x)$ とし，全体の確率分布を以下のように表します．\n\n```math\np(\\boldsymbol x) = \\sum_{k = 1}^K \\pi_kp_k(\\boldsymbol x)\n```\n\n$\\pi_k$ は $k$ 番目の確率モデルの重みとなります．\n確率モデルとして正規分布を用いたものを **混合正規分布モデル** と呼びます．\n\n## 混合正規分布モデル\n\n$k$ 番目のクラスタを表す $d$ 次元正規分布関数を以下のように表します．\n\n```math\nN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k) = \\frac{1}{(2\\pi)^{1/d} \\ |\\boldsymbol \\Sigma_k|^{1/2}}\\exp\\bigl(-\\frac{1}{2}(\\boldsymbol x - \\boldsymbol \\mu_k)^T \\boldsymbol \\Sigma_k^{-1}(\\boldsymbol x - \\boldsymbol \\mu_k)\\bigr)\n```\n\n全体の分布は，これらの線形和として表されます．\n\n```math\np(\\boldsymbol x) = \\sum_k^K \\pi_k N(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k), \\ 0 \\leq \\pi_k \\leq 1, \\ \\sum_{k = 1}^K \\pi_k = 1\n```\n\n$\\pi_k$ を混合比と呼び，混合正規分布モデルのパラメータは以下になります．\n\n```math\n\\boldsymbol \\pi = (\\pi_1, ..., \\pi_K), \\ \\boldsymbol \\mu = (\\boldsymbol \\mu_1, ..., \\boldsymbol \\mu_K), \\ \\boldsymbol \\Sigma = (\\boldsymbol \\Sigma_1, ..., \\boldsymbol \\Sigma_K)\n```\n\n全体のデータをうまく表現できるような $\\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma$ が必要となります．\nしかし，各データがどのクラスタに属するかは不明であるため，各パラメータを直接求めることはできません．\n\n## 隠れ変数と事後確率\n\n混合正規分布モデルでは，全体のデータから $\\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma$ を推定するために，\n各データ $\\boldsymbol x$ がどのクラスタに属するかを表す $K$ 次元の隠れ変数 $\\boldsymbol z = (z_1, ..., z_K)^T$ を導入します．\n$z_k$ は，データが $k$ 番目のクラスタに属していれば $1$，属していなければ $0$ をとります．\n\n```math\n\\sum_{k = 1}^K z_k = 1, \\ \\boldsymbol z = (0, ..., 0, 1, 0, ..., 0)^T\n```\n\n観測される $\\boldsymbol x$ と 隠れ変数 $\\boldsymbol z$ の同時分布 $p(\\boldsymbol x, \\boldsymbol z)$  は以下になります．\n\n```math\np(\\boldsymbol x, \\boldsymbol z) = p(\\boldsymbol z)p(\\boldsymbol x \\ | \\ \\boldsymbol z)\n```\n\nまた，隠れ変数の分布 $p(\\boldsymbol z)$ および観測データの隠れ変数による条件付き分布 $p(\\boldsymbol x \\ | \\ \\boldsymbol z)$ は以下のように表せます．\n\n```math\n\\begin{align}\n\u0026amp;amp; p(\\boldsymbol z) = \\prod_{k = 1}^K \\pi_k^{z_k} \\\\\n\u0026amp;amp; p(\\boldsymbol x \\ | \\ \\boldsymbol z) = \\prod_{k = 1}^K \\big[N(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k)\\bigr]^{z_k}\n\\end{align}\n```\n\nさらに，同時分布 $p(\\boldsymbol x, \\boldsymbol z)$ をすべての $\\boldsymbol z$ について加えることで，$p(\\boldsymbol x)$ を求めることができます．\n\n```math\n\\begin{align}\np(\\boldsymbol x) \u0026amp;amp;= \\sum_{\\substack{k = 1 \\\\ (z_k = 1, z_{j \\neq k} = 0)}}^K p(\\boldsymbol x, \\boldsymbol z) \\\\\n\u0026amp;amp;= \\sum_{\\substack{k = 1 \\\\ (z_k = 1, z_{j \\neq k} = 0)}}^K p(\\boldsymbol z)p(\\boldsymbol x \\ | \\ \\boldsymbol z) \\\\\n\u0026amp;amp;= \\sum_{\\substack{k = 1 \\\\ (z_k = 1, z_{j \\neq k} = 0)}}^K \\prod_{k = 1}^K \\pi_k^{z_k} \\prod_{k = 1}^K \\big[N(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k)\\bigr]^{z_k} \\\\\n\u0026amp;amp;= \\sum_{k = 1}^K \\pi_kN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k)\n\\end{align}\n```\n\n以上の分布を用いると，隠れ変数の事後確率 $\\gamma(z_k)$ は以下のように表されます．\n\n```math\n\\begin{align}\n\\gamma(z_k) \u0026amp;amp;\\equiv p(z_k = 1 \\ | \\ \\boldsymbol x) \\\\\n\u0026amp;amp;\\\\\n\u0026amp;amp;= \\frac{p(z_k = 1)p(\\boldsymbol x \\ | \\ z_k = 1)}{\\sum_{j = 1}^K p(z_j = 1)p(\\boldsymbol x \\ | \\ z_j = 1)} \\\\\n\u0026amp;amp;\\\\\n\u0026amp;amp;= \\frac{\\pi_kN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k)}{\\sum_{j = 1}^K \\pi_jN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_j, \\boldsymbol \\Sigma_j)} \\tag{*}\n\\end{align}\n```\n\n## 対数尤度とQ関数\n\n観測データ $\\boldsymbol X$ および隠れ変数 $\\boldsymbol Z$ を以下のように表します．\n$C_k$ は，クラスタ $k$ を表します．\n\n```math\n\\begin{align}\n\u0026amp;amp; \\boldsymbol X = (\\boldsymbol x_1, ..., \\boldsymbol x_N), \\ \\boldsymbol x_i = (x_{i1}, ..., x_{id})^T \\\\\n\u0026amp;amp; \\boldsymbol Z = (\\boldsymbol z_1, ..., \\boldsymbol z_N), \\ \\boldsymbol z_i = (z_{i1}, ..., z_{iK})^T \\\\\n\u0026amp;amp; z_{ik} = \\begin{cases}\n1 \\ (x_i \\in C_k) \\\\\n0 \\ (x_i \\notin C_k)\n\\end{cases}\n\\end{align}\n```\n\n観測データと隠れ変数を合わせた集合を完全データと呼びます．\n\n```math\n\\boldsymbol Y = (\\boldsymbol x_1, ..., \\boldsymbol x_N, \\boldsymbol z_1, ..., \\boldsymbol z_N) = (\\boldsymbol X, \\boldsymbol Z)\n```\n\n混合正規分布のパラメータ $\\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma$ は，完全データの尤度を最大にするパラメータで求めることとします．\n完全データの尤度は以下のように表せます．\n\n```math\n\\begin{align}\np(\\boldsymbol Y \\ | \\ \\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma) \u0026amp;amp;= p(\\boldsymbol Z \\ | \\ \\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma) p(\\boldsymbol X \\ | \\ \\boldsymbol Z, \\ \\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma) \\\\\n\u0026amp;amp;\\\\\n\u0026amp;amp;= \\prod_{i = 1}^N \\prod_{k = 1}^K \\bigl[\\pi_kN(\\boldsymbol x_i \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k) \\bigr]^{z_{ik}}\n\\end{align}\n```\n\n最尤推定値を求めるために対数尤度に変形します．\n\n```math\n\\begin{align}\n\\tilde{L} \u0026amp;amp;= \\ln p(\\boldsymbol Y \\ | \\ \\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma) \\\\\n\u0026amp;amp;\\\\\n\u0026amp;amp;= \\sum_{i = 1}^N \\sum_{k = 1}^K z_{ik} \\ln \\pi_k + \\sum_{i = 1}^N \\sum_{k = 1}^K z_{ik} \\ln N(\\boldsymbol x_i \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k) \\\\\n\u0026amp;amp;\\\\\n\u0026amp;amp;= \\sum_{i = 1}^N \\sum_{k = 1}^K z_{ik} \\ln \\pi_k + \\sum_{i = 1}^N \\sum_{k = 1}^K z_{ik} \\bigl(-\\frac{d}{2}\\ln (2\\pi) + \\frac{1}{2} \\ln \\bigl|\\boldsymbol \\Sigma_k \\bigr|^{-1} - \\frac{1}{2}(\\boldsymbol x_i - \\boldsymbol \\mu_k)^T \\boldsymbol \\Sigma_k^{-1}(\\boldsymbol x_i - \\boldsymbol \\mu_k) \\bigr)\n\\end{align}\n```\n\n対数尤度の隠れ変数に関する期待値をとります．\n\n```math\n\\begin{align}\nL \u0026amp;amp;= E_z \\bigl\\{\\tilde{L} \\bigr\\} \\\\\n\u0026amp;amp;\\\\\n\u0026amp;amp;= \\sum_{i = 1}^N \\sum_{k = 1}^K E_{z_{ik}} \\bigl\\{z_{ik} \\bigr\\} \\ln \\pi_k + \\sum_{i = 1}^N \\sum_{k = 1}^K E_{z_{ik}} \\bigl\\{z_{ik} \\bigr\\} \\bigl(-\\frac{d}{2}\\ln (2\\pi) + \\frac{1}{2} \\ln \\bigl|\\boldsymbol \\Sigma_k \\bigr|^{-1} - \\frac{1}{2}(\\boldsymbol x_i - \\boldsymbol \\mu_k)^T \\boldsymbol \\Sigma_k^{-1}(\\boldsymbol x_i - \\boldsymbol \\mu_k) \\bigr)\n\\end{align}\n```\n\n隠れ変数に関する期待値は，式(*)より以下のようになり，隠れ変数の事後確率となります．\n\n```math\n\\begin{align}\nE_{z_{ik}} \\bigl\\{z_{ik} \\bigr\\} \u0026amp;amp;= \\sum_{z_{ik} = \\{0, 1\\}} z_{ik}p(z_{ik} \\ | \\ \\boldsymbol x_i, \\pi_k, \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k) \\\\\n\u0026amp;amp;\\\\\n\u0026amp;amp;= 1 \\times p(z_{ik} = 1 \\ | \\ \\boldsymbol x_i) \\\\\n\u0026amp;amp;\\\\\n\u0026amp;amp; = \\frac{p(z_{ik} = 1)p(\\boldsymbol x_i \\ | \\ z_{ik} = 1)}{\\sum_{j = 1}^K p(z_{ij} = 1)p(\\boldsymbol x \\ | \\ z_{ij} = 1)} \\\\\n\u0026amp;amp;\\\\\n\u0026amp;amp;= \\frac{\\pi_kN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k)}{\\sum_{j = 1}^K \\pi_jN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_j, \\boldsymbol \\Sigma_j)} \\\\\n\u0026amp;amp;\\\\\n\u0026amp;amp;= \\gamma(z_{ik})\n\\end{align}\n```\n\n$L$ の隠れ変数の期待値を事後確率で置換した関数を **Q関数** と呼びます．\n\n```math\nQ = \\sum_{i = 1}^N \\sum_{k = 1}^K \\gamma(z_{ik}) \\ln \\pi_k + \\sum_{i = 1}^N \\sum_{k = 1}^K \\gamma(z_{ik}) \\ln \\pi_k \\bigl(-\\frac{d}{2}\\ln (2\\pi) + \\frac{1}{2} \\ln \\bigl|\\boldsymbol \\Sigma_k \\bigr|^{-1} - \\frac{1}{2}(\\boldsymbol x_i - \\boldsymbol \\mu_k)^T \\boldsymbol \\Sigma_k^{-1}(\\boldsymbol x_i - \\boldsymbol \\mu_k) \\bigr)\n```\n\n\n# EMアルゴリズムによるパラメータ推定\n\n隠れ変数がある確率モデルのパラメータの最尤推定値を求める手法として **EMアルゴリズム** を用います．\nEMアルゴリズムは2つのステップで構成されます．\n\n* Expectationステップ：隠れ変数に関する期待値を取る操作．モデルパラメータを固定して隠れ変数の事後確率を求める．\n* Maximizationステップ：Eステップで求めた隠れ変数の事後確率を用いてQ関数を最大にするモデルパラメータを求める．\n\nEMアルゴリズムは完全データの対数尤度に変化がなくなるまで，EステップおよびMステップを繰り返します．\n収束値は初期値に依存するため，局所最適解しか得られません．\n初期値を変えて複数回EMアルゴリズムを使って最尤推定値を求め，その中から良いものを選択する必要があります．\nEMアルゴリズムをまとめると，次のようになります．\n\n1. $\\pi_k, \\ \\boldsymbol \\mu_k, \\ \\boldsymbol \\Sigma_k$ の初期化\n2. Eステップ：現在のパラメータ $\\pi_k, \\ \\boldsymbol \\mu_k, \\ \\boldsymbol \\Sigma_k$ を用いた事後確率 $\\gamma(z_{ik})$ の推定  \n$$\\gamma(z_{ik}) = \\frac{\\pi_kN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k)}{\\sum_{j = 1}^K \\pi_jN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_j, \\boldsymbol \\Sigma_j)}$$\n3. Mステップ：推定した $\\gamma(z_{ik})$ を用いたモデルパラメータの再推定  \n$$\n\\begin{align}\n\u0026amp;amp; N_k = \\sum_{i = 1}^N \\gamma(z_{ik})  \\\\\\\n\u0026amp;amp; \\\\\\\n\u0026amp;amp; \\boldsymbol \\mu_k = \\frac{1}{N_k} \\sum_{i = 1}^N \\gamma(z_{ik}) \\boldsymbol x_i  \\\\\\\n\u0026amp;amp; \\\\\\\n\u0026amp;amp; \\boldsymbol \\Sigma_k = \\frac{1}{N_k} \\sum_{i = 1}^N \\gamma(z_{ik}) (\\boldsymbol x_i - \\boldsymbol \\mu_k)(\\boldsymbol x_i - \\boldsymbol \\mu_k)^T  \\\\\\\n\u0026amp;amp; \\\\\\\n\u0026amp;amp; \\pi_k = \\frac{N_k}{N}  \n\\end{align}\n$$\n4. 終了判定：完全データの対数尤度が収束していない場合2.から再計算．収束していれば終了．\n\n\n# pythonでの実装\n\n以下のように実装しました．\n\n```mixturesofgaussian.py\nimport numpy\nfrom matplotlib import pyplot\nimport sys\n\ndef create_data(N, K):\n    X, mu_star, sigma_star = [], [], []\n    for i in range(K):\n        loc = (numpy.random.rand() - 0.5) * 10.0 # range: -5.0 - 5.0\n        scale = numpy.random.rand() * 3.0 # range: 0.0 - 3.0\n        X = numpy.append(X, numpy.random.normal(loc = loc, scale = scale, size = N / K))\n        mu_star = numpy.append(mu_star, loc)\n        sigma_star = numpy.append(sigma_star, scale)\n    return (X, mu_star, sigma_star)\n\ndef gaussian(mu, sigma):\n    def f(x):\n        return numpy.exp(-0.5 * (x - mu) ** 2 / sigma) / numpy.sqrt(2 * numpy.pi * sigma)\n    return f\n\ndef estimate_posterior_likelihood(X, pi, gf):\n    l = numpy.zeros((X.size, pi.size))\n    for (i, x) in enumerate(X):\n        l[i, :] = gf(x)\n    return pi * l * numpy.vectorize(lambda y: 1 / y)(l.sum(axis = 1).reshape(-1, 1))\n\ndef estimate_gmm_parameter(X, gamma):\n    N = gamma.sum(axis = 0)\n    mu = (gamma * X.reshape((-1, 1))).sum(axis = 0) / N\n    sigma = (gamma * (X.reshape(-1, 1) - mu) ** 2).sum(axis = 0) / N\n    pi = N / X.size\n    return (mu, sigma, pi)\n\ndef calc_Q(X, mu, sigma, pi, gamma):\n    Q = (gamma * (numpy.log(pi * (2 * numpy.pi * sigma) ** (-0.5)))).sum()\n    for (i, x) in enumerate(X):\n        Q += (gamma[i, :] * (-0.5 * (x - mu) ** 2 / sigma)).sum()\n    return Q\n\nif __name__ == \u0026amp;#39;__main__\u0026amp;#39;:\n\n    # data\n    K = 2\n    N = 1000 * K\n    X, mu_star, sigma_star = create_data(N, K)\n\n    # termination condition\n    epsilon = 0.000001\n\n    # initialize gmm parameter\n    pi = numpy.random.rand(K)\n    mu = numpy.random.randn(K)\n    sigma = numpy.abs(numpy.random.randn(K))\n    Q = -sys.float_info.max\n    delta = None\n\n    # EM algorithm\n    while delta == None or delta \u0026amp;gt;= epsilon:\n        gf = gaussian(mu, sigma)\n\n        # E step: estimate posterior probability of hidden variable gamma\n        gamma = estimate_posterior_likelihood(X, pi, gf)\n\n        # M step: miximiz...&quot;",
    td_title: "&quot;pythonで混合正規分布実装&quot;"
  })</script><script async="" src="./pythonで混合正規分布実装 - Qiita_files/qiita_bigmining.js"></script><div style="display:none"><div class="TagList__label"><span></span><span>Python</span></div><div class="TagList__label"><span></span><span>機械学習</span></div></div><img style="display:block;margin:0;padding:0;border:0;outline:0;width:0;height:0;line-height:0;" alt="" src="./pythonで混合正規分布実装 - Qiita_files/bizmatrix"><script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"ja","i18nDefaultLocale":"en","href":"https://qiita.com/taka256/items/3e8b127620ac92a32864","location":"/taka256/items/3e8b127620ac92a32864","scheme":"https","host":"qiita.com","port":null,"pathname":"/taka256/items/3e8b127620ac92a32864","search":null,"httpAcceptLanguage":"ja,en-US;q=0.9,en;q=0.8","actionPath":"public/items#show","settings":{"analyticsTrackingId":"UA-24675221-12","assetsMap":{},"csrfToken":"ONWFOnl5u98XMLTu0HrUdUTbiGMH/c4hYDLvH4uNE4HKeLtBLmolqtouOZBJp2J4f0d+/KaKzJuyEiVIMsZGcw==","locale":"ja"},"currentUser":null,"isLoggedIn":false,"recaptchaSiteKey":"6LfNkiQTAAAAAM3UGnSquBy2akTITGNMO_QDxMw6","errorIconPath":"//cdn.qiita.com/assets/icons/large/missing-profile-image-828ed5829a93fbb35746a6c0f7c8107e.png","serverSide":false}</script>
<div id="PersonalArticlePage-react-component-88129006-5b5e-4a58-a321-34f5817d54a8"><div class="p-items_wrapper"><div class=" css-vnk55c"><div class="css-1ibnx62"><div class="css-1x8nfy4"><div class="css-1duml6f"><div style="width:64px;height:64px;overflow:hidden;margin:0 auto;outline:none;left:50%;position:absolute;top:50%;transform:translate(-50%, -50%)" title="" role="" aria-label="animation" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="64" height="64" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: 100%; transform: translate3d(0px, 0px, 0px); content-visibility: visible;"><defs><clippath id="__lottie_element_2"><rect width="64" height="64" x="0" y="0"></rect></clippath><mask id="__lottie_element_33" mask-type="alpha"><g style="display: none;"><g><path></path></g></g></mask></defs><g clip-path="url(#__lottie_element_2)"><g transform="matrix(1,0,0,1,11,11)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,21,21)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M0,-19 C0,-19 0,-19 0,-19 C10.493000030517578,-19 19,-10.494000434875488 19,0 C19,10.493000030517578 10.493000030517578,19 0,19 C-10.494000434875488,19 -19,10.493000030517578 -19,0 C-19,-10.494000434875488 -10.494000434875488,-19 0,-19z"></path><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="4" stroke="rgb(85,197,0)" stroke-opacity="1" stroke-width="2" d=" M0,-19 C0,-19 0,-19 0,-19 C10.493000030517578,-19 19,-10.494000434875488 19,0 C19,10.493000030517578 10.493000030517578,19 0,19 C-10.494000434875488,19 -19,10.493000030517578 -19,0 C-19,-10.494000434875488 -10.494000434875488,-19 0,-19z"></path></g></g><g transform="matrix(1,0,0,1,31.253000259399414,32.73200225830078)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,5.218999862670898,4.959000110626221)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-0.33500000834465027,2.4159998893737793 C-0.33500000834465027,2.4159998893737793 -2.3550000190734863,-0.5899999737739563 -2.3550000190734863,-0.5899999737739563 C-2.3550000190734863,-0.5899999737739563 -2.3550000190734863,4.709000110626221 -2.3550000190734863,4.709000110626221 C-2.3550000190734863,4.709000110626221 -4.968999862670898,4.709000110626221 -4.968999862670898,4.709000110626221 C-4.968999862670898,4.709000110626221 -4.968999862670898,-4.709000110626221 -4.968999862670898,-4.709000110626221 C-4.968999862670898,-4.709000110626221 -2.6670000553131104,-4.709000110626221 -2.6670000553131104,-4.709000110626221 C-2.6670000553131104,-4.709000110626221 -0.01600000075995922,-0.9629999995231628 -0.01600000075995922,-0.9629999995231628 C-0.01600000075995922,-0.9629999995231628 2.694999933242798,-4.709000110626221 2.694999933242798,-4.709000110626221 C2.694999933242798,-4.709000110626221 4.968999862670898,-4.709000110626221 4.968999862670898,-4.709000110626221 C4.968999862670898,-4.709000110626221 4.968999862670898,4.709000110626221 4.968999862670898,4.709000110626221 C4.968999862670898,4.709000110626221 2.3550000190734863,4.709000110626221 2.3550000190734863,4.709000110626221 C2.3550000190734863,4.709000110626221 2.3550000190734863,-0.5609999895095825 2.3550000190734863,-0.5609999895095825 C2.3550000190734863,-0.5609999895095825 0.3009999990463257,2.4159998893737793 0.3009999990463257,2.4159998893737793 C0.3009999990463257,2.4159998893737793 -0.33500000834465027,2.4159998893737793 -0.33500000834465027,2.4159998893737793z"></path></g></g><g transform="matrix(1,0,0,1,22.149999618530273,32.72599792480469)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,4.031000137329102,4.961999893188477)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-1.2940000295639038,-2.5350000858306885 C-1.2940000295639038,-2.5350000858306885 -3.7809998989105225,-2.5350000858306885 -3.7809998989105225,-2.5350000858306885 C-3.7809998989105225,-2.5350000858306885 -3.7809998989105225,-4.711999893188477 -3.7809998989105225,-4.711999893188477 C-3.7809998989105225,-4.711999893188477 3.7809998989105225,-4.711999893188477 3.7809998989105225,-4.711999893188477 C3.7809998989105225,-4.711999893188477 3.7809998989105225,-2.5350000858306885 3.7809998989105225,-2.5350000858306885 C3.7809998989105225,-2.5350000858306885 1.2990000247955322,-2.5350000858306885 1.2990000247955322,-2.5350000858306885 C1.2990000247955322,-2.5350000858306885 1.2990000247955322,4.711999893188477 1.2990000247955322,4.711999893188477 C1.2990000247955322,4.711999893188477 -1.2940000295639038,4.711999893188477 -1.2940000295639038,4.711999893188477 C-1.2940000295639038,4.711999893188477 -1.2940000295639038,-2.5350000858306885 -1.2940000295639038,-2.5350000858306885z"></path></g></g><g transform="matrix(1,0,0,1,31.006000518798828,21.350000381469727)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,5.2769999504089355,5.206999778747559)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M0.09700000286102295,-0.40400001406669617 C0.09700000286102295,-0.40400001406669617 4.982999801635742,-0.40400001406669617 4.982999801635742,-0.40400001406669617 C5.0269999504089355,0.4059999883174896 4.934000015258789,1.1369999647140503 4.705999851226807,1.7960000038146973 C4.484000205993652,2.4549999237060547 4.1539998054504395,3.0169999599456787 3.7219998836517334,3.48799991607666 C3.2909998893737793,3.9570000171661377 2.7730000019073486,4.322000026702881 2.1659998893737793,4.573999881744385 C1.5609999895095825,4.830999851226807 0.8970000147819519,4.955999851226807 0.18400000035762787,4.955999851226807 C-0.5389999747276306,4.955999851226807 -1.2170000076293945,4.824999809265137 -1.847000002861023,4.567999839782715 C-2.4769999980926514,4.310999870300293 -3.0299999713897705,3.9579999446868896 -3.5,3.507999897003174 C-3.9700000286102295,3.056999921798706 -4.3429999351501465,2.5339999198913574 -4.614999771118164,1.9279999732971191 C-4.886000156402588,1.3220000267028809 -5.0269999504089355,0.6809999942779541 -5.0269999504089355,-0.007000000216066837 C-5.0269999504089355,-0.6949999928474426 -4.890999794006348,-1.340000033378601 -4.614999771118164,-1.940999984741211 C-4.339000225067139,-2.5369999408721924 -3.9700000286102295,-3.065999984741211 -3.5,-3.51200008392334 C-3.0299999713897705,-3.9630000591278076 -2.4769999980926514,-4.310999870300293 -1.847000002861023,-4.567999839782715 C-1.2170000076293945,-4.824999809265137 -0.5389999747276306,-4.955999851226807 0.18400000035762787,-4.955999851226807 C0.9100000262260437,-4.955999851226807 1.5889999866485596,-4.824999809265137 2.2200000286102295,-4.567999839782715 C2.8499999046325684,-4.310999870300293 3.4079999923706055,-3.947000026702881 3.8970000743865967,-3.4769999980926514 C3.8970000743865967,-3.4769999980926514 2.196000099182129,-1.7769999504089355 2.196000099182129,-1.7769999504089355 C1.968000054359436,-2.0820000171661377 1.6820000410079956,-2.322999954223633 1.3320000171661377,-2.503000020980835 C0.984000027179718,-2.681999921798706 0.6010000109672546,-2.7750000953674316 0.17900000512599945,-2.7750000953674316 C-0.17900000512599945,-2.7750000953674316 -0.5189999938011169,-2.7019999027252197 -0.8339999914169312,-2.561000108718872 C-1.1490000486373901,-2.4210000038146973 -1.4210000038146973,-2.2269999980926514 -1.6579999923706055,-1.9800000190734863 C-1.8899999856948853,-1.7319999933242798 -2.075000047683716,-1.4420000314712524 -2.2160000801086426,-1.1019999980926514 C-2.3510000705718994,-0.7630000114440918 -2.4200000762939453,-0.39399999380111694 -2.4200000762939453,0.003000000026077032 C-2.4200000762939453,0.3959999978542328 -2.3510000705718994,0.7630000114440918 -2.2160000801086426,1.1019999980926514 C-2.0799999237060547,1.4420000314712524 -1.8960000276565552,1.7389999628067017 -1.6579999923706055,1.9859999418258667 C-1.4249999523162842,2.2330000400543213 -1.1490000486373901,2.4260001182556152 -0.8339999914169312,2.565999984741211 C-0.5189999938011169,2.7070000171661377 -0.17900000512599945,2.7809998989105225 0.17900000512599945,2.7809998989105225 C0.8330000042915344,2.7809998989105225 1.3320000171661377,2.6589999198913574 1.687000036239624,2.4170000553131104 C2.0399999618530273,2.174999952316284 2.2730000019073486,1.840000033378601 2.3889999389648438,1.4229999780654907 C2.3889999389648438,1.4229999780654907 0.09200000017881393,1.4229999780654907 0.09200000017881393,1.4229999780654907 C0.09200000017881393,1.4229999780654907 0.09700000286102295,-0.40400001406669617 0.09700000286102295,-0.40400001406669617z"></path></g></g><g transform="matrix(1,0,0,1,22.730998992919922,21.097000122070312)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,3.73799991607666,4.961999893188477)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-3.48799991607666,-4.711999893188477 C-3.48799991607666,-4.711999893188477 -0.875,-4.711999893188477 -0.875,-4.711999893188477 C-0.875,-4.711999893188477 -0.875,2.5360000133514404 -0.875,2.5360000133514404 C-0.875,2.5360000133514404 3.48799991607666,2.5360000133514404 3.48799991607666,2.5360000133514404 C3.48799991607666,2.5360000133514404 3.48799991607666,4.711999893188477 3.48799991607666,4.711999893188477 C3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 C-3.48799991607666,4.711999893188477 -3.48799991607666,-4.711999893188477 -3.48799991607666,-4.711999893188477z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-123.23100280761719,105.90299987792969"></path></g></g><g style="display: none;"><g><path></path></g></g><g mask="url(#__lottie_element_33)" style="display: block;"><g transform="matrix(1,0,0,1,22.730998992919922,21.097000122070312)" opacity="1"><g opacity="1" transform="matrix(1,0,0,1,3.73799991607666,4.961999893188477)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M-3.48799991607666,-4.711999893188477 C-3.48799991607666,-4.711999893188477 -0.875,-4.711999893188477 -0.875,-4.711999893188477 C-0.875,-4.711999893188477 -0.875,2.5360000133514404 -0.875,2.5360000133514404 C-0.875,2.5360000133514404 3.48799991607666,2.5360000133514404 3.48799991607666,2.5360000133514404 C3.48799991607666,2.5360000133514404 3.48799991607666,4.711999893188477 3.48799991607666,4.711999893188477 C3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 C-3.48799991607666,4.711999893188477 -3.48799991607666,-4.711999893188477 -3.48799991607666,-4.711999893188477z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M-123.23100280761719,105.90299987792969"></path></g></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g></g></svg></div><div class=""><button class="css-nje458"></button></div></div><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864/likers" aria-label="77LGTM" class="css-1otwww0">77</a></div><div class="css-tubf1g"><button class=" css-nb6j9u"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#5f6161" class="css-kfddif e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-19m4w61">67</span></div><button class="css-cgslon" type="button" aria-label="twitterでシェア"><span class="fa fa-fw fa-twitter"></span></button><button class="css-cgslon" type="button" aria-label="facebookでシェア"><span class="fa fa-fw fa-facebook"></span></button><div class="css-79elbk"><button type="button" aria-label="オプションを開く" class="css-1ydfkyi"><span class="fa fa-fw fa-ellipsis-h"></span></button><div class="css-l40u17"><div class="css-1gj7nt">記事の改善</div><a href="https://qiita.com/drafts/3e8b127620ac92a32864/edit" rel="nofollow" class="css-1g6mqq7"><span class="fa fa-fw fa-code-fork css-amwp7n" aria-hidden="true"></span>編集リクエストを送る</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">記事の情報</div><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864/revisions" rel="nofollow" class="css-1g6mqq7"><span class="fa fa-fw fa-history css-amwp7n" aria-hidden="true"></span>編集履歴</a><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864/patches" class="css-1g6mqq7"><span class="fa fa-fw fa-inbox css-amwp7n" aria-hidden="true"></span>編集リクエスト一覧</a><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864/likers" class="css-1g6mqq7"><span class="css-x9qlq8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="css-2ycz42"><path d="M19.1734 4.42307H14.4619L14.2696 6.15384H16.4811C16.385 6.53845 16.1927 6.92307 15.8081 7.11538C15.5196 7.40384 15.0388 7.49999 14.3658 7.49999C14.0773 7.49999 13.6927 7.40384 13.4042 7.30768C13.1158 7.11538 12.8273 6.92307 12.635 6.73076C12.3465 6.4423 12.1542 6.15384 12.0581 5.86538C11.9619 5.57692 11.8658 5.1923 11.8658 4.80769C11.8658 4.42307 11.9619 4.03846 12.0581 3.75C12.2504 3.36538 12.4427 3.07692 12.635 2.88461C12.8273 2.59615 13.1158 2.40384 13.4042 2.30769C13.6927 2.21154 13.9811 2.11538 14.3658 2.11538C14.8465 2.11538 15.2311 2.21154 15.5196 2.40384C15.9042 2.59615 16.1927 2.78846 16.385 3.07692L18.0196 1.44231C17.5388 0.961537 16.9619 0.673076 16.385 0.384615C15.8081 0.0961533 15.135 0 14.4619 0C13.7888 0 13.1158 0.0961533 12.5388 0.384615C11.8658 0.673076 11.385 0.961537 10.9042 1.44231C10.4235 1.92307 10.135 2.40384 9.84653 2.98077C9.55807 3.55769 9.46191 4.13461 9.46191 4.80769C9.46191 5.48076 9.55807 6.05768 9.84653 6.63461C10.135 7.21153 10.4235 7.6923 10.9042 8.17307C11.385 8.65384 11.9619 8.9423 12.5388 9.23076C13.1158 9.51922 13.7888 9.61537 14.4619 9.61537C15.135 9.61537 15.8081 9.51922 16.385 9.23076C16.9619 8.9423 17.5388 8.65384 17.9234 8.17307C18.3081 7.6923 18.6927 7.21153 18.885 6.53845C19.1734 5.86538 19.1734 5.19229 19.1734 4.42307Z"></path><path d="M4.07715 0.192322H1.57715V9.23077H8.30791V7.11539H4.07715V0.192322Z"></path><path d="M3.40384 13.0769H1V10.9615H8.30768V13.0769H5.90384V20H3.40384V13.0769Z"></path><path d="M12.25 14.9039L14.1731 17.7885H14.8461L16.8654 14.9039V20H19.3654V10.9615H17.1538L14.5577 14.5192L11.9615 10.9615H9.75V20H12.25V14.9039Z"></path></svg></span>LGTMしたユーザー一覧</a><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864.md" rel="nofollow" class="css-1g6mqq7"><span class="fa fa-fw fa-file-text-o css-amwp7n" aria-hidden="true"></span>Markdown で本文を見る</a><div class="css-1ode1bp"></div><button class="css-1nt9rv7"><span class="fa fa-fw fa-flag css-amwp7n" aria-hidden="true"></span>問題がある記事を報告する</button></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">どのような問題がありますか？</span></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="CommunityGuidelineViolation">コミュニティガイドライン違反</label></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="IllegalViolation">法律違反</label></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="SociallyInappropriate">社会的に不適切</label></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="SuspectedSpam">スパムの疑い</label></div><div class="st-Form st-Form-right"><button type="submit" class="css-qgrf2v e1rb7ucl0" disabled="" font-size="14">送信</button></div></form></div></div></div></div><div class="p-items_options"><div class="mt-2"><div id="dfp-slot-article-sidebar-top" class="ad-300x250" data-test-adunitpath="/383564218/qiita.com_items-show_sidebar-top" elementtiming="gpt-dfp-slot-article-sidebar-top" data-testid="ArticleAdsSidebarTop_AdUnit" data-google-query-id="CK-azqXb3vkCFdVmYAodN7AAyQ"><div id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-top_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-top_0" name="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-top_0" title="3rd party ad content" width="300" height="250" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" role="region" aria-label="Advertisement" tabindex="0" style="border: 0px; vertical-align: bottom;" data-load-complete="true" data-google-container-id="1" src="./pythonで混合正規分布実装 - Qiita_files/saved_resource.html"></iframe></div></div></div></div><div class="p-items_toc"><div class="mt-2"><div id="dfp-slot-article-sidebar-bottom" class="ad-300x250" data-test-adunitpath="/383564218/qiita.com_items-show_sidebar-bottom" elementtiming="gpt-dfp-slot-article-sidebar-bottom" data-testid="ArticleAdsSidebarBottom_AdUnit" data-google-query-id="CMLa66Xb3vkCFbfrTAIdzJwDwg"><div id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-bottom_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-bottom_0" name="google_ads_iframe_/383564218/qiita.com_items-show_sidebar-bottom_0" title="3rd party ad content" width="300" height="250" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" role="region" aria-label="Advertisement" tabindex="0" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" style="border: 0px; vertical-align: bottom;" data-load-complete="true" data-google-container-id="2" src="./pythonで混合正規分布実装 - Qiita_files/saved_resource(1).html"></iframe></div></div></div><div class="css-jm6hra"><div class="css-11ygya4"><ul>
<li>
<a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB" class="">はじめに</a>
</li>
<li>
<a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83" class="">混合正規分布</a>
<ul>
<li>
<a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%83%A2%E3%83%87%E3%83%AB" class="">混合正規分布モデル</a>
</li>
<li>
<a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E9%9A%A0%E3%82%8C%E5%A4%89%E6%95%B0%E3%81%A8%E4%BA%8B%E5%BE%8C%E7%A2%BA%E7%8E%87" class="">隠れ変数と事後確率</a>
</li>
<li>
<a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E5%AF%BE%E6%95%B0%E5%B0%A4%E5%BA%A6%E3%81%A8q%E9%96%A2%E6%95%B0" class="focus">対数尤度とQ関数</a>
</li>
</ul>
</li>
<li>
<a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#em%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0%E3%81%AB%E3%82%88%E3%82%8B%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A" class="">EMアルゴリズムによるパラメータ推定</a>
</li>
<li>
<a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#python%E3%81%A7%E3%81%AE%E5%AE%9F%E8%A3%85" class="">pythonでの実装</a>
</li>
<li>
<a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E7%B5%90%E6%9E%9C">結果</a>
</li>
<li>
<a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB">おわりに</a>
</li>
</ul>
</div></div></div><div class="p-items_main"><div class="css-u681u4"><span class="fa fa-fw fa-warning css-hxgmls"></span><p>この記事は最終更新日から5年以上が経過しています。</p></div><div class="css-r67lmd"><div class="css-8qb8m4"><div class="css-2imjyh"><div class="css-17zza1i"><div><div class="css-70qvj9"><a href="https://qiita.com/taka256" class="css-6su6fj"><img class="css-1ndxrmk eyfquo10" src="./pythonで混合正規分布実装 - Qiita_files/1473702483" width="24" height="24" size="24" loading="lazy"></a><div class="css-1r4slzx"><a href="https://qiita.com/taka256" class="css-772dpg">@<!-- -->taka256</a><a href="https://qiita.com/organizations/dena_coltd" class="css-bjms2a">(<!-- -->株式会社ディー・エヌ・エー<!-- -->)</a></div></div><div class="css-17ay39c"><p class="css-1ay9vb9">投稿日 <time datetime="2016-08-01T02:19:33Z">2016年08月01日</time></p><p class="css-1ay9vb9">更新日 <time datetime="2016-12-05T12:14:50Z">2016年12月05日</time></p></div></div><div class="css-hpp7el"><div class="css-1lbjcyg">Organization</div></div></div></div><h1 class="css-188vyrl">pythonで混合正規分布実装</h1><div class="css-1wa99t2"><span class="fa fa-tags mr-1of2 css-1l3zk9f" aria-hidden="true"></span><a href="https://qiita.com/tags/python" class="css-1a610x3">Python</a><span class="css-189rs1q">,</span><a href="https://qiita.com/tags/%e6%a9%9f%e6%a2%b0%e5%ad%a6%e7%bf%92" class="css-1a610x3">機械学習</a></div></div><section class="it-MdContent"><div id="personal-public-article-body"><div>
<h1>
<span id="はじめに" class="fragment"></span><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>pythonで混合正規分布を実装しました．<br>
教科書として<a href="https://www.amazon.co.jp/%E3%81%AF%E3%81%98%E3%82%81%E3%81%A6%E3%81%AE%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E8%AA%8D%E8%AD%98-%E5%B9%B3%E4%BA%95-%E6%9C%89%E4%B8%89/dp/4627849710" rel="nofollow noopener" target="_blank">『はじめてのパターン認識』</a>を使いました．</p>

<p>本記事の構成</p>

<ul>
<li>はじめに</li>
<li>混合正規分布

<ul>
<li>混合正規分布モデル</li>
<li>隠れ変数と事後確率</li>
<li>対数尤度とQ関数</li>
</ul>
</li>
<li>EMアルゴリズムによるパラメータ推定</li>
<li>pythonでの実装</li>
<li>結果</li>
<li>おわりに</li>
</ul>

<h1>
<span id="混合正規分布" class="fragment"></span><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83"><i class="fa fa-link"></i></a>混合正規分布</h1>

<p>データ分布に確率モデルを当てはめると，各データがどのクラスタに属するかを確率的に決めることができます．<br>
多くの確率モデルは単峰性の確率分布しか表現できないため，全体の確率分布を複数の確率モデルの重み付け線形和でモデル化する必要があります．<br>
クラスタ数を <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" role="math" style="width: 1.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.92em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">K</script>，<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" role="math" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">k</script> 番目のクラスタの確率モデルを <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" role="math" style="width: 2.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1002.32em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-8"><span class="msubsup" id="MathJax-Span-9"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-11" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3">p_k(\boldsymbol x)</script> とし，全体の確率分布を以下のように表します．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-15" role="math" style="width: 9.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.3em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.488em, 1008.19em, 3.774em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-16"><span class="texatom" id="MathJax-Span-17"><span class="mrow" id="MathJax-Span-18"><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-24" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-26"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-29" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-30" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-31" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-32" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-35"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-37" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.497em; border-left: 0px solid; width: 0px; height: 3.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>π</mi><mi>k</mi></msub><msub><mi>p</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">{p(\boldsymbol x) = \sum_{k = 1}^K \pi_kp_k(\boldsymbol x)
}</script></div>

<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-41" role="math" style="width: 1.188em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1001.03em, 2.697em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-42"><span class="msubsup" id="MathJax-Span-43"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>π</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">\pi_k</script> は <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-46" role="math" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">k</script> 番目の確率モデルの重みとなります．<br>
確率モデルとして正規分布を用いたものを <strong>混合正規分布モデル</strong> と呼びます．</p>

<h2>
<span id="混合正規分布モデル" class="fragment"></span><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%83%A2%E3%83%87%E3%83%AB"><i class="fa fa-link"></i></a>混合正規分布モデル</h2>

<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-49" role="math" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-50"><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">k</script> 番目のクラスタを表す <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-52" role="math" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-53"><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">d</script> 次元正規分布関数を以下のように表します．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-55" role="math" style="width: 32.438em; display: inline-block;"><span style="display: inline-block; position: relative; width: 27.966em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.973em, 1027.8em, 3.882em, -999.997em); top: -2.476em; left: 0.003em;"><span class="mrow" id="MathJax-Span-56"><span class="texatom" id="MathJax-Span-57"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-62" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-63"><span class="mrow" id="MathJax-Span-64"><span class="mo" id="MathJax-Span-65" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-66" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-67"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-69" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-71" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-76" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 6.36em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-77" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.804em, 1006.2em, 4.421em, -999.997em); top: -3.015em; left: 50%; margin-left: -3.122em;"><span class="mrow" id="MathJax-Span-78"><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-80" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-82"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.254em; left: 0.38em;"><span class="texatom" id="MathJax-Span-84"><span class="mrow" id="MathJax-Span-85"><span class="mn" id="MathJax-Span-86" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-87"><span class="mrow" id="MathJax-Span-88"><span class="mo" id="MathJax-Span-89" style="font-size: 70.7%; font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mtext" id="MathJax-Span-91" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-92"><span class="mrow" id="MathJax-Span-93"><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-95"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-96" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-97" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-98"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.16em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="texatom" id="MathJax-Span-99"><span class="mrow" id="MathJax-Span-100"><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.469em; left: 0.272em;"><span class="texatom" id="MathJax-Span-102"><span class="mrow" id="MathJax-Span-103"><span class="mn" id="MathJax-Span-104" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-105"><span class="mrow" id="MathJax-Span-106"><span class="mo" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-108" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1006.36em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 6.36em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Main;">exp</span><span class="mo" id="MathJax-Span-110"></span><span class="texatom" id="MathJax-Span-111" style=""><span class="mrow" id="MathJax-Span-112"><span class="mo" id="MathJax-Span-113" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-115"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-116" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-117" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.65em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.649em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-121" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-123" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-124"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="mi" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-127"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.97em, 4.151em, -999.997em); top: -4.308em; left: 0.811em;"><span class="texatom" id="MathJax-Span-129"><span class="mrow" id="MathJax-Span-130"><span class="mo" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.43em, 4.151em, -999.997em); top: -3.661em; left: 0.811em;"><span class="mi" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-137" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-139" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-140" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-141" style=""><span class="mrow" id="MathJax-Span-142"><span class="mo" id="MathJax-Span-143" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.481em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.497em; border-left: 0px solid; width: 0px; height: 3.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi></mrow></msup><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></mrow></msup></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>−</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msubsup><mi mathvariant="bold">Σ</mi><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>−</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-9">{N(\boldsymbol x \ | \ \boldsymbol \mu_k, \boldsymbol \Sigma_k) = \frac{1}{(2\pi)^{1/d} \ |\boldsymbol \Sigma_k|^{1/2}}\exp\bigl(-\frac{1}{2}(\boldsymbol x - \boldsymbol \mu_k)^T \boldsymbol \Sigma_k^{-1}(\boldsymbol x - \boldsymbol \mu_k)\bigr)
}</script></div>

<p>全体の分布は，これらの線形和として表されます．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-144" role="math" style="width: 26.188em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.578em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.488em, 1022.52em, 3.774em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-145"><span class="texatom" id="MathJax-Span-146"><span class="mrow" id="MathJax-Span-147"><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-153" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.38em, 4.259em, -999.997em); top: -2.853em; left: 0.541em;"><span class="mi" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-157" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-159" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-163" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-164"><span class="mrow" id="MathJax-Span-165"><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-167" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-168"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-170" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-171" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-172" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-174" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-175" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-176" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-177" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mn" id="MathJax-Span-178" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main; padding-left: 0.272em;">≤</span><span class="msubsup" id="MathJax-Span-180" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-182" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-183" style="font-family: MathJax_Main; padding-left: 0.272em;">≤</span><span class="mn" id="MathJax-Span-184" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-185" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-186" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="munderover" id="MathJax-Span-187" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-188" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-189"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-193" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-194" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-195" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-199" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.497em; border-left: 0px solid; width: 0px; height: 3.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mi>k</mi><mi>K</mi></munderover><msub><mi>π</mi><mi>k</mi></msub><mi>N</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>,</mo><mtext>&nbsp;</mtext><mn>0</mn><mo>≤</mo><msub><mi>π</mi><mi>k</mi></msub><mo>≤</mo><mn>1</mn><mo>,</mo><mtext>&nbsp;</mtext><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>π</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">{p(\boldsymbol x) = \sum_k^K \pi_k N(\boldsymbol x \ | \ \boldsymbol \mu_k, \boldsymbol \Sigma_k), \ 0 \leq \pi_k \leq 1, \ \sum_{k = 1}^K \pi_k = 1
}</script></div>

<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-200" role="math" style="width: 1.188em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1001.03em, 2.697em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-201"><span class="msubsup" id="MathJax-Span-202"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>π</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-11">\pi_k</script> を混合比と呼び，混合正規分布モデルのパラメータは以下になります．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-205" role="math" style="width: 28.02em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.141em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1024.03em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-206"><span class="texatom" id="MathJax-Span-207"><span class="mrow" id="MathJax-Span-208"><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math-bold-italic;">π</span><span class="mo" id="MathJax-Span-210" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-211" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="msubsup" id="MathJax-Span-212"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mn" id="MathJax-Span-214" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-219" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-220" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-224" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-225" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math-bold-italic;">μ</span><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="msubsup" id="MathJax-Span-229"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mn" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-237" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-239" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-241" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-242" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Main-bold;">Σ</span><span class="mo" id="MathJax-Span-244" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="msubsup" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mn" id="MathJax-Span-248" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-249" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-251" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-254" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-255" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-256" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-257" style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">π</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>π</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>π</mi><mi>K</mi></msub><mo stretchy="false">)</mo><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">μ</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">μ</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>K</mi></msub><mo stretchy="false">)</mo><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold">Σ</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi mathvariant="bold">Σ</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>K</mi></msub><mo stretchy="false">)</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">{\boldsymbol \pi = (\pi_1, ..., \pi_K), \ \boldsymbol \mu = (\boldsymbol \mu_1, ..., \boldsymbol \mu_K), \ \boldsymbol \Sigma = (\boldsymbol \Sigma_1, ..., \boldsymbol \Sigma_K)
}</script></div>

<p>全体のデータをうまく表現できるような <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-258" role="math" style="width: 4.205em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.613em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1003.56em, 2.751em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-259"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-bold-italic;">π</span><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-262" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Math-bold-italic;">μ</span><span class="mo" id="MathJax-Span-264" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-265" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Main-bold;">Σ</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">π</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">μ</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold">Σ</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">\boldsymbol \pi, \ \boldsymbol \mu, \ \boldsymbol \Sigma</script> が必要となります．<br>
しかし，各データがどのクラスタに属するかは不明であるため，各パラメータを直接求めることはできません．</p>

<h2>
<span id="隠れ変数と事後確率" class="fragment"></span><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E9%9A%A0%E3%82%8C%E5%A4%89%E6%95%B0%E3%81%A8%E4%BA%8B%E5%BE%8C%E7%A2%BA%E7%8E%87"><i class="fa fa-link"></i></a>隠れ変数と事後確率</h2>

<p>混合正規分布モデルでは，全体のデータから <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-267" role="math" style="width: 4.205em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.613em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1003.56em, 2.751em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-268"><span class="mi" id="MathJax-Span-269" style="font-family: MathJax_Math-bold-italic;">π</span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-271" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Math-bold-italic;">μ</span><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-274" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-275" style="font-family: MathJax_Main-bold;">Σ</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">π</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">μ</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold">Σ</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">\boldsymbol \pi, \ \boldsymbol \mu, \ \boldsymbol \Sigma</script> を推定するために，<br>
各データ <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-276" role="math" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-277"><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">x</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">\boldsymbol x</script> がどのクラスタに属するかを表す <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-279" role="math" style="width: 1.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.92em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-280"><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">K</script> 次元の隠れ変数 <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-282" role="math" style="width: 8.785em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.546em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.35em, 1007.55em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-283"><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="msubsup" id="MathJax-Span-287"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mn" id="MathJax-Span-289" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-292" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-293" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-295" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.188em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-297" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-298"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-299" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.38em;"><span class="mi" id="MathJax-Span-300" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">z</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>z</mi><mi>K</mi></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-17">\boldsymbol z = (z_1, ..., z_K)^T</script> を導入します．<br>
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-301" role="math" style="width: 1.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.92em, 2.697em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-302"><span class="msubsup" id="MathJax-Span-303"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-305" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-18">z_k</script> は，データが <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-306" role="math" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-307"><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">k</script> 番目のクラスタに属していれば <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-309" role="math" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-310"><span class="mn" id="MathJax-Span-311" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-20">1</script>，属していなければ <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-312" role="math" style="width: 0.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1000.43em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-313"><span class="mn" id="MathJax-Span-314" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-21">0</script> をとります．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-315" role="math" style="width: 18.699em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.113em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.488em, 1016.11em, 3.774em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-316"><span class="texatom" id="MathJax-Span-317"><span class="mrow" id="MathJax-Span-318"><span class="munderover" id="MathJax-Span-319"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-320" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-321"><span class="mrow" id="MathJax-Span-322"><span class="mi" id="MathJax-Span-323" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-324" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-325" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-326" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-327" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-329" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-330" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-331" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-332" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-333" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-335" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-336" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="mn" id="MathJax-Span-337" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-339" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-341" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-342" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="mn" id="MathJax-Span-343" style="font-family: MathJax_Main; padding-left: 0.164em;">0</span><span class="mo" id="MathJax-Span-344" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-345" style="font-family: MathJax_Main; padding-left: 0.164em;">1</span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-347" style="font-family: MathJax_Main; padding-left: 0.164em;">0</span><span class="mo" id="MathJax-Span-348" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-349" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-350" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="mn" id="MathJax-Span-353" style="font-family: MathJax_Main; padding-left: 0.164em;">0</span><span class="msubsup" id="MathJax-Span-354"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="mi" id="MathJax-Span-356" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.497em; border-left: 0px solid; width: 0px; height: 3.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>z</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">z</mi><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mn>0</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-22">{\sum_{k = 1}^K z_k = 1, \ \boldsymbol z = (0, ..., 0, 1, 0, ..., 0)^T
}</script></div>

<p>観測される <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-357" role="math" style="width: 0.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.6em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-358"><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math-bold-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">x</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">\boldsymbol x</script> と 隠れ変数 <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-360" role="math" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-361"><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Math-bold-italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">z</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">\boldsymbol z</script> の同時分布 <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-363" role="math" style="width: 3.451em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.966em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1002.86em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-364"><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-366" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">z</span><span class="mo" id="MathJax-Span-370" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>,</mo><mi mathvariant="bold-italic">z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-25">p(\boldsymbol x, \boldsymbol z)</script>  は以下になります．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-371" role="math" style="width: 10.886em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.378em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1009.27em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-372"><span class="texatom" id="MathJax-Span-373"><span class="mrow" id="MathJax-Span-374"><span class="mi" id="MathJax-Span-375" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-376" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-377" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-378" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-379" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">z</span><span class="mo" id="MathJax-Span-380" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-381" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-382" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">p</span><span class="mo" id="MathJax-Span-383" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-384" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-385" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-386" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-387" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-389" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-390"><span class="mrow" id="MathJax-Span-391"><span class="mo" id="MathJax-Span-392" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-393" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-394" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-395" style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>,</mo><mi mathvariant="bold-italic">z</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">z</mi><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">z</mi><mo stretchy="false">)</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-26">{p(\boldsymbol x, \boldsymbol z) = p(\boldsymbol z)p(\boldsymbol x \ | \ \boldsymbol z)
}</script></div>

<p>また，隠れ変数の分布 <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-396" role="math" style="width: 2.158em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.73em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-397"><span class="mi" id="MathJax-Span-398" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-399" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-401" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-27">p(\boldsymbol z)</script> および観測データの隠れ変数による条件付き分布 <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-402" role="math" style="width: 3.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.289em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.18em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-403"><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-407" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-408"><span class="mrow" id="MathJax-Span-409"><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-411" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-412" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-413" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-28">p(\boldsymbol x \ | \ \boldsymbol z)</script> は以下のように表せます．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-414" role="math" style="width: 16.166em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.904em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(-1.129em, 1013.74em, 5.391em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-415"><span class="texatom" id="MathJax-Span-416"><span class="mrow" id="MathJax-Span-417"><span class="mtable" id="MathJax-Span-418" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 13.58em; height: 0px;"><span style="position: absolute; clip: rect(2.481em, 1000em, 6.037em, -999.997em); top: -4.254em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.003em; height: 0px;"><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -5.601em; right: 0.003em;"><span class="mtd" id="MathJax-Span-419"><span class="mrow" id="MathJax-Span-420"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -2.368em; right: 0.003em;"><span class="mtd" id="MathJax-Span-444"><span class="mrow" id="MathJax-Span-445"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.259em;"></span></span><span style="position: absolute; clip: rect(3.72em, 1013.58em, 10.24em, -999.997em); top: -7.217em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 13.58em; height: 0px;"><span style="position: absolute; clip: rect(2.104em, 1005.93em, 5.391em, -999.997em); top: -5.601em; left: 0.003em;"><span class="mtd" id="MathJax-Span-421"><span class="mrow" id="MathJax-Span-422"><span class="mi" id="MathJax-Span-423" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-424" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-426" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-428" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.24em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-429" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∏</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.003em;"><span class="texatom" id="MathJax-Span-430"><span class="mrow" id="MathJax-Span-431"><span class="mi" id="MathJax-Span-432" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-433" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-434" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.326em;"><span class="mi" id="MathJax-Span-435" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-436" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.7em, 4.259em, -999.997em); top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-438"><span class="mrow" id="MathJax-Span-439"><span class="msubsup" id="MathJax-Span-440"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-441" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="mi" id="MathJax-Span-442" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.43em, 4.151em, -999.997em); top: -3.661em; left: 0.595em;"><span class="mi" id="MathJax-Span-443" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.104em, 1013.58em, 5.391em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mtd" id="MathJax-Span-446"><span class="mrow" id="MathJax-Span-447"><span class="mi" id="MathJax-Span-448" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-451" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="mo" id="MathJax-Span-454" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-455" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-457" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-458" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-459" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.24em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-460" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∏</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.003em;"><span class="texatom" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="mi" id="MathJax-Span-463" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-464" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-465" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.326em;"><span class="mi" id="MathJax-Span-466" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-467" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-468"><span class="mo" id="MathJax-Span-469" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">[</span></span></span></span><span class="mi" id="MathJax-Span-470" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-471" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-473" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-474"><span class="mrow" id="MathJax-Span-475"><span class="mo" id="MathJax-Span-476" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-477" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-478"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-480" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-481" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-482" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-483" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-484" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-486" style=""><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1000.22em, 4.475em, -999.997em); top: -3.984em; left: 0.003em;"><span class="texatom" id="MathJax-Span-487" style=""><span class="mrow" id="MathJax-Span-488"><span class="mo" id="MathJax-Span-489" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.577em; left: 0.434em;"><span class="texatom" id="MathJax-Span-490"><span class="mrow" id="MathJax-Span-491"><span class="msubsup" id="MathJax-Span-492"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-493" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="mi" id="MathJax-Span-494" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.223em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.372em; border-left: 0px solid; width: 0px; height: 7.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd></mtd><mtd><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">z</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msubsup><mi>π</mi><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mi>k</mi></msub></mrow></msubsup></mtd></mtr><mtr><mtd></mtd><mtd><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">z</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.2em" minsize="1.2em">[</mo></mrow><mi>N</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><msup><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mi>k</mi></msub></mrow></msup></mtd></mtr></mtable></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-29">{\begin{align}
& p(\boldsymbol z) = \prod_{k = 1}^K \pi_k^{z_k} \\
& p(\boldsymbol x \ | \ \boldsymbol z) = \prod_{k = 1}^K \big[N(\boldsymbol x \ | \ \boldsymbol \mu_k, \boldsymbol \Sigma_k)\bigr]^{z_k}
\end{align}
}</script></div>

<p>さらに，同時分布 <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-495" role="math" style="width: 3.451em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.966em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1002.86em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-496"><span class="mi" id="MathJax-Span-497" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-498" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-500" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">z</span><span class="mo" id="MathJax-Span-502" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>,</mo><mi mathvariant="bold-italic">z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-30">p(\boldsymbol x, \boldsymbol z)</script> をすべての <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-503" role="math" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.781em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-bold-italic;">z</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">z</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">\boldsymbol z</script> について加えることで，<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-506" role="math" style="width: 2.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1001.84em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-507"><span class="mi" id="MathJax-Span-508" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-509" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-32">p(\boldsymbol x)</script> を求めることができます．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mstyle scriptlevel=&quot;1&quot;&gt;&lt;mtable rowspacing=&quot;0.1em&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mstyle scriptlevel=&quot;1&quot;&gt;&lt;mtable rowspacing=&quot;0.1em&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mstyle scriptlevel=&quot;1&quot;&gt;&lt;mtable rowspacing=&quot;0.1em&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-512" role="math" style="width: 23.71em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.423em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(-5.655em, 1020.26em, 9.916em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-513"><span class="texatom" id="MathJax-Span-514"><span class="mrow" id="MathJax-Span-515"><span class="mtable" id="MathJax-Span-516" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 20.1em; height: 0px;"><span style="position: absolute; clip: rect(7.007em, 1001.84em, 20.369em, -999.997em); top: -14.06em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 1.942em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1001.84em, 4.421em, -999.997em); top: -10.127em; right: 0.003em;"><span class="mtd" id="MathJax-Span-517"><span class="mrow" id="MathJax-Span-518"><span class="mi" id="MathJax-Span-519" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-520" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-521" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-522" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -6.032em; right: 0.003em;"><span class="mtd" id="MathJax-Span-565"><span class="mrow" id="MathJax-Span-566"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -1.937em; right: 0.003em;"><span class="mtd" id="MathJax-Span-617"><span class="mrow" id="MathJax-Span-618"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: 2.158em; right: 0.003em;"><span class="mtd" id="MathJax-Span-707"><span class="mrow" id="MathJax-Span-708"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 14.065em;"></span></span><span style="position: absolute; clip: rect(8.246em, 1018.16em, 23.817em, -999.997em); top: -16.269em; left: 1.942em;"><span style="display: inline-block; position: relative; width: 18.16em; height: 0px;"><span style="position: absolute; clip: rect(2.912em, 1009.11em, 7.007em, -999.997em); top: -10.935em; left: 0.003em;"><span class="mtd" id="MathJax-Span-523"><span class="mrow" id="MathJax-Span-524"><span class="mi" id="MathJax-Span-525"></span><span class="mo" id="MathJax-Span-526" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-527" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 4.744em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 1.673em;"><span class="mo" id="MathJax-Span-528" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.966em, 1004.53em, 4.744em, -999.997em); top: -2.53em; left: 0.003em;"><span class="texatom" id="MathJax-Span-529"><span class="mrow" id="MathJax-Span-530"><span class="mstyle" id="MathJax-Span-531"><span class="mrow" id="MathJax-Span-532"><span class="mtable" id="MathJax-Span-533" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 4.421em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1004.37em, 4.636em, -999.997em); top: -3.984em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 4.421em; height: 0px;"><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.151em, -999.997em); top: -4.362em; left: 50%; margin-left: -0.644em;"><span class="mtd" id="MathJax-Span-534"><span class="mrow" id="MathJax-Span-535"><span class="mi" id="MathJax-Span-536" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-537" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-538" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.289em, 1004.37em, 4.367em, -999.997em); top: -3.715em; left: 50%; margin-left: -2.206em;"><span class="mtd" id="MathJax-Span-539"><span class="mrow" id="MathJax-Span-540"><span class="mo" id="MathJax-Span-541" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-542"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-543" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="mi" id="MathJax-Span-544" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-545" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-546" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-547" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-548"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-549" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="texatom" id="MathJax-Span-550"><span class="mrow" id="MathJax-Span-551"><span class="mi" id="MathJax-Span-552" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-553" style="font-size: 50%; font-family: MathJax_Main;">≠</span><span class="mi" id="MathJax-Span-554" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-555" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-556" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-557" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 2.05em;"><span class="mi" id="MathJax-Span-558" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">p</span><span class="mo" id="MathJax-Span-560" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-561" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-563" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">z</span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.798em;"></span></span><span style="position: absolute; clip: rect(2.912em, 1011.26em, 7.007em, -999.997em); top: -6.84em; left: 0.003em;"><span class="mtd" id="MathJax-Span-567"><span class="mrow" id="MathJax-Span-568"><span class="mi" id="MathJax-Span-569"></span><span class="mo" id="MathJax-Span-570" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-571" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 4.744em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 1.673em;"><span class="mo" id="MathJax-Span-572" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.966em, 1004.53em, 4.744em, -999.997em); top: -2.53em; left: 0.003em;"><span class="texatom" id="MathJax-Span-573"><span class="mrow" id="MathJax-Span-574"><span class="mstyle" id="MathJax-Span-575"><span class="mrow" id="MathJax-Span-576"><span class="mtable" id="MathJax-Span-577" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 4.421em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1004.37em, 4.636em, -999.997em); top: -3.984em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 4.421em; height: 0px;"><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.151em, -999.997em); top: -4.362em; left: 50%; margin-left: -0.644em;"><span class="mtd" id="MathJax-Span-578"><span class="mrow" id="MathJax-Span-579"><span class="mi" id="MathJax-Span-580" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-581" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-582" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.289em, 1004.37em, 4.367em, -999.997em); top: -3.715em; left: 50%; margin-left: -2.206em;"><span class="mtd" id="MathJax-Span-583"><span class="mrow" id="MathJax-Span-584"><span class="mo" id="MathJax-Span-585" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-586"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-587" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="mi" id="MathJax-Span-588" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-589" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-590" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-591" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-592"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-593" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="texatom" id="MathJax-Span-594"><span class="mrow" id="MathJax-Span-595"><span class="mi" id="MathJax-Span-596" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-597" style="font-size: 50%; font-family: MathJax_Main;">≠</span><span class="mi" id="MathJax-Span-598" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-599" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-600" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-601" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 2.05em;"><span class="mi" id="MathJax-Span-602" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">p</span><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-605" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-606" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-609" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-610" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-611"><span class="mrow" id="MathJax-Span-612"><span class="mo" id="MathJax-Span-613" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-614" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-615" style="font-family: MathJax_Math-bold-italic;">z</span><span class="mo" id="MathJax-Span-616" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.798em;"></span></span><span style="position: absolute; clip: rect(2.912em, 1018.16em, 7.007em, -999.997em); top: -2.745em; left: 0.003em;"><span class="mtd" id="MathJax-Span-619"><span class="mrow" id="MathJax-Span-620"><span class="mi" id="MathJax-Span-621"></span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-623" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 4.744em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 1.673em;"><span class="mo" id="MathJax-Span-624" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.966em, 1004.53em, 4.744em, -999.997em); top: -2.53em; left: 0.003em;"><span class="texatom" id="MathJax-Span-625"><span class="mrow" id="MathJax-Span-626"><span class="mstyle" id="MathJax-Span-627"><span class="mrow" id="MathJax-Span-628"><span class="mtable" id="MathJax-Span-629" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 4.421em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1004.37em, 4.636em, -999.997em); top: -3.984em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 4.421em; height: 0px;"><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.151em, -999.997em); top: -4.362em; left: 50%; margin-left: -0.644em;"><span class="mtd" id="MathJax-Span-630"><span class="mrow" id="MathJax-Span-631"><span class="mi" id="MathJax-Span-632" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-633" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-634" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.289em, 1004.37em, 4.367em, -999.997em); top: -3.715em; left: 50%; margin-left: -2.206em;"><span class="mtd" id="MathJax-Span-635"><span class="mrow" id="MathJax-Span-636"><span class="mo" id="MathJax-Span-637" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-638"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-639" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="mi" id="MathJax-Span-640" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-641" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-642" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-643" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-644"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-645" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="texatom" id="MathJax-Span-646"><span class="mrow" id="MathJax-Span-647"><span class="mi" id="MathJax-Span-648" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-649" style="font-size: 50%; font-family: MathJax_Main;">≠</span><span class="mi" id="MathJax-Span-650" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-651" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-652" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-653" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 2.05em;"><span class="mi" id="MathJax-Span-654" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-655" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.24em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-656" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∏</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.003em;"><span class="texatom" id="MathJax-Span-657"><span class="mrow" id="MathJax-Span-658"><span class="mi" id="MathJax-Span-659" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-660" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-661" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.326em;"><span class="mi" id="MathJax-Span-662" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-663" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-664" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.7em, 4.259em, -999.997em); top: -4.415em; left: 0.649em;"><span class="texatom" id="MathJax-Span-665"><span class="mrow" id="MathJax-Span-666"><span class="msubsup" id="MathJax-Span-667"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-668" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="mi" id="MathJax-Span-669" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.43em, 4.151em, -999.997em); top: -3.661em; left: 0.595em;"><span class="mi" id="MathJax-Span-670" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-671" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.24em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-672" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∏</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.003em;"><span class="texatom" id="MathJax-Span-673"><span class="mrow" id="MathJax-Span-674"><span class="mi" id="MathJax-Span-675" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-676" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-677" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.326em;"><span class="mi" id="MathJax-Span-678" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-679" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-680"><span class="mo" id="MathJax-Span-681" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">[</span></span></span></span><span class="mi" id="MathJax-Span-682" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-683" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-684" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-685" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-686"><span class="mrow" id="MathJax-Span-687"><span class="mo" id="MathJax-Span-688" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-689" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-690"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-691" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-692" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-693" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-694" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-695" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-696" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-697" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-698" style=""><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1000.22em, 4.475em, -999.997em); top: -3.984em; left: 0.003em;"><span class="texatom" id="MathJax-Span-699" style=""><span class="mrow" id="MathJax-Span-700"><span class="mo" id="MathJax-Span-701" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.577em; left: 0.434em;"><span class="texatom" id="MathJax-Span-702"><span class="mrow" id="MathJax-Span-703"><span class="msubsup" id="MathJax-Span-704"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-705" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="mi" id="MathJax-Span-706" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.798em;"></span></span><span style="position: absolute; clip: rect(2.104em, 1009.81em, 5.391em, -999.997em); top: 2.158em; left: 0.003em;"><span class="mtd" id="MathJax-Span-709"><span class="mrow" id="MathJax-Span-710"><span class="mi" id="MathJax-Span-711"></span><span class="mo" id="MathJax-Span-712" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-713" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-714" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-715"><span class="mrow" id="MathJax-Span-716"><span class="mi" id="MathJax-Span-717" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-718" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-719" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-720" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-721" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-722" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-723" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-724" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-725" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-726" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-727" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-728"><span class="mrow" id="MathJax-Span-729"><span class="mo" id="MathJax-Span-730" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-731" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-732"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-733" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-734" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-736" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-737" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-738" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-739" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 16.274em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -8.622em; border-left: 0px solid; width: 0px; height: 17.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mstyle scriptlevel="1"><mtable rowspacing="0.1em" columnspacing="0em" displaystyle="false"><mtr><mtd><mi>k</mi><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>≠</mo><mi>k</mi></mrow></msub><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo></mtd></mtr></mtable></mstyle></mrow><mi>K</mi></munderover><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>,</mo><mi mathvariant="bold-italic">z</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mstyle scriptlevel="1"><mtable rowspacing="0.1em" columnspacing="0em" displaystyle="false"><mtr><mtd><mi>k</mi><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>≠</mo><mi>k</mi></mrow></msub><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo></mtd></mtr></mtable></mstyle></mrow><mi>K</mi></munderover><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">z</mi><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">z</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mstyle scriptlevel="1"><mtable rowspacing="0.1em" columnspacing="0em" displaystyle="false"><mtr><mtd><mi>k</mi><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>≠</mo><mi>k</mi></mrow></msub><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo></mtd></mtr></mtable></mstyle></mrow><mi>K</mi></munderover><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msubsup><mi>π</mi><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mi>k</mi></msub></mrow></msubsup><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.2em" minsize="1.2em">[</mo></mrow><mi>N</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><msup><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mi>k</mi></msub></mrow></msup></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>π</mi><mi>k</mi></msub><mi>N</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-33">{\begin{align}
p(\boldsymbol x) &= \sum_{\substack{k = 1 \\ (z_k = 1, z_{j \neq k} = 0)}}^K p(\boldsymbol x, \boldsymbol z) \\
&= \sum_{\substack{k = 1 \\ (z_k = 1, z_{j \neq k} = 0)}}^K p(\boldsymbol z)p(\boldsymbol x \ | \ \boldsymbol z) \\
&= \sum_{\substack{k = 1 \\ (z_k = 1, z_{j \neq k} = 0)}}^K \prod_{k = 1}^K \pi_k^{z_k} \prod_{k = 1}^K \big[N(\boldsymbol x \ | \ \boldsymbol \mu_k, \boldsymbol \Sigma_k)\bigr]^{z_k} \\
&= \sum_{k = 1}^K \pi_kN(\boldsymbol x \ | \ \boldsymbol \mu_k, \boldsymbol \Sigma_k)
\end{align}
}</script></div>

<p>以上の分布を用いると，隠れ変数の事後確率 <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-740" role="math" style="width: 2.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.212em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1002.1em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-741"><span class="mi" id="MathJax-Span-742" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-743" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-744"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-745" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-746" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-747" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-34">\gamma(z_k)</script> は以下のように表されます．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="width: 100%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-*&quot;&gt;&lt;mtext&gt;(*)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-748" role="math" style="width: 100%; display: inline-block; min-width: 19.884em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%; min-width: 19.884em;"><span style="position: absolute; clip: rect(5.552em, 1015.74em, 15.789em, -999.997em); top: -10.935em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-749"><span class="texatom" id="MathJax-Span-750"><span class="mrow" id="MathJax-Span-751"><span class="mtable" id="MathJax-Span-752" style="min-width: 19.884em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.884em;"><span style="display: inline-block; position: absolute; width: 15.735em; height: 0px; clip: rect(-5.385em, 1015.74em, 4.852em, -999.997em); top: 0.003em; left: 50%; margin-left: -7.864em;"><span style="position: absolute; clip: rect(4.205em, 1002.16em, 13.041em, -999.997em); top: -9.534em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 2.212em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1002.16em, 4.421em, -999.997em); top: -8.402em; right: 0.003em;"><span class="mtd" id="MathJax-Span-753"><span class="mrow" id="MathJax-Span-754"><span class="mi" id="MathJax-Span-755" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-756" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-757"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-758" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-759" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-760" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -7.055em; right: 0.003em;"><span class="mtd" id="MathJax-Span-779"><span class="mrow" id="MathJax-Span-780"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -5.062em; right: 0.003em;"><span class="mtd" id="MathJax-Span-783"><span class="mrow" id="MathJax-Span-784"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -2.584em; right: 0.003em;"><span class="mtd" id="MathJax-Span-844"><span class="mrow" id="MathJax-Span-845"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -0.644em; right: 0.003em;"><span class="mtd" id="MathJax-Span-851"><span class="mrow" id="MathJax-Span-852"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.539em;"></span></span><span style="position: absolute; clip: rect(5.552em, 1013.47em, 15.735em, -999.997em); top: -10.881em; left: 2.212em;"><span style="display: inline-block; position: relative; width: 13.473em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1006.68em, 4.421em, -999.997em); top: -8.402em; left: 0.003em;"><span class="mtd" id="MathJax-Span-761"><span class="mrow" id="MathJax-Span-762"><span class="mi" id="MathJax-Span-763"></span><span class="mo" id="MathJax-Span-764" style="font-family: MathJax_Main; padding-left: 0.272em;">≡</span><span class="mi" id="MathJax-Span-765" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">p</span><span class="mo" id="MathJax-Span-766" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-767"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-768" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-769" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-770" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-771" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mtext" id="MathJax-Span-772" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-773"><span class="mrow" id="MathJax-Span-774"><span class="mo" id="MathJax-Span-775" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-776" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-777" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mo" id="MathJax-Span-778" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -7.055em; left: 0.003em;"><span class="mtd" id="MathJax-Span-781"><span class="mrow" id="MathJax-Span-782"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.373em, 1013.47em, 5.498em, -999.997em); top: -5.062em; left: 0.003em;"><span class="mtd" id="MathJax-Span-785"><span class="mrow" id="MathJax-Span-786"><span class="mi" id="MathJax-Span-787"></span><span class="mo" id="MathJax-Span-788" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-789" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 11.91em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1009.38em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -4.739em;"><span class="mrow" id="MathJax-Span-790"><span class="mi" id="MathJax-Span-791" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-792" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-793"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-794" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-795" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-796" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-797" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-798" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-800" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-801" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-802" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-803"><span class="mrow" id="MathJax-Span-804"><span class="mo" id="MathJax-Span-805" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-806" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-807"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-808" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-809" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-810" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-811" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-812" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.858em, 1011.7em, 4.582em, -999.997em); top: -3.068em; left: 50%; margin-left: -5.87em;"><span class="mrow" id="MathJax-Span-813"><span class="munderover" id="MathJax-Span-814"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1001.03em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-815" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.7em, 4.151em, -999.997em); top: -4.469em; left: 1.08em;"><span class="mi" id="MathJax-Span-816" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.3em, 4.313em, -999.997em); top: -3.715em; left: 1.08em;"><span class="texatom" id="MathJax-Span-817"><span class="mrow" id="MathJax-Span-818"><span class="mi" id="MathJax-Span-819" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-820" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-821" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-822" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">p</span><span class="mo" id="MathJax-Span-823" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-824"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-825" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-826" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-827" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-828" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-829" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-830" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-833" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-834"><span class="mrow" id="MathJax-Span-835"><span class="mo" id="MathJax-Span-836" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-837" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-838"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-839" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="mi" id="MathJax-Span-840" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-841" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-842" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-843" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1011.91em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 11.91em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -2.584em; left: 0.003em;"><span class="mtd" id="MathJax-Span-846"><span class="mrow" id="MathJax-Span-847"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.373em, 1010.94em, 5.498em, -999.997em); top: -0.644em; left: 0.003em;"><span class="mtd" id="MathJax-Span-853"><span class="mrow" id="MathJax-Span-854"><span class="mi" id="MathJax-Span-855"></span><span class="mo" id="MathJax-Span-856" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-857" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 9.378em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1006.9em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -3.499em;"><span class="mrow" id="MathJax-Span-858"><span class="msubsup" id="MathJax-Span-859"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-860" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-861" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-862" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-863" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-864" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-865" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-866"><span class="mrow" id="MathJax-Span-867"><span class="mo" id="MathJax-Span-868" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-869" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-870"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-871" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-872" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-873" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-874" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-875" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-876" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-877" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.858em, 1009.16em, 4.582em, -999.997em); top: -3.068em; left: 50%; margin-left: -4.631em;"><span class="mrow" id="MathJax-Span-878"><span class="munderover" id="MathJax-Span-879"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1001.03em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-880" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.7em, 4.151em, -999.997em); top: -4.469em; left: 1.08em;"><span class="mi" id="MathJax-Span-881" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.3em, 4.313em, -999.997em); top: -3.715em; left: 1.08em;"><span class="texatom" id="MathJax-Span-882"><span class="mrow" id="MathJax-Span-883"><span class="mi" id="MathJax-Span-884" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-885" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-886" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-887" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-888" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-889" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-890" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-891" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-892" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-893" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-894"><span class="mrow" id="MathJax-Span-895"><span class="mo" id="MathJax-Span-896" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-897" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-898"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-899" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-900" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-901" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-902" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.188em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-903" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-904" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-905" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1009.38em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 9.378em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.886em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.296em; height: 0px; clip: rect(2.427em, 1001.19em, 3.774em, -999.997em); top: 0.003em; right: 0.003em; margin-right: 0.003em;"><span style="position: absolute; clip: rect(3.074em, 1001.19em, 4.421em, -999.997em); top: -0.644em; right: 0.003em;"><span class="mtd" id="mjx-eqn-*"><span class="mrow" id="MathJax-Span-849"><span class="mtext" id="MathJax-Span-850" style="font-family: MathJax_Main;">(*)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 10.94em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.497em; border-left: 0px solid; width: 0px; height: 11.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>≡</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi>z</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>p</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi>z</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mlabeledtr><mtd id="mjx-eqn-*"><mtext>(*)</mtext></mtd><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mi>k</mi></msub><mi>N</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>π</mi><mi>j</mi></msub><mi>N</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>j</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mtd></mlabeledtr></mtable></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-35">{\begin{align}
\gamma(z_k) &\equiv p(z_k = 1 \ | \ \boldsymbol x) \\
&\\
&= \frac{p(z_k = 1)p(\boldsymbol x \ | \ z_k = 1)}{\sum_{j = 1}^K p(z_j = 1)p(\boldsymbol x \ | \ z_j = 1)} \\
&\\
&= \frac{\pi_kN(\boldsymbol x \ | \ \boldsymbol \mu_k, \boldsymbol \Sigma_k)}{\sum_{j = 1}^K \pi_jN(\boldsymbol x \ | \ \boldsymbol \mu_j, \boldsymbol \Sigma_j)} \tag{*}
\end{align}
}</script></div>

<h2>
<span id="対数尤度とq関数" class="fragment"></span><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E5%AF%BE%E6%95%B0%E5%B0%A4%E5%BA%A6%E3%81%A8q%E9%96%A2%E6%95%B0"><i class="fa fa-link"></i></a>対数尤度とQ関数</h2>

<p>観測データ <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-906" role="math" style="width: 1.134em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.97em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-907"><span class="mi" id="MathJax-Span-908" style="font-family: MathJax_Math-bold-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">X</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">\boldsymbol X</script> および隠れ変数 <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-909" role="math" style="width: 0.973em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.81em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-910"><span class="mi" id="MathJax-Span-911" style="font-family: MathJax_Math-bold-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">Z</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">\boldsymbol Z</script> を以下のように表します．<br>
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-912" role="math" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1001.13em, 2.697em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-913"><span class="msubsup" id="MathJax-Span-914"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-915" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-916" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-38">C_k</script> は，クラスタ <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-917" role="math" style="width: 0.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.541em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.54em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-918"><span class="mi" id="MathJax-Span-919" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">k</script> を表します．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;X&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2209;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-920" role="math" style="width: 19.83em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.082em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(-0.698em, 1016.92em, 4.906em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-921"><span class="texatom" id="MathJax-Span-922"><span class="mrow" id="MathJax-Span-923"><span class="mtable" id="MathJax-Span-924" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 16.759em; height: 0px;"><span style="position: absolute; clip: rect(2.266em, 1000em, 6.037em, -999.997em); top: -4.415em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.003em; height: 0px;"><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -5.978em; right: 0.003em;"><span class="mtd" id="MathJax-Span-925"><span class="mrow" id="MathJax-Span-926"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -4.523em; right: 0.003em;"><span class="mtd" id="MathJax-Span-971"><span class="mrow" id="MathJax-Span-972"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -2.53em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1017"><span class="mrow" id="MathJax-Span-1018"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.421em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1016.76em, 8.839em, -999.997em); top: -6.301em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 16.759em; height: 0px;"><span style="position: absolute; clip: rect(2.912em, 1016.76em, 4.421em, -999.997em); top: -5.978em; left: 0.003em;"><span class="mtd" id="MathJax-Span-927"><span class="mrow" id="MathJax-Span-928"><span class="mi" id="MathJax-Span-929" style="font-family: MathJax_Math-bold-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-930" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-931" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="msubsup" id="MathJax-Span-932"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-933" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mn" id="MathJax-Span-934" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-935" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-936" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-937" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-938" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-939" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-940" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-941" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-942" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-943" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-944" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-945" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-946"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-947" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-948" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-949" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-950" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="msubsup" id="MathJax-Span-951"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-952" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-953"><span class="mrow" id="MathJax-Span-954"><span class="mi" id="MathJax-Span-955" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mn" id="MathJax-Span-956" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-957" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-958" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-959" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-960" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-961" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-962" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-963" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-964"><span class="mrow" id="MathJax-Span-965"><span class="mi" id="MathJax-Span-966" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-967" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-968"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-969" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="mi" id="MathJax-Span-970" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.912em, 1016.38em, 4.421em, -999.997em); top: -4.523em; left: 0.003em;"><span class="mtd" id="MathJax-Span-973"><span class="mrow" id="MathJax-Span-974"><span class="mi" id="MathJax-Span-975" style="font-family: MathJax_Math-bold-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-976" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-977" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="msubsup" id="MathJax-Span-978"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-979" style="font-family: MathJax_Math-bold-italic;">z</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mn" id="MathJax-Span-980" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-981" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-982" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-983" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-984" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-985" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-986" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-987" style="font-family: MathJax_Math-bold-italic;">z</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-988" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-989" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-990" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-991" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-992"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-993" style="font-family: MathJax_Math-bold-italic;">z</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-994" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-995" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-996" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="msubsup" id="MathJax-Span-997"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-998" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-999"><span class="mrow" id="MathJax-Span-1000"><span class="mi" id="MathJax-Span-1001" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mn" id="MathJax-Span-1002" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1003" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1004" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-1005" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-1006" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-1007" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-1008" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1009" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1010"><span class="mrow" id="MathJax-Span-1011"><span class="mi" id="MathJax-Span-1012" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1013" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1014"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1015" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="mi" id="MathJax-Span-1016" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.373em, 1008.35em, 5.121em, -999.997em); top: -2.53em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1019"><span class="mrow" id="MathJax-Span-1020"><span class="msubsup" id="MathJax-Span-1021"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1022" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1023"><span class="mrow" id="MathJax-Span-1024"><span class="mi" id="MathJax-Span-1025" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1026" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1027" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mrow" id="MathJax-Span-1028" style="padding-left: 0.272em;"><span class="mo" id="MathJax-Span-1029" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size3;">{</span></span><span class="mtable" id="MathJax-Span-1030" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 4.798em; height: 0px;"><span style="position: absolute; clip: rect(2.481em, 1004.69em, 5.067em, -999.997em); top: -3.984em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 4.798em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1004.69em, 4.421em, -999.997em); top: -4.577em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1031"><span class="mrow" id="MathJax-Span-1032"><span class="mn" id="MathJax-Span-1033" style="font-family: MathJax_Main;">1</span><span class="mtext" id="MathJax-Span-1034" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-1035" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1036"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1037" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1038" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1039" style="font-family: MathJax_Main; padding-left: 0.272em;">∈</span><span class="msubsup" id="MathJax-Span-1040" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1041" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-1042" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1043" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1004.69em, 4.421em, -999.997em); top: -3.338em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1044"><span class="mrow" id="MathJax-Span-1045"><span class="mn" id="MathJax-Span-1046" style="font-family: MathJax_Main;">0</span><span class="mtext" id="MathJax-Span-1047" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-1048" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1049"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1050" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1051" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1052" style="font-family: MathJax_Main; padding-left: 0.272em;">∉</span><span class="msubsup" id="MathJax-Span-1053" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1054" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-1055" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1056" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1057"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.307em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.809em; border-left: 0px solid; width: 0px; height: 6.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd></mtd><mtd><mi mathvariant="bold-italic">X</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi mathvariant="bold-italic">x</mi><mi>N</mi></msub><mo stretchy="false">)</mo><mo>,</mo><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>d</mi></mrow></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mtd></mtr><mtr><mtd></mtd><mtd><mi mathvariant="bold-italic">Z</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">z</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi mathvariant="bold-italic">z</mi><mi>N</mi></msub><mo stretchy="false">)</mo><mo>,</mo><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">z</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>K</mi></mrow></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mtd></mtr><mtr><mtd></mtd><mtd><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mn>1</mn><mtext>&nbsp;</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mn>0</mn><mtext>&nbsp;</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>∉</mo><msub><mi>C</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mtd></mtr></mtable><mo fence="true" stretchy="true"></mo></mrow></mtd></mtr></mtable></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-40">{\begin{align}
& \boldsymbol X = (\boldsymbol x_1, ..., \boldsymbol x_N), \ \boldsymbol x_i = (x_{i1}, ..., x_{id})^T \\
& \boldsymbol Z = (\boldsymbol z_1, ..., \boldsymbol z_N), \ \boldsymbol z_i = (z_{i1}, ..., z_{iK})^T \\
& z_{ik} = \begin{cases}
1 \ (x_i \in C_k) \\
0 \ (x_i \notin C_k)
\end{cases}
\end{align}
}</script></div>

<p>観測データと隠れ変数を合わせた集合を完全データと呼びます．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;z&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;X&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1058" role="math" style="width: 19.507em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.813em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1016.71em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1059"><span class="texatom" id="MathJax-Span-1060"><span class="mrow" id="MathJax-Span-1061"><span class="mi" id="MathJax-Span-1062" style="font-family: MathJax_Math-bold-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span class="mo" id="MathJax-Span-1063" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-1064" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="msubsup" id="MathJax-Span-1065"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1066" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mn" id="MathJax-Span-1067" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1068" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1069" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-1070" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-1071" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-1072" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-1073" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1074" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-1075" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1076" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1077" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1078" style="font-family: MathJax_Math-bold-italic;">z</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mn" id="MathJax-Span-1079" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1080" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1081" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-1082" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-1083" style="font-family: MathJax_Main; padding-left: 0.164em;">.</span><span class="mo" id="MathJax-Span-1084" style="font-family: MathJax_Main; padding-left: 0.164em;">,</span><span class="msubsup" id="MathJax-Span-1085" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1086" style="font-family: MathJax_Math-bold-italic;">z</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.541em;"><span class="mi" id="MathJax-Span-1087" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1088" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1089" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-1090" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="mi" id="MathJax-Span-1091" style="font-family: MathJax_Math-bold-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1092" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1093" style="font-family: MathJax_Math-bold-italic; padding-left: 0.164em;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1094" style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold-italic">Y</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi mathvariant="bold-italic">x</mi><mi>N</mi></msub><mo>,</mo><msub><mi mathvariant="bold-italic">z</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi mathvariant="bold-italic">z</mi><mi>N</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">X</mi><mo>,</mo><mi mathvariant="bold-italic">Z</mi><mo stretchy="false">)</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-41">{\boldsymbol Y = (\boldsymbol x_1, ..., \boldsymbol x_N, \boldsymbol z_1, ..., \boldsymbol z_N) = (\boldsymbol X, \boldsymbol Z)
}</script></div>

<p>混合正規分布のパラメータ <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1095" role="math" style="width: 4.205em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.613em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1003.56em, 2.751em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1096"><span class="mi" id="MathJax-Span-1097" style="font-family: MathJax_Math-bold-italic;">π</span><span class="mo" id="MathJax-Span-1098" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1099" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-1100" style="font-family: MathJax_Math-bold-italic;">μ</span><span class="mo" id="MathJax-Span-1101" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1102" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-1103" style="font-family: MathJax_Main-bold;">Σ</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="bold-italic">π</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">μ</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold">Σ</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">\boldsymbol \pi, \ \boldsymbol \mu, \ \boldsymbol \Sigma</script> は，完全データの尤度を最大にするパラメータで求めることとします．<br>
完全データの尤度は以下のように表せます．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Y&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Z&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;X&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Z&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1104" role="math" style="width: 26.457em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.794em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(-0.859em, 1022.52em, 5.067em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1105"><span class="texatom" id="MathJax-Span-1106"><span class="mrow" id="MathJax-Span-1107"><span class="mtable" id="MathJax-Span-1108" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 22.47em; height: 0px;"><span style="position: absolute; clip: rect(2.158em, 1006.47em, 6.845em, -999.997em); top: -5.331em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 6.522em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1006.47em, 4.421em, -999.997em); top: -6.247em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1109"><span class="mrow" id="MathJax-Span-1110"><span class="mi" id="MathJax-Span-1111" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1112" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1113" style="font-family: MathJax_Math-bold-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span class="mtext" id="MathJax-Span-1114" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-1115"><span class="mrow" id="MathJax-Span-1116"><span class="mo" id="MathJax-Span-1117" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-1118" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-1119" style="font-family: MathJax_Math-bold-italic;">π</span><span class="mo" id="MathJax-Span-1120" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1121" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-1122" style="font-family: MathJax_Math-bold-italic;">μ</span><span class="mo" id="MathJax-Span-1123" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1124" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-1125" style="font-family: MathJax_Main-bold;">Σ</span><span class="mo" id="MathJax-Span-1126" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -4.9em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1166"><span class="mrow" id="MathJax-Span-1167"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -2.637em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1170"><span class="mrow" id="MathJax-Span-1171"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.337em;"></span></span><span style="position: absolute; clip: rect(3.397em, 1015.79em, 9.27em, -999.997em); top: -6.571em; left: 6.522em;"><span style="display: inline-block; position: relative; width: 15.897em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1015.79em, 4.421em, -999.997em); top: -6.247em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1127"><span class="mrow" id="MathJax-Span-1128"><span class="mi" id="MathJax-Span-1129"></span><span class="mo" id="MathJax-Span-1130" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-1131" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">p</span><span class="mo" id="MathJax-Span-1132" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1133" style="font-family: MathJax_Math-bold-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mtext" id="MathJax-Span-1134" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-1135"><span class="mrow" id="MathJax-Span-1136"><span class="mo" id="MathJax-Span-1137" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-1138" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-1139" style="font-family: MathJax_Math-bold-italic;">π</span><span class="mo" id="MathJax-Span-1140" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1141" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-1142" style="font-family: MathJax_Math-bold-italic;">μ</span><span class="mo" id="MathJax-Span-1143" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1144" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-1145" style="font-family: MathJax_Main-bold;">Σ</span><span class="mo" id="MathJax-Span-1146" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1147" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1148" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1149" style="font-family: MathJax_Math-bold-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-1150" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-1151"><span class="mrow" id="MathJax-Span-1152"><span class="mo" id="MathJax-Span-1153" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-1154" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-1155" style="font-family: MathJax_Math-bold-italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-1156" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1157" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-1158" style="font-family: MathJax_Math-bold-italic;">π</span><span class="mo" id="MathJax-Span-1159" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1160" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-1161" style="font-family: MathJax_Math-bold-italic;">μ</span><span class="mo" id="MathJax-Span-1162" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1163" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-1164" style="font-family: MathJax_Main-bold;">Σ</span><span class="mo" id="MathJax-Span-1165" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -4.9em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1168"><span class="mrow" id="MathJax-Span-1169"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.104em, 1013.1em, 5.391em, -999.997em); top: -2.637em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1172"><span class="mrow" id="MathJax-Span-1173"><span class="mi" id="MathJax-Span-1174"></span><span class="mo" id="MathJax-Span-1175" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-1176" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.24em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1177" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∏</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.057em;"><span class="texatom" id="MathJax-Span-1178"><span class="mrow" id="MathJax-Span-1179"><span class="mi" id="MathJax-Span-1180" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1181" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1182" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.326em;"><span class="mi" id="MathJax-Span-1183" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1184" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.24em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1185" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∏</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1186"><span class="mrow" id="MathJax-Span-1187"><span class="mi" id="MathJax-Span-1188" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1189" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1190" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.326em;"><span class="mi" id="MathJax-Span-1191" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1192" style=""><span class="mrow" id="MathJax-Span-1193"><span class="mo" id="MathJax-Span-1194" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">[</span></span></span></span><span class="msubsup" id="MathJax-Span-1195"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1196" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1197" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1198" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-1199" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1200"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1201" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-1202" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1203" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-1204"><span class="mrow" id="MathJax-Span-1205"><span class="mo" id="MathJax-Span-1206" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-1207" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1208"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1209" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-1210" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1211" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1212" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1213" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-1214" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1215" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1216" style=""><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1000.22em, 4.475em, -999.997em); top: -3.984em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1217" style=""><span class="mrow" id="MathJax-Span-1218"><span class="mo" id="MathJax-Span-1219" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.577em; left: 0.434em;"><span class="texatom" id="MathJax-Span-1220"><span class="mrow" id="MathJax-Span-1221"><span class="msubsup" id="MathJax-Span-1222"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1223" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="texatom" id="MathJax-Span-1224"><span class="mrow" id="MathJax-Span-1225"><span class="mi" id="MathJax-Span-1226" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1227" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.576em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.997em; border-left: 0px solid; width: 0px; height: 6.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">Y</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">π</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">μ</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold">Σ</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">Z</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">π</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">μ</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold">Σ</mi><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">X</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">Z</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">π</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">μ</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold">Σ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">[</mo></mrow><msub><mi>π</mi><mi>k</mi></msub><mi>N</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><msup><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">]</mo></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub></mrow></msup></mtd></mtr></mtable></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-43">{\begin{align}
p(\boldsymbol Y \ | \ \boldsymbol \pi, \ \boldsymbol \mu, \ \boldsymbol \Sigma) &= p(\boldsymbol Z \ | \ \boldsymbol \pi, \ \boldsymbol \mu, \ \boldsymbol \Sigma) p(\boldsymbol X \ | \ \boldsymbol Z, \ \boldsymbol \pi, \ \boldsymbol \mu, \ \boldsymbol \Sigma) \\
&\\
&= \prod_{i = 1}^N \prod_{k = 1}^K \bigl[\pi_kN(\boldsymbol x_i \ | \ \boldsymbol \mu_k, \boldsymbol \Sigma_k) \bigr]^{z_{ik}}
\end{align}
}</script></div>

<p>最尤推定値を求めるために対数尤度に変形します．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Y&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1228" role="math" style="width: 31.845em; display: inline-block;"><span style="display: inline-block; position: relative; width: 27.427em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(-4.846em, 1027.1em, 9.108em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1229"><span class="texatom" id="MathJax-Span-1230"><span class="mrow" id="MathJax-Span-1231"><span class="mtable" id="MathJax-Span-1232" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 27.104em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1000.65em, 12.233em, -999.997em); top: -10.073em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px;"><span style="position: absolute; clip: rect(2.912em, 1000.65em, 4.151em, -999.997em); top: -10.127em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1233"><span class="mrow" id="MathJax-Span-1234"><span class="texatom" id="MathJax-Span-1235"><span class="mrow" id="MathJax-Span-1236"><span class="munderover" id="MathJax-Span-1237"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1238" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.43em, 3.936em, -999.997em); top: -4.577em; left: 0.11em;"><span class="mo" id="MathJax-Span-1239" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -8.78em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1262"><span class="mrow" id="MathJax-Span-1263"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -6.571em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1266"><span class="mrow" id="MathJax-Span-1267"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -4.254em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1342"><span class="mrow" id="MathJax-Span-1343"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -1.991em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1346"><span class="mrow" id="MathJax-Span-1347"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.078em;"></span></span><span style="position: absolute; clip: rect(7.438em, 1026.3em, 21.231em, -999.997em); top: -14.491em; left: 0.703em;"><span style="display: inline-block; position: relative; width: 26.457em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1008.78em, 4.421em, -999.997em); top: -10.127em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1240"><span class="mrow" id="MathJax-Span-1241"><span class="mi" id="MathJax-Span-1242"></span><span class="mo" id="MathJax-Span-1243" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-1244" style="font-family: MathJax_Main; padding-left: 0.272em;">ln</span><span class="mo" id="MathJax-Span-1245"></span><span class="mi" id="MathJax-Span-1246" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">p</span><span class="mo" id="MathJax-Span-1247" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1248" style="font-family: MathJax_Math-bold-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.218em;"></span></span><span class="mtext" id="MathJax-Span-1249" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-1250"><span class="mrow" id="MathJax-Span-1251"><span class="mo" id="MathJax-Span-1252" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-1253" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-1254" style="font-family: MathJax_Math-bold-italic;">π</span><span class="mo" id="MathJax-Span-1255" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1256" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-1257" style="font-family: MathJax_Math-bold-italic;">μ</span><span class="mo" id="MathJax-Span-1258" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1259" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="mi" id="MathJax-Span-1260" style="font-family: MathJax_Main-bold;">Σ</span><span class="mo" id="MathJax-Span-1261" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -8.78em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1264"><span class="mrow" id="MathJax-Span-1265"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.104em, 1020.8em, 5.391em, -999.997em); top: -6.571em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1268"><span class="mrow" id="MathJax-Span-1269"><span class="mi" id="MathJax-Span-1270"></span><span class="mo" id="MathJax-Span-1271" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-1272" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1273" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-1274"><span class="mrow" id="MathJax-Span-1275"><span class="mi" id="MathJax-Span-1276" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1277" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1278" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1279" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1280" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1281" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-1282"><span class="mrow" id="MathJax-Span-1283"><span class="mi" id="MathJax-Span-1284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1285" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1286" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1287" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1288" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1290"><span class="mrow" id="MathJax-Span-1291"><span class="mi" id="MathJax-Span-1292" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1293" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1294" style="font-family: MathJax_Main; padding-left: 0.164em;">ln</span><span class="mo" id="MathJax-Span-1295"></span><span class="msubsup" id="MathJax-Span-1296" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1297" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1298" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1299" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="munderover" id="MathJax-Span-1300" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1301" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-1302"><span class="mrow" id="MathJax-Span-1303"><span class="mi" id="MathJax-Span-1304" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1305" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1306" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1307" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1308" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1309" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-1310"><span class="mrow" id="MathJax-Span-1311"><span class="mi" id="MathJax-Span-1312" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1313" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1314" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1315" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1316" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1317" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1318"><span class="mrow" id="MathJax-Span-1319"><span class="mi" id="MathJax-Span-1320" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1321" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1322" style="font-family: MathJax_Main; padding-left: 0.164em;">ln</span><span class="mo" id="MathJax-Span-1323"></span><span class="mi" id="MathJax-Span-1324" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-1325" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1326"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1327" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-1328" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1329" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-1330"><span class="mrow" id="MathJax-Span-1331"><span class="mo" id="MathJax-Span-1332" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-1333" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1334"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1335" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-1336" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1337" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1338" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1339" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-1340" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1341" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -4.254em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1344"><span class="mrow" id="MathJax-Span-1345"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; width: 100%; clip: rect(5.445em, 1026.3em, 12.072em, -999.997em); top: -5.331em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1348"><span class="mrow" id="MathJax-Span-1349"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.104em, 1010.46em, 5.391em, -999.997em); top: -3.984em; left: 50%; margin-left: -5.277em;"><span class="mi" id="MathJax-Span-1350"></span><span class="mo" id="MathJax-Span-1351" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-1352" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1353" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-1354"><span class="mrow" id="MathJax-Span-1355"><span class="mi" id="MathJax-Span-1356" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1357" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1358" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1359" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1360" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1361" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-1362"><span class="mrow" id="MathJax-Span-1363"><span class="mi" id="MathJax-Span-1364" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1365" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1366" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1367" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1368" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1369" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1370"><span class="mrow" id="MathJax-Span-1371"><span class="mi" id="MathJax-Span-1372" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1373" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1374" style="font-family: MathJax_Main; padding-left: 0.164em;">ln</span><span class="mo" id="MathJax-Span-1375"></span><span class="msubsup" id="MathJax-Span-1376" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1377" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1378" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1379" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="munderover" id="MathJax-Span-1380" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1381" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-1382"><span class="mrow" id="MathJax-Span-1383"><span class="mi" id="MathJax-Span-1384" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1385" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1386" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1387" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.104em, 1026.3em, 5.391em, -999.997em); top: -0.59em; left: 50%; margin-left: -13.198em;"><span class="munderover" id="MathJax-Span-1388" style=""><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1389" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-1390"><span class="mrow" id="MathJax-Span-1391"><span class="mi" id="MathJax-Span-1392" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1393" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1394" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1395" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1396" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1397" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1398"><span class="mrow" id="MathJax-Span-1399"><span class="mi" id="MathJax-Span-1400" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1401" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1402" style=""><span class="mrow" id="MathJax-Span-1403"><span class="mo" id="MathJax-Span-1404" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span><span class="mo" id="MathJax-Span-1405" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1406"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mi" id="MathJax-Span-1407" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1408" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.65em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.649em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-1409" style="font-family: MathJax_Main;">ln</span><span class="mo" id="MathJax-Span-1410"></span><span class="mo" id="MathJax-Span-1411" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1412" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-1413" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1414" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1415" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mfrac" id="MathJax-Span-1416" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1417" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1418" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.65em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.649em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-1419" style="font-family: MathJax_Main;">ln</span><span class="mo" id="MathJax-Span-1420"></span><span class="texatom" id="MathJax-Span-1421" style=""><span class="mrow" id="MathJax-Span-1422"><span class="mo" id="MathJax-Span-1423" style="vertical-align: 0.865em;"><span style="display: inline-block; position: relative; width: 0.272em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.23em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.015em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-1424"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1425" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-1426" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1427" style=""><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1000.16em, 4.475em, -999.997em); top: -3.984em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1428" style=""><span class="mrow" id="MathJax-Span-1429"><span class="mo" id="MathJax-Span-1430" style="vertical-align: 0.865em;"><span style="display: inline-block; position: relative; width: 0.272em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.23em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.015em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.577em; left: 0.272em;"><span class="texatom" id="MathJax-Span-1431"><span class="mrow" id="MathJax-Span-1432"><span class="mo" id="MathJax-Span-1433" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1434" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1435" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mfrac" id="MathJax-Span-1436" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1437" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1438" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.65em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.649em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-1439" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1440"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1441" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-1442" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1443" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-1444" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1445" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-1446" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1447"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1448" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="mi" id="MathJax-Span-1449" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1450"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1451" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.97em, 4.151em, -999.997em); top: -4.308em; left: 0.811em;"><span class="texatom" id="MathJax-Span-1452"><span class="mrow" id="MathJax-Span-1453"><span class="mo" id="MathJax-Span-1454" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1455" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.43em, 4.151em, -999.997em); top: -3.661em; left: 0.811em;"><span class="mi" id="MathJax-Span-1456" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1457" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1458"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1459" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-1460" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1461" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-1462" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1463" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-1464" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1465" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1466" style=""><span class="mrow" id="MathJax-Span-1467"><span class="mo" id="MathJax-Span-1468" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 7.33em;"></span></span></span><span style="display: inline-block; width: 0px; height: 14.496em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -7.684em; border-left: 0px solid; width: 0px; height: 15.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mover><mi>L</mi><mo stretchy="false">~</mo></mover></mrow></mtd><mtd><mi></mi><mo>=</mo><mi>ln</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">Y</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">π</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold-italic">μ</mi><mo>,</mo><mtext>&nbsp;</mtext><mi mathvariant="bold">Σ</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mi>ln</mi><mo>⁡</mo><msub><mi>π</mi><mi>k</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mi>ln</mi><mo>⁡</mo><mi>N</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mi>ln</mi><mo>⁡</mo><msub><mi>π</mi><mi>k</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow><mo>−</mo><mfrac><mi>d</mi><mn>2</mn></mfrac><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>ln</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">|</mo></mrow><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><msup><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo>−</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msubsup><mi mathvariant="bold">Σ</mi><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo>−</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow></mtd></mtr></mtable></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-44">{\begin{align}
\tilde{L} &= \ln p(\boldsymbol Y \ | \ \boldsymbol \pi, \ \boldsymbol \mu, \ \boldsymbol \Sigma) \\
&\\
&= \sum_{i = 1}^N \sum_{k = 1}^K z_{ik} \ln \pi_k + \sum_{i = 1}^N \sum_{k = 1}^K z_{ik} \ln N(\boldsymbol x_i \ | \ \boldsymbol \mu_k, \boldsymbol \Sigma_k) \\
&\\
&= \sum_{i = 1}^N \sum_{k = 1}^K z_{ik} \ln \pi_k + \sum_{i = 1}^N \sum_{k = 1}^K z_{ik} \bigl(-\frac{d}{2}\ln (2\pi) + \frac{1}{2} \ln \bigl|\boldsymbol \Sigma_k \bigr|^{-1} - \frac{1}{2}(\boldsymbol x_i - \boldsymbol \mu_k)^T \boldsymbol \Sigma_k^{-1}(\boldsymbol x_i - \boldsymbol \mu_k) \bigr)
\end{align}
}</script></div>

<p>対数尤度の隠れ変数に関する期待値をとります．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;{&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;{&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;{&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1469" role="math" style="width: 35.455em; display: inline-block;"><span style="display: inline-block; position: relative; width: 30.552em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(-2.152em, 1030.39em, 6.414em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1470"><span class="texatom" id="MathJax-Span-1471"><span class="mrow" id="MathJax-Span-1472"><span class="mtable" id="MathJax-Span-1473" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 30.229em; height: 0px;"><span style="position: absolute; clip: rect(1.08em, 1000.65em, 5.768em, -999.997em); top: -5.385em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -7.433em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1474"><span class="mrow" id="MathJax-Span-1475"><span class="mi" id="MathJax-Span-1476" style="font-family: MathJax_Math-italic;">L</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -5.978em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1495"><span class="mrow" id="MathJax-Span-1496"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -3.769em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1499"><span class="mrow" id="MathJax-Span-1500"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.391em;"></span></span><span style="position: absolute; clip: rect(4.744em, 1029.58em, 13.311em, -999.997em); top: -9.265em; left: 0.703em;"><span style="display: inline-block; position: relative; width: 29.582em; height: 0px;"><span style="position: absolute; clip: rect(2.912em, 1004.21em, 4.475em, -999.997em); top: -7.433em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1477"><span class="mrow" id="MathJax-Span-1478"><span class="mi" id="MathJax-Span-1479"></span><span class="mo" id="MathJax-Span-1480" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-1481" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1482" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.757em;"><span class="mi" id="MathJax-Span-1483" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1484" style=""><span class="mrow" id="MathJax-Span-1485"><span class="mo" id="MathJax-Span-1486" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">{</span></span></span></span><span class="texatom" id="MathJax-Span-1487"><span class="mrow" id="MathJax-Span-1488"><span class="munderover" id="MathJax-Span-1489"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1490" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.505em, 1000.43em, 3.936em, -999.997em); top: -4.577em; left: 0.11em;"><span class="mo" id="MathJax-Span-1491" style="font-family: MathJax_Main;">~</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-1492" style=""><span class="mrow" id="MathJax-Span-1493"><span class="mo" id="MathJax-Span-1494" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">}</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -5.978em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1497"><span class="mrow" id="MathJax-Span-1498"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; width: 100%; clip: rect(4.529em, 1029.58em, 10.24em, -999.997em); top: -6.193em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1501"><span class="mrow" id="MathJax-Span-1502"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.104em, 1029.58em, 5.391em, -999.997em); top: -3.984em; left: 50%; margin-left: -14.76em;"><span class="mi" id="MathJax-Span-1503"></span><span class="mo" id="MathJax-Span-1504" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-1505" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1506" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-1507"><span class="mrow" id="MathJax-Span-1508"><span class="mi" id="MathJax-Span-1509" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1510" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1511" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1512" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1513" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1514" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-1515"><span class="mrow" id="MathJax-Span-1516"><span class="mi" id="MathJax-Span-1517" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1518" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1519" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1520" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1521" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1522" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.757em;"><span class="texatom" id="MathJax-Span-1523"><span class="mrow" id="MathJax-Span-1524"><span class="msubsup" id="MathJax-Span-1525"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1526" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="texatom" id="MathJax-Span-1527"><span class="mrow" id="MathJax-Span-1528"><span class="mi" id="MathJax-Span-1529" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1530" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1531" style=""><span class="mrow" id="MathJax-Span-1532"><span class="mo" id="MathJax-Span-1533" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">{</span></span></span></span><span class="msubsup" id="MathJax-Span-1534"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1535" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1536"><span class="mrow" id="MathJax-Span-1537"><span class="mi" id="MathJax-Span-1538" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1539" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1540" style=""><span class="mrow" id="MathJax-Span-1541"><span class="mo" id="MathJax-Span-1542" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">}</span></span></span></span><span class="mi" id="MathJax-Span-1543" style="font-family: MathJax_Main; padding-left: 0.164em;">ln</span><span class="mo" id="MathJax-Span-1544"></span><span class="msubsup" id="MathJax-Span-1545" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1546" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1547" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1548" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="munderover" id="MathJax-Span-1549" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1550" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-1551"><span class="mrow" id="MathJax-Span-1552"><span class="mi" id="MathJax-Span-1553" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1554" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1555" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1556" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1557" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1558" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-1559"><span class="mrow" id="MathJax-Span-1560"><span class="mi" id="MathJax-Span-1561" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1562" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1563" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1564" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1565" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1566" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.757em;"><span class="texatom" id="MathJax-Span-1567"><span class="mrow" id="MathJax-Span-1568"><span class="msubsup" id="MathJax-Span-1569"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1570" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="texatom" id="MathJax-Span-1571"><span class="mrow" id="MathJax-Span-1572"><span class="mi" id="MathJax-Span-1573" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1574" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1575" style=""><span class="mrow" id="MathJax-Span-1576"><span class="mo" id="MathJax-Span-1577" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">{</span></span></span></span><span class="msubsup" id="MathJax-Span-1578"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1579" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1580"><span class="mrow" id="MathJax-Span-1581"><span class="mi" id="MathJax-Span-1582" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1583" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1584" style=""><span class="mrow" id="MathJax-Span-1585"><span class="mo" id="MathJax-Span-1586" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">}</span></span></span></span><span class="texatom" id="MathJax-Span-1587" style=""><span class="mrow" id="MathJax-Span-1588"><span class="mo" id="MathJax-Span-1589" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span><span class="mo" id="MathJax-Span-1590" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1591"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mi" id="MathJax-Span-1592" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1593" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.65em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.649em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-1594" style="font-family: MathJax_Main;">ln</span><span class="mo" id="MathJax-Span-1595"></span><span class="mo" id="MathJax-Span-1596" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1597" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-1598" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1599" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1600" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mfrac" id="MathJax-Span-1601" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1602" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1603" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.65em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.649em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-1604" style="font-family: MathJax_Main;">ln</span><span class="mo" id="MathJax-Span-1605"></span><span class="texatom" id="MathJax-Span-1606" style=""><span class="mrow" id="MathJax-Span-1607"><span class="mo" id="MathJax-Span-1608" style="vertical-align: 0.865em;"><span style="display: inline-block; position: relative; width: 0.272em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.23em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.015em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-1609"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1610" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-1611" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1612" style=""><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1000.16em, 4.475em, -999.997em); top: -3.984em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1613" style=""><span class="mrow" id="MathJax-Span-1614"><span class="mo" id="MathJax-Span-1615" style="vertical-align: 0.865em;"><span style="display: inline-block; position: relative; width: 0.272em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.23em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.015em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.577em; left: 0.272em;"><span class="texatom" id="MathJax-Span-1616"><span class="mrow" id="MathJax-Span-1617"><span class="mo" id="MathJax-Span-1618" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1619" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.481em, 1012.77em, 4.852em, -999.997em); top: -1.021em; left: 50%; margin-left: -6.463em;"><span class="mo" id="MathJax-Span-1620" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-1621" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1622" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-1623" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.65em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.649em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-1624" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1625"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1626" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-1627" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1628" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-1629" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1630" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-1631" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1632"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1633" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="mi" id="MathJax-Span-1634" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1635"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1636" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.97em, 4.151em, -999.997em); top: -4.308em; left: 0.811em;"><span class="texatom" id="MathJax-Span-1637"><span class="mrow" id="MathJax-Span-1638"><span class="mo" id="MathJax-Span-1639" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1640" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.43em, 4.151em, -999.997em); top: -3.661em; left: 0.811em;"><span class="mi" id="MathJax-Span-1641" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1642" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1643"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1644" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-1645" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1646" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-1647" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1648" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-1649" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1650" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1651" style=""><span class="mrow" id="MathJax-Span-1652"><span class="mo" id="MathJax-Span-1653" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.414em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.27em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.559em; border-left: 0px solid; width: 0px; height: 9.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>L</mi></mtd><mtd><mi></mi><mo>=</mo><msub><mi>E</mi><mi>z</mi></msub><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">{</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mover><mi>L</mi><mo stretchy="false">~</mo></mover></mrow><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">}</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub></mrow></msub><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">{</mo></mrow><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">}</mo></mrow><mi>ln</mi><mo>⁡</mo><msub><mi>π</mi><mi>k</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub></mrow></msub><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">{</mo></mrow><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">}</mo></mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow><mo>−</mo><mfrac><mi>d</mi><mn>2</mn></mfrac><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>ln</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">|</mo></mrow><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><msup><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo>−</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msubsup><mi mathvariant="bold">Σ</mi><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo>−</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow></mtd></mtr></mtable></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-45">{\begin{align}
L &= E_z \bigl\{\tilde{L} \bigr\} \\
&\\
&= \sum_{i = 1}^N \sum_{k = 1}^K E_{z_{ik}} \bigl\{z_{ik} \bigr\} \ln \pi_k + \sum_{i = 1}^N \sum_{k = 1}^K E_{z_{ik}} \bigl\{z_{ik} \bigr\} \bigl(-\frac{d}{2}\ln (2\pi) + \frac{1}{2} \ln \bigl|\boldsymbol \Sigma_k \bigr|^{-1} - \frac{1}{2}(\boldsymbol x_i - \boldsymbol \mu_k)^T \boldsymbol \Sigma_k^{-1}(\boldsymbol x_i - \boldsymbol \mu_k) \bigr)
\end{align}
}</script></div>

<p>隠れ変数に関する期待値は，式(*)より以下のようになり，隠れ変数の事後確率となります．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;{&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1654" role="math" style="width: 21.878em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.86em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(-6.301em, 1018.59em, 10.563em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1655"><span class="texatom" id="MathJax-Span-1656"><span class="mrow" id="MathJax-Span-1657"><span class="mtable" id="MathJax-Span-1658" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 18.537em; height: 0px;"><span style="position: absolute; clip: rect(8.623em, 1003.83em, 25.11em, -999.997em); top: -17.185em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 3.936em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1003.83em, 4.475em, -999.997em); top: -11.581em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1659"><span class="mrow" id="MathJax-Span-1660"><span class="msubsup" id="MathJax-Span-1661"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1662" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.757em;"><span class="texatom" id="MathJax-Span-1663"><span class="mrow" id="MathJax-Span-1664"><span class="msubsup" id="MathJax-Span-1665"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1666" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="texatom" id="MathJax-Span-1667"><span class="mrow" id="MathJax-Span-1668"><span class="mi" id="MathJax-Span-1669" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1670" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1671"><span class="mrow" id="MathJax-Span-1672"><span class="mo" id="MathJax-Span-1673" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">{</span></span></span></span><span class="msubsup" id="MathJax-Span-1674"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1675" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1676"><span class="mrow" id="MathJax-Span-1677"><span class="mi" id="MathJax-Span-1678" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1679" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1680"><span class="mrow" id="MathJax-Span-1681"><span class="mo" id="MathJax-Span-1682" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">}</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -9.049em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1738"><span class="mrow" id="MathJax-Span-1739"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -7.756em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1742"><span class="mrow" id="MathJax-Span-1743"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -6.409em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1769"><span class="mrow" id="MathJax-Span-1770"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -4.415em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1773"><span class="mrow" id="MathJax-Span-1774"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -1.937em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1848"><span class="mrow" id="MathJax-Span-1849"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: 0.003em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1852"><span class="mrow" id="MathJax-Span-1853"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: 2.481em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1907"><span class="mrow" id="MathJax-Span-1908"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: 3.774em; right: 0.003em;"><span class="mtd" id="MathJax-Span-1911"><span class="mrow" id="MathJax-Span-1912"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 17.19em;"></span></span><span style="position: absolute; clip: rect(8.893em, 1014.5em, 25.757em, -999.997em); top: -17.562em; left: 3.936em;"><span style="display: inline-block; position: relative; width: 14.55em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1014.5em, 5.552em, -999.997em); top: -11.581em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1683"><span class="mrow" id="MathJax-Span-1684"><span class="mi" id="MathJax-Span-1685"></span><span class="mo" id="MathJax-Span-1686" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-1687" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.966em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.757em;"><span class="mo" id="MathJax-Span-1688" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.289em, 1002.91em, 4.421em, -999.997em); top: -2.853em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1689"><span class="mrow" id="MathJax-Span-1690"><span class="msubsup" id="MathJax-Span-1691"><span style="display: inline-block; position: relative; width: 0.811em; height: 0px;"><span style="position: absolute; clip: rect(3.505em, 1000.33em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1692" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.326em;"><span class="texatom" id="MathJax-Span-1693"><span class="mrow" id="MathJax-Span-1694"><span class="mi" id="MathJax-Span-1695" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1696" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1697" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-1698" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mn" id="MathJax-Span-1699" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1700" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1701" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1702" style="font-size: 70.7%; font-family: MathJax_Main;">}</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1703" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1704" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1705"><span class="mrow" id="MathJax-Span-1706"><span class="mi" id="MathJax-Span-1707" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1708" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1709" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1710" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1711"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1712" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1713"><span class="mrow" id="MathJax-Span-1714"><span class="mi" id="MathJax-Span-1715" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1716" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1717" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-1718"><span class="mrow" id="MathJax-Span-1719"><span class="mo" id="MathJax-Span-1720" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-1721" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1722"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1723" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-1724" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1725" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1726" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1727" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1728" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1729" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1730" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1731" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-1732" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1733" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1734" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1735" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-1736" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1737" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -9.049em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1740"><span class="mrow" id="MathJax-Span-1741"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1008.95em, 4.421em, -999.997em); top: -7.756em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1744"><span class="mrow" id="MathJax-Span-1745"><span class="mi" id="MathJax-Span-1746"></span><span class="mo" id="MathJax-Span-1747" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-1748" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-1749" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="mi" id="MathJax-Span-1750" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">p</span><span class="mo" id="MathJax-Span-1751" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1752"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1753" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1754"><span class="mrow" id="MathJax-Span-1755"><span class="mi" id="MathJax-Span-1756" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1757" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1758" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-1759" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mtext" id="MathJax-Span-1760" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-1761"><span class="mrow" id="MathJax-Span-1762"><span class="mo" id="MathJax-Span-1763" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-1764" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1765"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1766" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-1767" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1768" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -6.409em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1771"><span class="mrow" id="MathJax-Span-1772"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.373em, 1013.96em, 5.498em, -999.997em); top: -4.415em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1775"><span class="mrow" id="MathJax-Span-1776"><span class="mi" id="MathJax-Span-1777"></span><span class="mo" id="MathJax-Span-1778" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-1779" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 12.395em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1010.19em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -5.116em;"><span class="mrow" id="MathJax-Span-1780"><span class="mi" id="MathJax-Span-1781" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1782" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1783"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1784" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1785"><span class="mrow" id="MathJax-Span-1786"><span class="mi" id="MathJax-Span-1787" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1788" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1789" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-1790" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-1791" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1792" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1793" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1794"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1795" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-1796" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1797" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-1798"><span class="mrow" id="MathJax-Span-1799"><span class="mo" id="MathJax-Span-1800" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-1801" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1802"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1803" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1804"><span class="mrow" id="MathJax-Span-1805"><span class="mi" id="MathJax-Span-1806" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1807" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1808" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-1809" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-1810" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.858em, 1012.18em, 4.582em, -999.997em); top: -3.068em; left: 50%; margin-left: -6.14em;"><span class="mrow" id="MathJax-Span-1811"><span class="munderover" id="MathJax-Span-1812"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1001.03em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1813" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.7em, 4.151em, -999.997em); top: -4.469em; left: 1.08em;"><span class="mi" id="MathJax-Span-1814" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.3em, 4.313em, -999.997em); top: -3.715em; left: 1.08em;"><span class="texatom" id="MathJax-Span-1815"><span class="mrow" id="MathJax-Span-1816"><span class="mi" id="MathJax-Span-1817" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1818" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1819" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1820" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">p</span><span class="mo" id="MathJax-Span-1821" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1822"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1823" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1824"><span class="mrow" id="MathJax-Span-1825"><span class="mi" id="MathJax-Span-1826" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1827" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1828" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-1829" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-1830" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1831" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1832" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1833" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-1834" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-1835"><span class="mrow" id="MathJax-Span-1836"><span class="mo" id="MathJax-Span-1837" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-1838" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1839"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1840" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1841"><span class="mrow" id="MathJax-Span-1842"><span class="mi" id="MathJax-Span-1843" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1844" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1845" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-1846" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-1847" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1012.39em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 12.395em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -1.937em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1850"><span class="mrow" id="MathJax-Span-1851"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.373em, 1010.94em, 5.498em, -999.997em); top: 0.003em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1854"><span class="mrow" id="MathJax-Span-1855"><span class="mi" id="MathJax-Span-1856"></span><span class="mo" id="MathJax-Span-1857" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-1858" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 9.378em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1006.9em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -3.499em;"><span class="mrow" id="MathJax-Span-1859"><span class="msubsup" id="MathJax-Span-1860"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1861" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1862" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1863" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-1864" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1865" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-1866" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-1867"><span class="mrow" id="MathJax-Span-1868"><span class="mo" id="MathJax-Span-1869" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-1870" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1871"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1872" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-1873" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1874" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1875" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1876" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-1877" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1878" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.858em, 1009.16em, 4.582em, -999.997em); top: -3.068em; left: 50%; margin-left: -4.631em;"><span class="mrow" id="MathJax-Span-1879"><span class="munderover" id="MathJax-Span-1880"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1001.03em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1881" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.7em, 4.151em, -999.997em); top: -4.469em; left: 1.08em;"><span class="mi" id="MathJax-Span-1882" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.3em, 4.313em, -999.997em); top: -3.715em; left: 1.08em;"><span class="texatom" id="MathJax-Span-1883"><span class="mrow" id="MathJax-Span-1884"><span class="mi" id="MathJax-Span-1885" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1886" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1887" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1888" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1889" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1890" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1891" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-1892" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1893" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-1894" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-1895"><span class="mrow" id="MathJax-Span-1896"><span class="mo" id="MathJax-Span-1897" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-1898" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1899"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1900" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-1901" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1902" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1903" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.188em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1904" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-1905" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1906" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1009.38em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 9.378em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: 2.481em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1909"><span class="mrow" id="MathJax-Span-1910"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1003.72em, 4.421em, -999.997em); top: 3.774em; left: 0.003em;"><span class="mtd" id="MathJax-Span-1913"><span class="mrow" id="MathJax-Span-1914"><span class="mi" id="MathJax-Span-1915"></span><span class="mo" id="MathJax-Span-1916" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-1917" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1918" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1919"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1920" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1921"><span class="mrow" id="MathJax-Span-1922"><span class="mi" id="MathJax-Span-1923" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1924" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1925" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 17.567em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -9.372em; border-left: 0px solid; width: 0px; height: 19.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub></mrow></msub><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">{</mo></mrow><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">}</mo></mrow></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mo fence="false" stretchy="false">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></mrow></munder><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mi>p</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>π</mi><mi>k</mi></msub><mo>,</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mn>1</mn><mo>×</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>p</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mi>k</mi></msub><mi>N</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>π</mi><mi>j</mi></msub><mi>N</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>j</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-46">{\begin{align}
E_{z_{ik}} \bigl\{z_{ik} \bigr\} &= \sum_{z_{ik} = \{0, 1\}} z_{ik}p(z_{ik} \ | \ \boldsymbol x_i, \pi_k, \boldsymbol \mu_k, \boldsymbol \Sigma_k) \\
&\\
&= 1 \times p(z_{ik} = 1 \ | \ \boldsymbol x_i) \\
&\\
& = \frac{p(z_{ik} = 1)p(\boldsymbol x_i \ | \ z_{ik} = 1)}{\sum_{j = 1}^K p(z_{ij} = 1)p(\boldsymbol x \ | \ z_{ij} = 1)} \\
&\\
&= \frac{\pi_kN(\boldsymbol x \ | \ \boldsymbol \mu_k, \boldsymbol \Sigma_k)}{\sum_{j = 1}^K \pi_jN(\boldsymbol x \ | \ \boldsymbol \mu_j, \boldsymbol \Sigma_j)} \\
&\\
&= \gamma(z_{ik})
\end{align}
}</script></div>

<p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1926" role="math" style="width: 0.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.65em, 2.535em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1927"><span class="mi" id="MathJax-Span-1928" style="font-family: MathJax_Math-italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">L</script> の隠れ変数の期待値を事後確率で置換した関数を <strong>Q関数</strong> と呼びます．</p>

<div style=""><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="width: 100%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;ln&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1929" role="math" style="width: 100%; display: inline-block; min-width: 28.666em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(4.529em, 1024.52em, 10.294em, -999.997em); top: -6.409em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-1930"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.104em, 1017.89em, 5.391em, -999.997em); top: -3.984em; left: 50%; margin-left: -8.941em;"><span class="texatom" id="MathJax-Span-1931"><span class="mrow" id="MathJax-Span-1932"><span class="mi" id="MathJax-Span-1933" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-1934" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-1935" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1936" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-1937"><span class="mrow" id="MathJax-Span-1938"><span class="mi" id="MathJax-Span-1939" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1940" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1941" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1942" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1943" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1944" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-1945"><span class="mrow" id="MathJax-Span-1946"><span class="mi" id="MathJax-Span-1947" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1948" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1949" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1950" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1951" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1952" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1953"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1954" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1955"><span class="mrow" id="MathJax-Span-1956"><span class="mi" id="MathJax-Span-1957" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1958" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1959" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1960" style="font-family: MathJax_Main; padding-left: 0.164em;">ln</span><span class="mo" id="MathJax-Span-1961"></span><span class="msubsup" id="MathJax-Span-1962" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1963" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1964" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1965" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="munderover" id="MathJax-Span-1966" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1967" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-1968"><span class="mrow" id="MathJax-Span-1969"><span class="mi" id="MathJax-Span-1970" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1971" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1972" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1973" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1974" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-1975" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.24em, 4.259em, -999.997em); top: -2.853em; left: 0.11em;"><span class="texatom" id="MathJax-Span-1976"><span class="mrow" id="MathJax-Span-1977"><span class="mi" id="MathJax-Span-1978" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1979" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1980" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-1981" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-1982" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1983" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1984"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1985" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-1986"><span class="mrow" id="MathJax-Span-1987"><span class="mi" id="MathJax-Span-1988" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1989" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-1990" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1991" style="font-family: MathJax_Main; padding-left: 0.164em;">ln</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.481em, 1024.52em, 4.852em, -999.997em); top: -0.967em; left: 50%; margin-left: -12.336em;"><span class="texatom" id="MathJax-Span-1931-MathJax-Continue-1"><span class="mrow" id="MathJax-Span-1932-MathJax-Continue-1"><span class="mo" id="MathJax-Span-1992"></span><span class="msubsup" id="MathJax-Span-1993" style=""><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-1994" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-1995" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1996" style=""><span class="mrow" id="MathJax-Span-1997"><span class="mo" id="MathJax-Span-1998" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span><span class="mo" id="MathJax-Span-1999" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-2000"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mi" id="MathJax-Span-2001" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-2002" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.65em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.649em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-2003" style="font-family: MathJax_Main;">ln</span><span class="mo" id="MathJax-Span-2004"></span><span class="mo" id="MathJax-Span-2005" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2006" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-2007" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2008" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2009" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mfrac" id="MathJax-Span-2010" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-2011" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-2012" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.65em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.649em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mi" id="MathJax-Span-2013" style="font-family: MathJax_Main;">ln</span><span class="mo" id="MathJax-Span-2014"></span><span class="texatom" id="MathJax-Span-2015" style=""><span class="mrow" id="MathJax-Span-2016"><span class="mo" id="MathJax-Span-2017" style="vertical-align: 0.865em;"><span style="display: inline-block; position: relative; width: 0.272em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.23em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.015em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-2018"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2019" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-2020" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2021" style=""><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(2.966em, 1000.16em, 4.475em, -999.997em); top: -3.984em; left: 0.003em;"><span class="texatom" id="MathJax-Span-2022" style=""><span class="mrow" id="MathJax-Span-2023"><span class="mo" id="MathJax-Span-2024" style="vertical-align: 0.865em;"><span style="display: inline-block; position: relative; width: 0.272em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.23em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.015em; left: 0.003em;">∣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.577em; left: 0.272em;"><span class="texatom" id="MathJax-Span-2025"><span class="mrow" id="MathJax-Span-2026"><span class="mo" id="MathJax-Span-2027" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2028" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2029" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mfrac" id="MathJax-Span-2030" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-2031" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-2032" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.65em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.649em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-2033" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2034"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2035" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-2036" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2037" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-2038" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2039" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-2040" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2041"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-2042" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="mi" id="MathJax-Span-2043" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2044"><span style="display: inline-block; position: relative; width: 1.835em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2045" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.97em, 4.151em, -999.997em); top: -4.308em; left: 0.811em;"><span class="texatom" id="MathJax-Span-2046"><span class="mrow" id="MathJax-Span-2047"><span class="mo" id="MathJax-Span-2048" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2049" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.43em, 4.151em, -999.997em); top: -3.661em; left: 0.811em;"><span class="mi" id="MathJax-Span-2050" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2051" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2052"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2053" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-2054" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2055" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-2056" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2057" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-2058" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2059" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-2060" style=""><span class="mrow" id="MathJax-Span-2061"><span class="mo" id="MathJax-Span-2062" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.414em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.372em; border-left: 0px solid; width: 0px; height: 6.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi>Q</mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><mi>ln</mi><mo>⁡</mo><msub><mi>π</mi><mi>k</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><mi>ln</mi><mo>⁡</mo><msub><mi>π</mi><mi>k</mi></msub><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow><mo>−</mo><mfrac><mi>d</mi><mn>2</mn></mfrac><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>ln</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">|</mo></mrow><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><msup><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo>−</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msubsup><mi mathvariant="bold">Σ</mi><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo>−</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">{Q = \sum_{i = 1}^N \sum_{k = 1}^K \gamma(z_{ik}) \ln \pi_k + \sum_{i = 1}^N \sum_{k = 1}^K \gamma(z_{ik}) \ln \pi_k \bigl(-\frac{d}{2}\ln (2\pi) + \frac{1}{2} \ln \bigl|\boldsymbol \Sigma_k \bigr|^{-1} - \frac{1}{2}(\boldsymbol x_i - \boldsymbol \mu_k)^T \boldsymbol \Sigma_k^{-1}(\boldsymbol x_i - \boldsymbol \mu_k) \bigr)
}</script></div>

<h1>
<span id="emアルゴリズムによるパラメータ推定" class="fragment"></span><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#em%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0%E3%81%AB%E3%82%88%E3%82%8B%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A"><i class="fa fa-link"></i></a>EMアルゴリズムによるパラメータ推定</h1>

<p>隠れ変数がある確率モデルのパラメータの最尤推定値を求める手法として <strong>EMアルゴリズム</strong> を用います．<br>
EMアルゴリズムは2つのステップで構成されます．</p>

<ul>
<li>Expectationステップ：隠れ変数に関する期待値を取る操作．モデルパラメータを固定して隠れ変数の事後確率を求める．</li>
<li>Maximizationステップ：Eステップで求めた隠れ変数の事後確率を用いてQ関数を最大にするモデルパラメータを求める．</li>
</ul>

<p>EMアルゴリズムは完全データの対数尤度に変化がなくなるまで，EステップおよびMステップを繰り返します．<br>
収束値は初期値に依存するため，局所最適解しか得られません．<br>
初期値を変えて複数回EMアルゴリズムを使って最尤推定値を求め，その中から良いものを選択する必要があります．<br>
EMアルゴリズムをまとめると，次のようになります．</p>

<ol>
<li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2063" role="math" style="width: 5.66em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.852em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.85em, 2.751em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2064"><span class="msubsup" id="MathJax-Span-2065"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2066" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-2067" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2068" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-2069" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-2070"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2071" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-2072" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2073" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-2074" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-2075"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2076" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-2077" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>π</mi><mi>k</mi></msub><mo>,</mo><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><mtext>&nbsp;</mtext><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-49">\pi_k, \ \boldsymbol \mu_k, \ \boldsymbol \Sigma_k</script> の初期化</li>
<li>Eステップ：現在のパラメータ <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2078" role="math" style="width: 5.66em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.852em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.85em, 2.751em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2079"><span class="msubsup" id="MathJax-Span-2080"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2081" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-2082" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2083" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-2084" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-2085"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2086" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-2087" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2088" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-2089" style="font-family: MathJax_Main; padding-left: 0.164em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-2090"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2091" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-2092" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>π</mi><mi>k</mi></msub><mo>,</mo><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><mtext>&nbsp;</mtext><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-50">\pi_k, \ \boldsymbol \mu_k, \ \boldsymbol \Sigma_k</script> を用いた事後確率 <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2093" role="math" style="width: 2.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1002.32em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2094"><span class="mi" id="MathJax-Span-2095" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2096" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2097"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2098" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-2099"><span class="mrow" id="MathJax-Span-2100"><span class="mi" id="MathJax-Span-2101" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-2102" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2103" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-51">\gamma(z_{ik})</script> の推定<br>
<span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2104" role="math" style="width: 15.52em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.365em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.757em, 1013.37em, 3.882em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2105"><span class="mi" id="MathJax-Span-2106" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2107" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2108"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2109" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-2110"><span class="mrow" id="MathJax-Span-2111"><span class="mi" id="MathJax-Span-2112" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-2113" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2114" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2115" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-2116" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 9.378em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1006.9em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -3.499em;"><span class="mrow" id="MathJax-Span-2117"><span class="msubsup" id="MathJax-Span-2118"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2119" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-2120" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-2121" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-2122" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2123" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-2124" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-2125"><span class="mrow" id="MathJax-Span-2126"><span class="mo" id="MathJax-Span-2127" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-2128" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-2129"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2130" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-2131" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2132" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2133" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2134" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-2135" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2136" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.858em, 1009.16em, 4.582em, -999.997em); top: -3.068em; left: 50%; margin-left: -4.631em;"><span class="mrow" id="MathJax-Span-2137"><span class="munderover" id="MathJax-Span-2138"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1001.03em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-2139" style="font-family: MathJax_Size1; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1000.7em, 4.151em, -999.997em); top: -4.469em; left: 1.08em;"><span class="mi" id="MathJax-Span-2140" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.3em, 4.313em, -999.997em); top: -3.715em; left: 1.08em;"><span class="texatom" id="MathJax-Span-2141"><span class="mrow" id="MathJax-Span-2142"><span class="mi" id="MathJax-Span-2143" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2144" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2145" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2146" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2147" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-2148" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-2149" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-2150" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2151" style="font-family: MathJax_Math-bold-italic;">x</span><span class="mtext" id="MathJax-Span-2152" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-2153"><span class="mrow" id="MathJax-Span-2154"><span class="mo" id="MathJax-Span-2155" style="font-family: MathJax_Main;">|</span></span></span><span class="mtext" id="MathJax-Span-2156" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-2157"><span style="display: inline-block; position: relative; width: 1.08em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2158" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-2159" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2160" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2161" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.188em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2162" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-2163" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2164" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1009.38em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 9.378em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mi>k</mi></msub><mi>N</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>π</mi><mi>j</mi></msub><mi>N</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><msub><mi mathvariant="bold-italic">μ</mi><mi>j</mi></msub><mo>,</mo><msub><mi mathvariant="bold">Σ</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-52">\gamma(z_{ik}) = \frac{\pi_kN(\boldsymbol x \ | \ \boldsymbol \mu_k, \boldsymbol \Sigma_k)}{\sum_{j = 1}^K \pi_jN(\boldsymbol x \ | \ \boldsymbol \mu_j, \boldsymbol \Sigma_j)}</script></li>
<li>Mステップ：推定した <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2165" role="math" style="width: 2.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.427em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1002.32em, 2.804em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2166"><span class="mi" id="MathJax-Span-2167" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2168" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2169"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2170" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-2171"><span class="mrow" id="MathJax-Span-2172"><span class="mi" id="MathJax-Span-2173" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-2174" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2175" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">\gamma(z_{ik})</script> を用いたモデルパラメータの再推定<br>
<span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd /&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2176" role="math" style="width: 20.369em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.567em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(-5.87em, 1017.41em, 10.078em, -999.997em); top: -2.368em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2177"><span class="mtable" id="MathJax-Span-2178" style="padding-right: 0.164em; padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 17.244em; height: 0px;"><span style="position: absolute; clip: rect(7.707em, 1000em, 21.285em, -999.997em); top: -14.221em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.003em; height: 0px;"><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -10.342em; right: 0.003em;"><span class="mtd" id="MathJax-Span-2179"><span class="mrow" id="MathJax-Span-2180"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -8.025em; right: 0.003em;"><span class="mtd" id="MathJax-Span-2204"><span class="mrow" id="MathJax-Span-2205"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -5.762em; right: 0.003em;"><span class="mtd" id="MathJax-Span-2208"><span class="mrow" id="MathJax-Span-2209"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -3.499em; right: 0.003em;"><span class="mtd" id="MathJax-Span-2241"><span class="mrow" id="MathJax-Span-2242"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -1.237em; right: 0.003em;"><span class="mtd" id="MathJax-Span-2245"><span class="mrow" id="MathJax-Span-2246"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: 1.026em; right: 0.003em;"><span class="mtd" id="MathJax-Span-2295"><span class="mrow" id="MathJax-Span-2296"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: 2.912em; right: 0.003em;"><span class="mtd" id="MathJax-Span-2299"><span class="mrow" id="MathJax-Span-2300"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 14.227em;"></span></span><span style="position: absolute; clip: rect(8.408em, 1017.24em, 24.356em, -999.997em); top: -16.646em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 17.244em; height: 0px;"><span style="position: absolute; clip: rect(2.104em, 1006.58em, 5.337em, -999.997em); top: -10.342em; left: 0.003em;"><span class="mtd" id="MathJax-Span-2181"><span class="mrow" id="MathJax-Span-2182"><span class="msubsup" id="MathJax-Span-2183"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2184" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-2185" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2186" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="munderover" id="MathJax-Span-2187" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-2188" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-2189"><span class="mrow" id="MathJax-Span-2190"><span class="mi" id="MathJax-Span-2191" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2192" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2193" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-2194" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-2195" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2196" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2197"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2198" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-2199"><span class="mrow" id="MathJax-Span-2200"><span class="mi" id="MathJax-Span-2201" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-2202" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2203" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -8.025em; left: 0.003em;"><span class="mtd" id="MathJax-Span-2206"><span class="mrow" id="MathJax-Span-2207"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.104em, 1009.32em, 5.337em, -999.997em); top: -5.762em; left: 0.003em;"><span class="mtd" id="MathJax-Span-2210"><span class="mrow" id="MathJax-Span-2211"><span class="msubsup" id="MathJax-Span-2212"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2213" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-2214" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2215" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-2216" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-2217" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1001.24em, 4.313em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.644em;"><span class="msubsup" id="MathJax-Span-2218"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2219" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-2220" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.35em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.35em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2221" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-2222" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-2223"><span class="mrow" id="MathJax-Span-2224"><span class="mi" id="MathJax-Span-2225" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2226" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2227" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-2228" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-2229" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2230" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2231"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2232" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-2233"><span class="mrow" id="MathJax-Span-2234"><span class="mi" id="MathJax-Span-2235" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-2236" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2237" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2238"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2239" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-2240" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: -3.499em; left: 0.003em;"><span class="mtd" id="MathJax-Span-2243"><span class="mrow" id="MathJax-Span-2244"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.104em, 1017.24em, 5.337em, -999.997em); top: -1.237em; left: 0.003em;"><span class="mtd" id="MathJax-Span-2247"><span class="mrow" id="MathJax-Span-2248"><span class="msubsup" id="MathJax-Span-2249"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2250" style="font-family: MathJax_Main-bold;">Σ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-2251" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2252" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-2253" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.151em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.267em;"><span class="mn" id="MathJax-Span-2254" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1001.24em, 4.313em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.644em;"><span class="msubsup" id="MathJax-Span-2255"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2256" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-2257" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.35em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.35em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2258" style="padding-left: 0.164em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(2.858em, 1001.4em, 4.582em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-2259" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.08em, 4.259em, -999.997em); top: -2.907em; left: 0.164em;"><span class="texatom" id="MathJax-Span-2260"><span class="mrow" id="MathJax-Span-2261"><span class="mi" id="MathJax-Span-2262" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2263" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2264" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.235em, 1000.65em, 4.151em, -999.997em); top: -5.116em; left: 0.434em;"><span class="mi" id="MathJax-Span-2265" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mi" id="MathJax-Span-2266" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2267" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2268"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2269" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-2270"><span class="mrow" id="MathJax-Span-2271"><span class="mi" id="MathJax-Span-2272" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-2273" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2274" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2275" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2276"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2277" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-2278" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2279" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-2280" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2281" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-2282" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2283" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2284" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2285"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2286" style="font-family: MathJax_Math-bold-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="mi" id="MathJax-Span-2287" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2288" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="msubsup" id="MathJax-Span-2289" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.7em, 4.367em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2290" style="font-family: MathJax_Math-bold-italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.703em;"><span class="mi" id="MathJax-Span-2291" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2292"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1000.27em, 4.421em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mo" id="MathJax-Span-2293" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.38em;"><span class="mi" id="MathJax-Span-2294" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.828em, 1000em, 4.151em, -999.997em); top: 1.026em; left: 0.003em;"><span class="mtd" id="MathJax-Span-2297"><span class="mrow" id="MathJax-Span-2298"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(2.481em, 1003.94em, 4.852em, -999.997em); top: 2.912em; left: 0.003em;"><span class="mtd" id="MathJax-Span-2301"><span class="mrow" id="MathJax-Span-2302"><span class="msubsup" id="MathJax-Span-2303"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.6em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2304" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="mi" id="MathJax-Span-2305" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-2306" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mfrac" id="MathJax-Span-2307" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1001.24em, 4.313em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.644em;"><span class="msubsup" id="MathJax-Span-2308"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.984em; left: 0.003em;"><span class="mi" id="MathJax-Span-2309" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="mi" id="MathJax-Span-2310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.87em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.428em;"><span class="mi" id="MathJax-Span-2311" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1001.35em, 1.242em, -999.997em); top: -1.29em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.35em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 16.651em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -8.809em; border-left: 0px solid; width: 0px; height: 18.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd></mtd><mtd><msub><mi>N</mi><mi>k</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo>=</mo><mfrac><mn>1</mn><msub><mi>N</mi><mi>k</mi></msub></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><msub><mi mathvariant="bold">Σ</mi><mi>k</mi></msub><mo>=</mo><mfrac><mn>1</mn><msub><mi>N</mi><mi>k</mi></msub></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo>−</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi mathvariant="bold-italic">x</mi><mi>i</mi></msub><mo>−</mo><msub><mi mathvariant="bold-italic">μ</mi><mi>k</mi></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mtd></mtr><mtr><mtd></mtd><mtd></mtd></mtr><mtr><mtd></mtd><mtd><msub><mi>π</mi><mi>k</mi></msub><mo>=</mo><mfrac><msub><mi>N</mi><mi>k</mi></msub><mi>N</mi></mfrac></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-54">
\begin{align}
& N_k = \sum_{i = 1}^N \gamma(z_{ik})  \\
& \\
& \boldsymbol \mu_k = \frac{1}{N_k} \sum_{i = 1}^N \gamma(z_{ik}) \boldsymbol x_i  \\
& \\
& \boldsymbol \Sigma_k = \frac{1}{N_k} \sum_{i = 1}^N \gamma(z_{ik}) (\boldsymbol x_i - \boldsymbol \mu_k)(\boldsymbol x_i - \boldsymbol \mu_k)^T  \\
& \\
& \pi_k = \frac{N_k}{N} 
\end{align}
</script></li>
<li>終了判定：完全データの対数尤度が収束していない場合2.から再計算．収束していれば終了．</li>
</ol>

<h1>
<span id="pythonでの実装" class="fragment"></span><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#python%E3%81%A7%E3%81%AE%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>pythonでの実装</h1>

<p>以下のように実装しました．</p>

<div class="code-frame" data-lang="python">
<div class="code-lang"><span class="bold">mixturesofgaussian.py</span></div>
<div class="code-copy"><div class="code-copy__message" style="display: none;">Copied!</div><button class="code-copy__button" style="display: none;"><span class="fa fa-fw fa-clipboard"></span></button></div><div class="highlight"><pre><code><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">create_data</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">mu_star</span><span class="p">,</span> <span class="n">sigma_star</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">loc</span> <span class="o">=</span> <span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span> <span class="c1"># range: -5.0 - 5.0
</span>        <span class="n">scale</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="c1"># range: 0.0 - 3.0
</span>        <span class="n">X</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">numpy</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">N</span> <span class="o">/</span> <span class="n">K</span><span class="p">))</span>
        <span class="n">mu_star</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">mu_star</span><span class="p">,</span> <span class="n">loc</span><span class="p">)</span>
        <span class="n">sigma_star</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigma_star</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">mu_star</span><span class="p">,</span> <span class="n">sigma_star</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">gaussian</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">numpy</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">/</span> <span class="n">numpy</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">numpy</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span>

<span class="k">def</span> <span class="nf">estimate_posterior_likelihood</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">gf</span><span class="p">):</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="n">pi</span><span class="p">.</span><span class="n">size</span><span class="p">))</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">gf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">l</span> <span class="o">*</span> <span class="n">numpy</span><span class="p">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">y</span><span class="p">)(</span><span class="n">l</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">estimate_gmm_parameter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">X</span><span class="p">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))).</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">).</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">pi</span> <span class="o">=</span> <span class="n">N</span> <span class="o">/</span> <span class="n">X</span><span class="p">.</span><span class="n">size</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">calc_Q</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">numpy</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)))).</span><span class="nb">sum</span><span class="p">()</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="n">Q</span> <span class="o">+=</span> <span class="p">(</span><span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">)).</span><span class="nb">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Q</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>

    <span class="c1"># data
</span>    <span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">K</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">mu_star</span><span class="p">,</span> <span class="n">sigma_star</span> <span class="o">=</span> <span class="n">create_data</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>

    <span class="c1"># termination condition
</span>    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.000001</span>

    <span class="c1"># initialize gmm parameter
</span>    <span class="n">pi</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="n">K</span><span class="p">))</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="o">-</span><span class="n">sys</span><span class="p">.</span><span class="n">float_info</span><span class="p">.</span><span class="nb">max</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1"># EM algorithm
</span>    <span class="k">while</span> <span class="n">delta</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">delta</span> <span class="o">&gt;=</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="n">gf</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>

        <span class="c1"># E step: estimate posterior probability of hidden variable gamma
</span>        <span class="n">gamma</span> <span class="o">=</span> <span class="n">estimate_posterior_likelihood</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">gf</span><span class="p">)</span>

        <span class="c1"># M step: miximize Q function by estimating mu, sigma and pi
</span>        <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">estimate_gmm_parameter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>

        <span class="c1"># calculate Q function
</span>        <span class="n">Q_new</span> <span class="o">=</span> <span class="n">calc_Q</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">Q_new</span> <span class="o">-</span> <span class="n">Q</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="n">Q_new</span>

    <span class="c1"># result
</span>    <span class="k">print</span> <span class="sa">u</span><span class="s">'mu*: %s, simga*: %s'</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">around</span><span class="p">(</span><span class="n">mu_star</span><span class="p">,</span> <span class="mi">3</span><span class="p">))),</span> <span class="nb">str</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">around</span><span class="p">(</span><span class="n">sigma_star</span><span class="p">,</span> <span class="mi">3</span><span class="p">))))</span>
    <span class="k">print</span> <span class="sa">u</span><span class="s">'mu : %s, sgima : %s'</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">around</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="mi">3</span><span class="p">))),</span> <span class="nb">str</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">around</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">3</span><span class="p">))))</span>

    <span class="c1"># plot
</span>    <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pyplot</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">normed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
    <span class="n">seq</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">pyplot</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">])(</span><span class="n">seq</span><span class="p">),</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">'gmm_graph.png'</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
</div>

<h1>
<span id="結果" class="fragment"></span><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E7%B5%90%E6%9E%9C"><i class="fa fa-link"></i></a>結果</h1>

<p>以下のような結果が得られました．<br>
妥当な推定ができていそうです．</p>

<p><a href="https://camo.qiitausercontent.com/6705b6b07c1ef715e568be76aa00a4025447b58c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f38323532372f62323232353966642d333438642d383238652d666339302d6663623539333162333565362e706e67" target="_blank" rel="nofollow noopener"><img width="600" src="./pythonで混合正規分布実装 - Qiita_files/https___qiita-image-store.s3.amazonaws.com_0_82527_b22259fd-348d-828e-fc90-fcb5931b35e6.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/82527/b22259fd-348d-828e-fc90-fcb5931b35e6.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F82527%2Fb22259fd-348d-828e-fc90-fcb5931b35e6.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=173846dbc77d16b2119919f2db253e25 1x" loading="lazy"></a></p>

<h1>
<span id="おわりに" class="fragment"></span><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>おわりに</h1>

<p>pythonで混合正規分布を実装することができました．<br>
Mステップにおける各パラメータの導出方法やEMアルゴリズムの性質など理解できていない部分があるので，<br>
今後勉強して追記します．</p>
</div></div></section><div class="css-1yzj1fm"><button class="css-l1ga49" type="button" aria-label="twitterでシェア"><span class="fa fa-fw fa-twitter"></span></button><button class="css-l1ga49" type="button" aria-label="facebookでシェア"><span class="fa fa-fw fa-facebook"></span></button></div><div class="css-1un4bh8"><div class="css-1zr5f9">ユーザー登録して、Qiitaをもっと便利に使ってみませんか。</div><ol class="css-dwar2a"><li>あなたにマッチした記事をお届けします<div class="css-1n56tva">ユーザーやタグをフォローすることで、あなたが興味を持つ技術分野の情報をまとめてキャッチアップできます</div></li><li>便利な情報をあとで効率的に読み返せます<div class="css-1n56tva">気に入った記事を「ストック」することで、あとからすぐに検索できます</div></li><div><a href="https://help.qiita.com/ja/articles/qiita-login-user" target="_blank" class="css-1ty75sn"><i class="fa fa-fw fa-arrow-circle-right"></i>より詳しく</a></div></ol><a href="https://qiita.com/signup?callback_action=login_or_signup&amp;redirect_to=%2Ftaka256%2Fitems%2F3e8b127620ac92a32864&amp;realm=qiita" rel="nofollow" class="css-16dbybf">ユーザー登録</a><a href="https://qiita.com/login?callback_action=login_or_signup&amp;redirect_to=%2Ftaka256%2Fitems%2F3e8b127620ac92a32864&amp;realm=qiita" rel="nofollow" class="css-st6exv">ログイン</a></div></div><div class="css-r67lmd"><div><div class="css-k008qs"><div class="css-1jbemfh"><a href="https://qiita.com/taka256"><img loading="lazy" src="./pythonで混合正規分布実装 - Qiita_files/https___qiita-image-store.s3.amazonaws.com_0_82527_profile-images_1473702483" alt="taka256" class="css-yj4pll"></a></div><div><div><a href="https://qiita.com/taka256" class="css-1j67hsy">ta-ka</a></div><div><a href="https://qiita.com/taka256" class="css-k4iwtg">@taka256</a></div><div class="css-mifb2i"><div class="css-52rh9n"><button class="css-10keyvc">フォロー</button></div><div class="css-1b0wzno"><a href="https://github.com/shota-takayama" target="_blank" class="css-9exaa8"><span class="fa fa-fw fa-github css-8fyty9"></span></a><a href="https://twitter.com/shota_takayama" target="_blank" class="css-9exaa8"><span class="fa fa-fw fa-twitter css-8fyty9"></span></a><a href="https://qiita.com/taka256/feed" target="_blank" class="css-9exaa8"><span class="fa fa-fw fa-rss css-8fyty9"></span></a></div></div></div></div><div itemscope="" itemtype="http://schema.org/Organization" class="css-1rwr66l"><div class="css-1jbemfh"><a href="https://qiita.com/organizations/dena_coltd"><img src="./pythonで混合正規分布実装 - Qiita_files/original.jpg" alt="dena_coltd" class="css-ngz6sf"></a></div><div><div><a href="https://qiita.com/organizations/dena_coltd" class="css-1j67hsy">株式会社ディー・エヌ・エー</a></div><div class="css-1lrubrq">We delight people beyond their wildest dreams.</div><div class="css-164r41r"><a href="https://dena.com/jp/" class="css-1jfv0q7">https://dena.com/jp/</a></div><div class="css-wirwc6"><button class="css-10keyvc">フォロー</button></div></div></div></div></div><div class="css-r67lmd"><div><div class="css-1gx4cfw"><div class="css-1hp6i1l"><div id="dfp-slot-article-after-body-for-mobile" class="ad-336x280" data-test-adunitpath="/383564218/qiita.com_items-show_under-article-mobile" elementtiming="gpt-dfp-slot-article-after-body-for-mobile" data-testid="ArticleAdsAfterBody_AdUnit" data-google-query-id="CKnQgabb3vkCFQwNKgodLBsL9w"><div id="google_ads_iframe_/383564218/qiita.com_items-show_under-article-mobile_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/383564218/qiita.com_items-show_under-article-mobile_0" name="google_ads_iframe_/383564218/qiita.com_items-show_under-article-mobile_0" title="3rd party ad content" width="336" height="280" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" role="region" aria-label="Advertisement" tabindex="0" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" style="border: 0px; vertical-align: bottom;" data-load-complete="true" data-google-container-id="3" src="./pythonで混合正規分布実装 - Qiita_files/saved_resource(2).html"></iframe></div></div></div></div></div></div><div class="css-cejglh"><div class="css-lkue19"><div id="logly-lift-4279493"><div class="css-19midj6"><div class="css-8rb5yr"><div class="css-o4x3o"></div><div class="css-hpyit0"><div class="css-u9r1zc"></div><div class="css-u9r1zc"></div><div class="css-u9r1zc"></div></div></div><div class="css-8rb5yr"><div class="css-o4x3o"></div><div class="css-hpyit0"><div class="css-u9r1zc"></div><div class="css-u9r1zc"></div><div class="css-u9r1zc"></div></div></div><div class="css-8rb5yr"><div class="css-o4x3o"></div><div class="css-hpyit0"><div class="css-u9r1zc"></div><div class="css-u9r1zc"></div><div class="css-u9r1zc"></div></div></div><div class="css-8rb5yr"><div class="css-o4x3o"></div><div class="css-hpyit0"><div class="css-u9r1zc"></div><div class="css-u9r1zc"></div><div class="css-u9r1zc"></div></div></div><div class="css-8rb5yr"><div class="css-o4x3o"></div><div class="css-hpyit0"><div class="css-u9r1zc"></div><div class="css-u9r1zc"></div><div class="css-u9r1zc"></div></div></div></div></div></div></div><div><div class="css-cejglh"><div id="comments" class="css-8atqhb"><p class="css-1r0y2zt">コメント</p><div class="css-1gbpb5n">この記事にコメントはありません。</div><div class="css-13b2478"><div class="css-15k3zid">あなたもコメントしてみませんか :)</div><a href="https://qiita.com/signup?callback_action=login_or_signup&amp;redirect_to=https%3A%2F%2Fqiita.com%2Ftaka256%2Fitems%2F3e8b127620ac92a32864&amp;realm=qiita" rel="nofollow" class="css-1f5p3ds">ユーザー登録</a><div class="css-164r41r">すでにアカウントを持っている方は<a href="https://qiita.com/login?callback_action=login_or_signup&amp;redirect_to=https%3A%2F%2Fqiita.com%2Ftaka256%2Fitems%2F3e8b127620ac92a32864&amp;realm=qiita" rel="nofollow">ログイン</a></div></div></div></div></div><div class="css-t60cq9"><span class="css-1t1ffag">記事投稿イベント開催中</span><div class="css-14g0l14"><div class="css-1uyxiwx"><img src="./pythonで混合正規分布実装 - Qiita_files/original(1).jpg" alt="" class="css-7wh13m"></div><div class="css-1bsp11"><span class="css-rcex3m">エンジニア夏休み企画！～自由研究や読書感想文を発表しよう～</span><div class="css-bibwyp"><time datetime="2022-08-14T15:00:00Z">2022/08/15</time><span>~</span><time datetime="2022-09-16T14:59:00Z">2022/09/16</time></div><a href="https://qiita.com/official-events/6d31965c499a69377c0b" class="css-xhf1f8"><button class="css-qgrf2v e1rb7ucl0" font-size="14">イベント詳細を見る</button></a></div></div><div class="css-14g0l14"><div class="css-1uyxiwx"><img src="./pythonで混合正規分布実装 - Qiita_files/original(2).jpg" alt="" class="css-7wh13m"></div><div class="css-1bsp11"><span class="css-rcex3m">Go強化月間～開発する上で知っておくべき知見を共有しよう～</span><div class="css-bibwyp"><time datetime="2022-08-14T15:00:00Z">2022/08/15</time><span>~</span><time datetime="2022-09-16T14:59:00Z">2022/09/16</time></div><a href="https://qiita.com/official-events/ae80b010f51f7018891a" class="css-xhf1f8"><button class="css-qgrf2v e1rb7ucl0" font-size="14">イベント詳細を見る</button></a></div></div><div class="css-14vcyta"><span class="fa fa-fw fa-arrow-circle-right css-15ro776"></span><a href="https://qiita.com/official-events" class="css-p9qzma">すべて見る</a></div></div></div></div></div><div class="css-gjiyxx"><div class="css-5jpx49"><div class="css-10h2231"><div class="css-1duml6f"><div style="width:64px;height:64px;overflow:hidden;margin:0 auto;outline:none;left:50%;position:absolute;top:50%;transform:translate(-50%, -50%)" title="" role="" aria-label="animation" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="64" height="64" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: 100%; transform: translate3d(0px, 0px, 0px); content-visibility: visible;"><defs><clippath id="__lottie_element_58"><rect width="64" height="64" x="0" y="0"></rect></clippath><mask id="__lottie_element_89" mask-type="alpha"><g style="display: none;"><g><path></path></g></g></mask></defs><g clip-path="url(#__lottie_element_58)"><g transform="matrix(1,0,0,1,11,11)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,21,21)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M0,-19 C0,-19 0,-19 0,-19 C10.493000030517578,-19 19,-10.494000434875488 19,0 C19,10.493000030517578 10.493000030517578,19 0,19 C-10.494000434875488,19 -19,10.493000030517578 -19,0 C-19,-10.494000434875488 -10.494000434875488,-19 0,-19z"></path><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="4" stroke="rgb(85,197,0)" stroke-opacity="1" stroke-width="2" d=" M0,-19 C0,-19 0,-19 0,-19 C10.493000030517578,-19 19,-10.494000434875488 19,0 C19,10.493000030517578 10.493000030517578,19 0,19 C-10.494000434875488,19 -19,10.493000030517578 -19,0 C-19,-10.494000434875488 -10.494000434875488,-19 0,-19z"></path></g></g><g transform="matrix(1,0,0,1,31.253000259399414,32.73200225830078)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,5.218999862670898,4.959000110626221)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-0.33500000834465027,2.4159998893737793 C-0.33500000834465027,2.4159998893737793 -2.3550000190734863,-0.5899999737739563 -2.3550000190734863,-0.5899999737739563 C-2.3550000190734863,-0.5899999737739563 -2.3550000190734863,4.709000110626221 -2.3550000190734863,4.709000110626221 C-2.3550000190734863,4.709000110626221 -4.968999862670898,4.709000110626221 -4.968999862670898,4.709000110626221 C-4.968999862670898,4.709000110626221 -4.968999862670898,-4.709000110626221 -4.968999862670898,-4.709000110626221 C-4.968999862670898,-4.709000110626221 -2.6670000553131104,-4.709000110626221 -2.6670000553131104,-4.709000110626221 C-2.6670000553131104,-4.709000110626221 -0.01600000075995922,-0.9629999995231628 -0.01600000075995922,-0.9629999995231628 C-0.01600000075995922,-0.9629999995231628 2.694999933242798,-4.709000110626221 2.694999933242798,-4.709000110626221 C2.694999933242798,-4.709000110626221 4.968999862670898,-4.709000110626221 4.968999862670898,-4.709000110626221 C4.968999862670898,-4.709000110626221 4.968999862670898,4.709000110626221 4.968999862670898,4.709000110626221 C4.968999862670898,4.709000110626221 2.3550000190734863,4.709000110626221 2.3550000190734863,4.709000110626221 C2.3550000190734863,4.709000110626221 2.3550000190734863,-0.5609999895095825 2.3550000190734863,-0.5609999895095825 C2.3550000190734863,-0.5609999895095825 0.3009999990463257,2.4159998893737793 0.3009999990463257,2.4159998893737793 C0.3009999990463257,2.4159998893737793 -0.33500000834465027,2.4159998893737793 -0.33500000834465027,2.4159998893737793z"></path></g></g><g transform="matrix(1,0,0,1,22.149999618530273,32.72599792480469)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,4.031000137329102,4.961999893188477)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-1.2940000295639038,-2.5350000858306885 C-1.2940000295639038,-2.5350000858306885 -3.7809998989105225,-2.5350000858306885 -3.7809998989105225,-2.5350000858306885 C-3.7809998989105225,-2.5350000858306885 -3.7809998989105225,-4.711999893188477 -3.7809998989105225,-4.711999893188477 C-3.7809998989105225,-4.711999893188477 3.7809998989105225,-4.711999893188477 3.7809998989105225,-4.711999893188477 C3.7809998989105225,-4.711999893188477 3.7809998989105225,-2.5350000858306885 3.7809998989105225,-2.5350000858306885 C3.7809998989105225,-2.5350000858306885 1.2990000247955322,-2.5350000858306885 1.2990000247955322,-2.5350000858306885 C1.2990000247955322,-2.5350000858306885 1.2990000247955322,4.711999893188477 1.2990000247955322,4.711999893188477 C1.2990000247955322,4.711999893188477 -1.2940000295639038,4.711999893188477 -1.2940000295639038,4.711999893188477 C-1.2940000295639038,4.711999893188477 -1.2940000295639038,-2.5350000858306885 -1.2940000295639038,-2.5350000858306885z"></path></g></g><g transform="matrix(1,0,0,1,31.006000518798828,21.350000381469727)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,5.2769999504089355,5.206999778747559)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M0.09700000286102295,-0.40400001406669617 C0.09700000286102295,-0.40400001406669617 4.982999801635742,-0.40400001406669617 4.982999801635742,-0.40400001406669617 C5.0269999504089355,0.4059999883174896 4.934000015258789,1.1369999647140503 4.705999851226807,1.7960000038146973 C4.484000205993652,2.4549999237060547 4.1539998054504395,3.0169999599456787 3.7219998836517334,3.48799991607666 C3.2909998893737793,3.9570000171661377 2.7730000019073486,4.322000026702881 2.1659998893737793,4.573999881744385 C1.5609999895095825,4.830999851226807 0.8970000147819519,4.955999851226807 0.18400000035762787,4.955999851226807 C-0.5389999747276306,4.955999851226807 -1.2170000076293945,4.824999809265137 -1.847000002861023,4.567999839782715 C-2.4769999980926514,4.310999870300293 -3.0299999713897705,3.9579999446868896 -3.5,3.507999897003174 C-3.9700000286102295,3.056999921798706 -4.3429999351501465,2.5339999198913574 -4.614999771118164,1.9279999732971191 C-4.886000156402588,1.3220000267028809 -5.0269999504089355,0.6809999942779541 -5.0269999504089355,-0.007000000216066837 C-5.0269999504089355,-0.6949999928474426 -4.890999794006348,-1.340000033378601 -4.614999771118164,-1.940999984741211 C-4.339000225067139,-2.5369999408721924 -3.9700000286102295,-3.065999984741211 -3.5,-3.51200008392334 C-3.0299999713897705,-3.9630000591278076 -2.4769999980926514,-4.310999870300293 -1.847000002861023,-4.567999839782715 C-1.2170000076293945,-4.824999809265137 -0.5389999747276306,-4.955999851226807 0.18400000035762787,-4.955999851226807 C0.9100000262260437,-4.955999851226807 1.5889999866485596,-4.824999809265137 2.2200000286102295,-4.567999839782715 C2.8499999046325684,-4.310999870300293 3.4079999923706055,-3.947000026702881 3.8970000743865967,-3.4769999980926514 C3.8970000743865967,-3.4769999980926514 2.196000099182129,-1.7769999504089355 2.196000099182129,-1.7769999504089355 C1.968000054359436,-2.0820000171661377 1.6820000410079956,-2.322999954223633 1.3320000171661377,-2.503000020980835 C0.984000027179718,-2.681999921798706 0.6010000109672546,-2.7750000953674316 0.17900000512599945,-2.7750000953674316 C-0.17900000512599945,-2.7750000953674316 -0.5189999938011169,-2.7019999027252197 -0.8339999914169312,-2.561000108718872 C-1.1490000486373901,-2.4210000038146973 -1.4210000038146973,-2.2269999980926514 -1.6579999923706055,-1.9800000190734863 C-1.8899999856948853,-1.7319999933242798 -2.075000047683716,-1.4420000314712524 -2.2160000801086426,-1.1019999980926514 C-2.3510000705718994,-0.7630000114440918 -2.4200000762939453,-0.39399999380111694 -2.4200000762939453,0.003000000026077032 C-2.4200000762939453,0.3959999978542328 -2.3510000705718994,0.7630000114440918 -2.2160000801086426,1.1019999980926514 C-2.0799999237060547,1.4420000314712524 -1.8960000276565552,1.7389999628067017 -1.6579999923706055,1.9859999418258667 C-1.4249999523162842,2.2330000400543213 -1.1490000486373901,2.4260001182556152 -0.8339999914169312,2.565999984741211 C-0.5189999938011169,2.7070000171661377 -0.17900000512599945,2.7809998989105225 0.17900000512599945,2.7809998989105225 C0.8330000042915344,2.7809998989105225 1.3320000171661377,2.6589999198913574 1.687000036239624,2.4170000553131104 C2.0399999618530273,2.174999952316284 2.2730000019073486,1.840000033378601 2.3889999389648438,1.4229999780654907 C2.3889999389648438,1.4229999780654907 0.09200000017881393,1.4229999780654907 0.09200000017881393,1.4229999780654907 C0.09200000017881393,1.4229999780654907 0.09700000286102295,-0.40400001406669617 0.09700000286102295,-0.40400001406669617z"></path></g></g><g transform="matrix(1,0,0,1,22.730998992919922,21.097000122070312)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,3.73799991607666,4.961999893188477)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-3.48799991607666,-4.711999893188477 C-3.48799991607666,-4.711999893188477 -0.875,-4.711999893188477 -0.875,-4.711999893188477 C-0.875,-4.711999893188477 -0.875,2.5360000133514404 -0.875,2.5360000133514404 C-0.875,2.5360000133514404 3.48799991607666,2.5360000133514404 3.48799991607666,2.5360000133514404 C3.48799991607666,2.5360000133514404 3.48799991607666,4.711999893188477 3.48799991607666,4.711999893188477 C3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 C-3.48799991607666,4.711999893188477 -3.48799991607666,-4.711999893188477 -3.48799991607666,-4.711999893188477z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(85,197,0)" fill-opacity="1" d=" M-123.23100280761719,105.90299987792969"></path></g></g><g style="display: none;"><g><path></path></g></g><g mask="url(#__lottie_element_89)" style="display: block;"><g transform="matrix(1,0,0,1,22.730998992919922,21.097000122070312)" opacity="1"><g opacity="1" transform="matrix(1,0,0,1,3.73799991607666,4.961999893188477)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M-3.48799991607666,-4.711999893188477 C-3.48799991607666,-4.711999893188477 -0.875,-4.711999893188477 -0.875,-4.711999893188477 C-0.875,-4.711999893188477 -0.875,2.5360000133514404 -0.875,2.5360000133514404 C-0.875,2.5360000133514404 3.48799991607666,2.5360000133514404 3.48799991607666,2.5360000133514404 C3.48799991607666,2.5360000133514404 3.48799991607666,4.711999893188477 3.48799991607666,4.711999893188477 C3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 -3.48799991607666,4.711999893188477 C-3.48799991607666,4.711999893188477 -3.48799991607666,-4.711999893188477 -3.48799991607666,-4.711999893188477z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M-123.23100280761719,105.90299987792969"></path></g></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g><g style="display: none;"><g><path></path></g></g></g></svg></div><div class=""><button class="css-nje458"></button></div></div><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864/likers" aria-label="77LGTM" class="css-3ebp5j">77</a></div><div class="css-92283"><button class=" css-nb6j9u"><svg size="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.02 398" color="#5f6161" class="css-kfddif e11v00bf0"><path d="M176.72 398c-67.52 0-130.16-29-171.84-79.69l-4.46-5.42V78.05H353v234.84l-4.45 5.42C306.88 369 244.24 398 176.72 398zm-137.2-99.34c34.17 38.37 83.78 60.25 137.2 60.25s103-21.88 137.21-60.25V117.14H39.52zM0 0h351.12v40.94H0z"></path></svg></button><span class="css-1o09fmu">67</span></div><div class="css-79elbk"><button type="button" aria-label="オプションを開く" class="css-1ydfkyi"><span class="fa fa-fw fa-ellipsis-h"></span></button><div class="css-7i7f4d"><div class="css-1gj7nt">記事の改善</div><a href="https://qiita.com/drafts/3e8b127620ac92a32864/edit" rel="nofollow" class="css-1g6mqq7"><span class="fa fa-fw fa-code-fork css-amwp7n" aria-hidden="true"></span>編集リクエストを送る</a><div class="css-1ode1bp"></div><div class="css-1gj7nt">記事の情報</div><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864/revisions" rel="nofollow" class="css-1g6mqq7"><span class="fa fa-fw fa-history css-amwp7n" aria-hidden="true"></span>編集履歴</a><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864/patches" class="css-1g6mqq7"><span class="fa fa-fw fa-inbox css-amwp7n" aria-hidden="true"></span>編集リクエスト一覧</a><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864/likers" class="css-1g6mqq7"><span class="css-x9qlq8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="css-2ycz42"><path d="M19.1734 4.42307H14.4619L14.2696 6.15384H16.4811C16.385 6.53845 16.1927 6.92307 15.8081 7.11538C15.5196 7.40384 15.0388 7.49999 14.3658 7.49999C14.0773 7.49999 13.6927 7.40384 13.4042 7.30768C13.1158 7.11538 12.8273 6.92307 12.635 6.73076C12.3465 6.4423 12.1542 6.15384 12.0581 5.86538C11.9619 5.57692 11.8658 5.1923 11.8658 4.80769C11.8658 4.42307 11.9619 4.03846 12.0581 3.75C12.2504 3.36538 12.4427 3.07692 12.635 2.88461C12.8273 2.59615 13.1158 2.40384 13.4042 2.30769C13.6927 2.21154 13.9811 2.11538 14.3658 2.11538C14.8465 2.11538 15.2311 2.21154 15.5196 2.40384C15.9042 2.59615 16.1927 2.78846 16.385 3.07692L18.0196 1.44231C17.5388 0.961537 16.9619 0.673076 16.385 0.384615C15.8081 0.0961533 15.135 0 14.4619 0C13.7888 0 13.1158 0.0961533 12.5388 0.384615C11.8658 0.673076 11.385 0.961537 10.9042 1.44231C10.4235 1.92307 10.135 2.40384 9.84653 2.98077C9.55807 3.55769 9.46191 4.13461 9.46191 4.80769C9.46191 5.48076 9.55807 6.05768 9.84653 6.63461C10.135 7.21153 10.4235 7.6923 10.9042 8.17307C11.385 8.65384 11.9619 8.9423 12.5388 9.23076C13.1158 9.51922 13.7888 9.61537 14.4619 9.61537C15.135 9.61537 15.8081 9.51922 16.385 9.23076C16.9619 8.9423 17.5388 8.65384 17.9234 8.17307C18.3081 7.6923 18.6927 7.21153 18.885 6.53845C19.1734 5.86538 19.1734 5.19229 19.1734 4.42307Z"></path><path d="M4.07715 0.192322H1.57715V9.23077H8.30791V7.11539H4.07715V0.192322Z"></path><path d="M3.40384 13.0769H1V10.9615H8.30768V13.0769H5.90384V20H3.40384V13.0769Z"></path><path d="M12.25 14.9039L14.1731 17.7885H14.8461L16.8654 14.9039V20H19.3654V10.9615H17.1538L14.5577 14.5192L11.9615 10.9615H9.75V20H12.25V14.9039Z"></path></svg></span>LGTMしたユーザー一覧</a><a href="https://qiita.com/taka256/items/3e8b127620ac92a32864.md" rel="nofollow" class="css-1g6mqq7"><span class="fa fa-fw fa-file-text-o css-amwp7n" aria-hidden="true"></span>Markdown で本文を見る</a><div class="css-1ode1bp"></div><button class="css-1nt9rv7"><span class="fa fa-fw fa-flag css-amwp7n" aria-hidden="true"></span>問題がある記事を報告する</button></div><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><form><div class="st-Form"><span class="st-Form_label">どのような問題がありますか？</span></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="CommunityGuidelineViolation">コミュニティガイドライン違反</label></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="IllegalViolation">法律違反</label></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="SociallyInappropriate">社会的に不適切</label></div><div class="st-Form"><label><input type="checkbox" class="st-Form_checkbox" value="SuspectedSpam">スパムの疑い</label></div><div class="st-Form st-Form-right"><button type="submit" class="css-qgrf2v e1rb7ucl0" disabled="" font-size="14">送信</button></div></form></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="PersonalArticlePage" data-dom-id="PersonalArticlePage-react-component-88129006-5b5e-4a58-a321-34f5817d54a8">{"authorAnalyticsTrackingId":null,"organizationAnalyticsTrackingId":null,"headerBanner":null,"promptLoginMessageImageSrc":"//cdn.qiita.com/assets/public/qiitan-for-login-modal-014e085d3e40a240e3fe8d61b70b29a9.png"}</script>
      
<script src="./pythonで混合正規分布実装 - Qiita_files/td_qt_access.js" type="text/javascript"></script><script>microadTd.QT.start({"article_category": "Python,機械学習"})</script><script>(function(d,u){var b=d.getElementsByTagName("script")[0],j=d.createElement("script");j.async=true;j.src=u;b.parentNode.insertBefore(j,b);})(document,"//img.ak.impact-ad.jp/ut/ff9a3577423c8ed5_4330.js");</script><noscript><iframe frameborder="0" height="0" src="//nspt.unitag.jp/ff9a3577423c8ed5_4330.php" width="0"></iframe></noscript><script async="" src="./pythonで混合正規分布実装 - Qiita_files/js(2)"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'AW-878053044');</script><script>!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1792588824374455');
fbq('track', 'PageView');</script><noscript><img height="1" src="https://www.facebook.com/tr?id=1792588824374455&amp;ev=PageView&amp;noscript=1" style="display:none" width="1" /></noscript><footer id="globalfooter" class="st-footer"><div class="st-footer_container"><div class="st-footer_start"><div class="st-footer_signature"><a class="st-footer_logo" aria-label="トップに戻る" href="https://qiita.com/"><svg alt="" role="presentation" viewBox="0 0 426.57 130" xmlns="http://www.w3.org/2000/svg"><circle cx="167.08" cy="21.4" r="12.28"></circle><path d="M250.81 29.66h23.48v18.9h-23.48z"></path><path d="M300.76 105.26a22.23 22.23 0 01-6.26-.86 12.68 12.68 0 01-5.17-3 14.41 14.41 0 01-3.56-5.76 28 28 0 01-1.3-9.22V48.56h29.61v-18.9h-29.52V3.29h-20.17v83.34q0 11.16 2.83 18.27a27.71 27.71 0 007.7 11.2 26.86 26.86 0 0011.43 5.62 47.56 47.56 0 0012.34 1.53h15.16v-18zM0 61.7a58.6 58.6 0 015-24.21A62.26 62.26 0 0118.73 17.9 63.72 63.72 0 0139 4.78 64.93 64.93 0 0164 0a65 65 0 0124.85 4.78 64.24 64.24 0 0120.38 13.12A62 62 0 01123 37.49a58.6 58.6 0 015 24.21 58.34 58.34 0 01-4 21.46 62.8 62.8 0 01-10.91 18.16l11.1 11.1a10.3 10.3 0 010 14.52 10.29 10.29 0 01-14.64 0l-12.22-12.41a65 65 0 01-15.78 6.65 66.32 66.32 0 01-17.55 2.3 64.63 64.63 0 01-45.23-18A62.82 62.82 0 015 85.81 58.3 58.3 0 010 61.7zm21.64.08a43.13 43.13 0 0012.42 30.63 42.23 42.23 0 0013.43 9.09A41.31 41.31 0 0064 104.8a42 42 0 0030-12.39 42.37 42.37 0 009-13.64 43.43 43.43 0 003.3-17 43.77 43.77 0 00-3.3-17A41.7 41.7 0 0080.55 22 41.78 41.78 0 0064 18.68 41.31 41.31 0 0047.49 22a42.37 42.37 0 00-13.43 9.08 43.37 43.37 0 00-12.42 30.7zM331.89 78a47.59 47.59 0 013.3-17.73 43.22 43.22 0 019.34-14.47A44.25 44.25 0 01359 36a47.82 47.82 0 0118.81-3.58 42.72 42.72 0 019.26 1 46.5 46.5 0 018.22 2.58 40 40 0 017 3.84 44.39 44.39 0 015.71 4.63l1.22-9.47h17.35v85.83h-17.35l-1.17-9.42a42.54 42.54 0 01-5.84 4.67 43.11 43.11 0 01-7 3.79 44.86 44.86 0 01-8.17 2.59 43 43 0 01-9.22 1A47.94 47.94 0 01359 119.9a43.3 43.3 0 01-14.47-9.71 44.17 44.17 0 01-9.34-14.47 47 47 0 01-3.3-17.72zm20.27-.08a29.16 29.16 0 002.17 11.34 27 27 0 005.92 8.88 26.69 26.69 0 008.76 5.76 29.19 29.19 0 0021.44 0 26.11 26.11 0 008.72-5.76 27.57 27.57 0 005.88-8.84 29 29 0 002.16-11.38 28.62 28.62 0 00-2.16-11.22 26.57 26.57 0 00-5.93-8.8 27.68 27.68 0 00-19.51-7.9 28.29 28.29 0 00-10.77 2.05 26.19 26.19 0 00-8.71 5.75 27.08 27.08 0 00-5.84 8.8 28.94 28.94 0 00-2.13 11.31zm-194.97-30.5h19.78v73.54h-19.78zm49.25 0h19.78v73.54h-19.78z"></path><circle cx="216.33" cy="21.4" r="12.28"></circle></svg></a><div class="st-footer_catchcopy">How developers code is here.</div></div><small class="st-footer_copyright">© 2011-2022<span class="ml-1of2" translate="no">Qiita Inc.</span></small></div><nav class="st-footer_navigation"><dl class="st-footer_menu"><dt class="st-footer_menuTitle">ガイドとヘルプ</dt><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/about">About</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/terms">利用規約</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/privacy">プライバシーポリシー</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="http://help.qiita.com/ja/articles/qiita-community-guideline">ガイドライン</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://help.qiita.com/ja/articles/others-brand-guideline">デザインガイドライン</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://github.com/increments/qiita-discussions/discussions/116">ご意見</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://help.qiita.com/">ヘルプ</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://qiita.com/ads?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">広告掲載</a></dd></dl><dl class="st-footer_menu"><dt class="st-footer_menuTitle">コンテンツ</dt><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/release-notes">リリースノート</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/official-events">公式イベント</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/official-columns">公式コラム</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/opportunities">募集</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/advent-calendar/2021">アドベントカレンダー</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/qiita-award">Qiita 表彰プログラム</a></dd><dd class="st-footer_menuItem"><a class="st-footer_menuLink" href="https://qiita.com/api/v2/docs">API</a></dd></dl><dl class="st-footer_menu"><dt class="st-footer_menuTitle">SNS</dt><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://twitter.com/qiita"><span aria-label="Twitter" class="fa fa-fw fa-twitter"></span><span class="ml-1of2">Qiita（キータ）公式</span></a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://twitter.com/qiita_milestone"><span aria-label="Twitter" class="fa fa-fw fa-twitter"></span><span class="ml-1of2">Qiita マイルストーン</span></a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://twitter.com/qiitapoi"><span aria-label="Twitter" class="fa fa-fw fa-twitter"></span><span class="ml-1of2">Qiita 人気の投稿</span></a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://www.facebook.com/qiita/"><span aria-label="Facebook" class="fa fa-fw fa-facebook-square"></span><span class="ml-1of2">Qiita（キータ）公式</span></a></dd></dl><dl class="st-footer_menu"><dt class="st-footer_menuTitle">Qiita 関連サービス</dt><dd class="st-footer_menuItem"><a target="_blank" rel="noopener" class="st-footer_menuLink" href="https://teams.qiita.com/">Qiita Team</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener" class="st-footer_menuLink" href="https://jobs.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Jobs</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener" class="st-footer_menuLink" href="https://zine.qiita.com/?utm_source=qiita&amp;utm_medium=referral&amp;utm_content=footer">Qiita Zine</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener noreferrer" class="st-footer_menuLink" href="https://suzuri.jp/qiita">Qiita 公式ショップ</a></dd></dl><dl class="st-footer_menu"><dt class="st-footer_menuTitle">運営</dt><dd class="st-footer_menuItem"><a target="_blank" rel="noopener" class="st-footer_menuLink" href="https://corp.qiita.com/company/">運営会社</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener" class="st-footer_menuLink" href="https://corp.qiita.com/jobs/">採用情報</a></dd><dd class="st-footer_menuItem"><a target="_blank" rel="noopener" class="st-footer_menuLink" href="https://blog.qiita.com/">Qiita Blog</a></dd></dl></nav></div></footer><div id="Snackbar-react-component-db5a8c46-7eab-4d69-9e05-ab4bb861a76d"></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Snackbar" data-dom-id="Snackbar-react-component-db5a8c46-7eab-4d69-9e05-ab4bb861a76d">{}</script>
      
<div id="LoginModal-react-component-e1c6d98e-6545-475f-8e99-dd613156e1af"><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body"><div class="css-gg4vpm"><div class="css-1tbyqbm">ユーザー登録して、Qiitaをもっと便利に使ってみませんか</div><button aria-label="閉じる" class="fa fa-fw fa-times css-yh67nw"></button></div><p class="css-1mi8o62">この機能を利用するにはログインする必要があります。ログインするとさらに下記の機能が使えます。</p><div class="css-ryur0b"><div><ol class="css-26shl7"><li>ユーザーやタグのフォロー機能であなたにマッチした記事をお届け</li><li class="css-1yuhvjn">ストック機能で便利な情報を後から効率的に読み返せる</li></ol><a href="https://qiita.com/signup?callback_action=login_or_signup&amp;redirect_to=%2Ftaka256%2Fitems%2F3e8b127620ac92a32864&amp;realm=qiita" rel="nofollow" class="css-eln2kn">ユーザー登録</a><a href="https://qiita.com/login?callback_action=login_or_signup&amp;redirect_to=%2Ftaka256%2Fitems%2F3e8b127620ac92a32864&amp;realm=qiita" rel="nofollow" class="css-1197zgb">ログイン</a></div><img src="./pythonで混合正規分布実装 - Qiita_files/qiitan-for-login-modal-014e085d3e40a240e3fe8d61b70b29a9.png" alt="" class="css-1x1nsjm"></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="LoginModal" data-dom-id="LoginModal-react-component-e1c6d98e-6545-475f-8e99-dd613156e1af">{"imageUrl":"//cdn.qiita.com/assets/public/qiitan-for-login-modal-014e085d3e40a240e3fe8d61b70b29a9.png"}</script>
      
<div id="StockModal-react-component-0d9bc8e3-328d-458c-961e-0a7c46c35807"><div class="st-Modal"><div class="st-Modal_backdrop"></div><div class="st-Modal_body css-tlvft"><div class="css-e5tuit"><div class="css-1gykiw6">ストックするカテゴリー</div><button type="button" class="css-g11wic"><span class="fa fa-times fa-fw css-1wvl6ln"></span></button></div><div class="css-1elw6c9"></div><div class="css-19midj6"><button type="button" class="css-1mteic8"><span class="fa fa-plus fa-fw css-45hdgn"></span><div class="css-6ozust">カテゴリーの新規作成</div></button></div><div class="css-1mkdie5"><button class="css-b1sfia e1rb7ucl0" disabled="" font-size="14">保存する</button></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="StockModal" data-dom-id="StockModal-react-component-0d9bc8e3-328d-458c-961e-0a7c46c35807">{}</script>
      
</div><script type="text/javascript" charset="UTF-8">!function(t,e){if(void 0===e[t]){e[t]=function(){e[t].clients.push(this),this._init=[Array.prototype.slice.call(arguments)]},e[t].clients=[];for(var r=function(t){return function(){return this["_"+t]=this["_"+t]||[],this["_"+t].push(Array.prototype.slice.call(arguments)),this}},s=["blockEvents","unblockEvents","setSignedMode","setAnonymousMode","resetUUID","addRecord","fetchGlobalID","set","trackEvent","trackPageview","trackClicks","ready"],n=0;n<s.length;n++){var c=s[n];e[t].prototype[c]=r(c)}var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=("https:"===document.location.protocol?"https:":"http:")+"//cdn.treasuredata.com/sdk/2.1/td.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)}}("Treasure",this);</script><script type="text/javascript" charset="UTF-8" src="./pythonで混合正規分布実装 - Qiita_files/aid"></script><img width="0px" height="0px" src="./pythonで混合正規分布実装 - Qiita_files/tr" style="display: none;"><div id="dataContainer" style="display: none;" data-config="{&quot;actionPath&quot;:&quot;public/items#show&quot;,&quot;settings&quot;:{&quot;analyticsTrackingId&quot;:&quot;UA-24675221-12&quot;,&quot;assetsMap&quot;:{},&quot;csrfToken&quot;:&quot;j/8kCcsk6PxuHKI7Q8oRzbWvRV2DjSIKMR9QLXqEPdR9UhpynDd2iaMCL0XaF6fAjjOzwiL6ILDjP5p6w89oJg==&quot;,&quot;locale&quot;:&quot;ja&quot;},&quot;currentUser&quot;:null}"><script type="application/json" data-js-react-on-rails-store="AppStoreWithReactOnRails">{"snackbar":{"type":"","body":"","isActive":false},"article":{"article":{"body":"\n\u003ch1\u003e\n\u003cspan id=\"はじめに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eはじめに\u003c/h1\u003e\n\n\u003cp\u003epythonで混合正規分布を実装しました．\u003cbr\u003e\n教科書として\u003ca href=\"https://www.amazon.co.jp/%E3%81%AF%E3%81%98%E3%82%81%E3%81%A6%E3%81%AE%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E8%AA%8D%E8%AD%98-%E5%B9%B3%E4%BA%95-%E6%9C%89%E4%B8%89/dp/4627849710\" rel=\"nofollow noopener\" target=\"_blank\"\u003e『はじめてのパターン認識』\u003c/a\u003eを使いました．\u003c/p\u003e\n\n\u003cp\u003e本記事の構成\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eはじめに\u003c/li\u003e\n\u003cli\u003e混合正規分布\n\n\u003cul\u003e\n\u003cli\u003e混合正規分布モデル\u003c/li\u003e\n\u003cli\u003e隠れ変数と事後確率\u003c/li\u003e\n\u003cli\u003e対数尤度とQ関数\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eEMアルゴリズムによるパラメータ推定\u003c/li\u003e\n\u003cli\u003epythonでの実装\u003c/li\u003e\n\u003cli\u003e結果\u003c/li\u003e\n\u003cli\u003eおわりに\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"混合正規分布\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e混合正規分布\u003c/h1\u003e\n\n\u003cp\u003eデータ分布に確率モデルを当てはめると，各データがどのクラスタに属するかを確率的に決めることができます．\u003cbr\u003e\n多くの確率モデルは単峰性の確率分布しか表現できないため，全体の確率分布を複数の確率モデルの重み付け線形和でモデル化する必要があります．\u003cbr\u003e\nクラスタ数を $K$，$k$ 番目のクラスタの確率モデルを $p_k(\\boldsymbol x)$ とし，全体の確率分布を以下のように表します．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003ep(\\boldsymbol x) = \\sum_{k = 1}^K \\pi_kp_k(\\boldsymbol x)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e$\\pi_k$ は $k$ 番目の確率モデルの重みとなります．\u003cbr\u003e\n確率モデルとして正規分布を用いたものを \u003cstrong\u003e混合正規分布モデル\u003c/strong\u003e と呼びます．\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"混合正規分布モデル\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%83%A2%E3%83%87%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e混合正規分布モデル\u003c/h2\u003e\n\n\u003cp\u003e$k$ 番目のクラスタを表す $d$ 次元正規分布関数を以下のように表します．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003eN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k) = \\frac{1}{(2\\pi)^{1/d} \\ |\\boldsymbol \\Sigma_k|^{1/2}}\\exp\\bigl(-\\frac{1}{2}(\\boldsymbol x - \\boldsymbol \\mu_k)^T \\boldsymbol \\Sigma_k^{-1}(\\boldsymbol x - \\boldsymbol \\mu_k)\\bigr)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e全体の分布は，これらの線形和として表されます．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003ep(\\boldsymbol x) = \\sum_k^K \\pi_k N(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k), \\ 0 \\leq \\pi_k \\leq 1, \\ \\sum_{k = 1}^K \\pi_k = 1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e$\\pi_k$ を混合比と呼び，混合正規分布モデルのパラメータは以下になります．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\boldsymbol \\pi = (\\pi_1, ..., \\pi_K), \\ \\boldsymbol \\mu = (\\boldsymbol \\mu_1, ..., \\boldsymbol \\mu_K), \\ \\boldsymbol \\Sigma = (\\boldsymbol \\Sigma_1, ..., \\boldsymbol \\Sigma_K)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e全体のデータをうまく表現できるような $\\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma$ が必要となります．\u003cbr\u003e\nしかし，各データがどのクラスタに属するかは不明であるため，各パラメータを直接求めることはできません．\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"隠れ変数と事後確率\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%9A%A0%E3%82%8C%E5%A4%89%E6%95%B0%E3%81%A8%E4%BA%8B%E5%BE%8C%E7%A2%BA%E7%8E%87\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e隠れ変数と事後確率\u003c/h2\u003e\n\n\u003cp\u003e混合正規分布モデルでは，全体のデータから $\\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma$ を推定するために，\u003cbr\u003e\n各データ $\\boldsymbol x$ がどのクラスタに属するかを表す $K$ 次元の隠れ変数 $\\boldsymbol z = (z_1, ..., z_K)^T$ を導入します．\u003cbr\u003e\n$z_k$ は，データが $k$ 番目のクラスタに属していれば $1$，属していなければ $0$ をとります．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\sum_{k = 1}^K z_k = 1, \\ \\boldsymbol z = (0, ..., 0, 1, 0, ..., 0)^T\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e観測される $\\boldsymbol x$ と 隠れ変数 $\\boldsymbol z$ の同時分布 $p(\\boldsymbol x, \\boldsymbol z)$  は以下になります．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003ep(\\boldsymbol x, \\boldsymbol z) = p(\\boldsymbol z)p(\\boldsymbol x \\ | \\ \\boldsymbol z)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eまた，隠れ変数の分布 $p(\\boldsymbol z)$ および観測データの隠れ変数による条件付き分布 $p(\\boldsymbol x \\ | \\ \\boldsymbol z)$ は以下のように表せます．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{align}\n\u0026amp; p(\\boldsymbol z) = \\prod_{k = 1}^K \\pi_k^{z_k} \\\\\n\u0026amp; p(\\boldsymbol x \\ | \\ \\boldsymbol z) = \\prod_{k = 1}^K \\big[N(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k)\\bigr]^{z_k}\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eさらに，同時分布 $p(\\boldsymbol x, \\boldsymbol z)$ をすべての $\\boldsymbol z$ について加えることで，$p(\\boldsymbol x)$ を求めることができます．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{align}\np(\\boldsymbol x) \u0026amp;= \\sum_{\\substack{k = 1 \\\\ (z_k = 1, z_{j \\neq k} = 0)}}^K p(\\boldsymbol x, \\boldsymbol z) \\\\\n\u0026amp;= \\sum_{\\substack{k = 1 \\\\ (z_k = 1, z_{j \\neq k} = 0)}}^K p(\\boldsymbol z)p(\\boldsymbol x \\ | \\ \\boldsymbol z) \\\\\n\u0026amp;= \\sum_{\\substack{k = 1 \\\\ (z_k = 1, z_{j \\neq k} = 0)}}^K \\prod_{k = 1}^K \\pi_k^{z_k} \\prod_{k = 1}^K \\big[N(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k)\\bigr]^{z_k} \\\\\n\u0026amp;= \\sum_{k = 1}^K \\pi_kN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k)\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e以上の分布を用いると，隠れ変数の事後確率 $\\gamma(z_k)$ は以下のように表されます．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{align}\n\\gamma(z_k) \u0026amp;\\equiv p(z_k = 1 \\ | \\ \\boldsymbol x) \\\\\n\u0026amp;\\\\\n\u0026amp;= \\frac{p(z_k = 1)p(\\boldsymbol x \\ | \\ z_k = 1)}{\\sum_{j = 1}^K p(z_j = 1)p(\\boldsymbol x \\ | \\ z_j = 1)} \\\\\n\u0026amp;\\\\\n\u0026amp;= \\frac{\\pi_kN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k)}{\\sum_{j = 1}^K \\pi_jN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_j, \\boldsymbol \\Sigma_j)} \\tag{*}\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"対数尤度とq関数\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AF%BE%E6%95%B0%E5%B0%A4%E5%BA%A6%E3%81%A8q%E9%96%A2%E6%95%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e対数尤度とQ関数\u003c/h2\u003e\n\n\u003cp\u003e観測データ $\\boldsymbol X$ および隠れ変数 $\\boldsymbol Z$ を以下のように表します．\u003cbr\u003e\n$C_k$ は，クラスタ $k$ を表します．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{align}\n\u0026amp; \\boldsymbol X = (\\boldsymbol x_1, ..., \\boldsymbol x_N), \\ \\boldsymbol x_i = (x_{i1}, ..., x_{id})^T \\\\\n\u0026amp; \\boldsymbol Z = (\\boldsymbol z_1, ..., \\boldsymbol z_N), \\ \\boldsymbol z_i = (z_{i1}, ..., z_{iK})^T \\\\\n\u0026amp; z_{ik} = \\begin{cases}\n1 \\ (x_i \\in C_k) \\\\\n0 \\ (x_i \\notin C_k)\n\\end{cases}\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e観測データと隠れ変数を合わせた集合を完全データと呼びます．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\boldsymbol Y = (\\boldsymbol x_1, ..., \\boldsymbol x_N, \\boldsymbol z_1, ..., \\boldsymbol z_N) = (\\boldsymbol X, \\boldsymbol Z)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e混合正規分布のパラメータ $\\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma$ は，完全データの尤度を最大にするパラメータで求めることとします．\u003cbr\u003e\n完全データの尤度は以下のように表せます．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{align}\np(\\boldsymbol Y \\ | \\ \\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma) \u0026amp;= p(\\boldsymbol Z \\ | \\ \\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma) p(\\boldsymbol X \\ | \\ \\boldsymbol Z, \\ \\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma) \\\\\n\u0026amp;\\\\\n\u0026amp;= \\prod_{i = 1}^N \\prod_{k = 1}^K \\bigl[\\pi_kN(\\boldsymbol x_i \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k) \\bigr]^{z_{ik}}\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e最尤推定値を求めるために対数尤度に変形します．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{align}\n\\tilde{L} \u0026amp;= \\ln p(\\boldsymbol Y \\ | \\ \\boldsymbol \\pi, \\ \\boldsymbol \\mu, \\ \\boldsymbol \\Sigma) \\\\\n\u0026amp;\\\\\n\u0026amp;= \\sum_{i = 1}^N \\sum_{k = 1}^K z_{ik} \\ln \\pi_k + \\sum_{i = 1}^N \\sum_{k = 1}^K z_{ik} \\ln N(\\boldsymbol x_i \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k) \\\\\n\u0026amp;\\\\\n\u0026amp;= \\sum_{i = 1}^N \\sum_{k = 1}^K z_{ik} \\ln \\pi_k + \\sum_{i = 1}^N \\sum_{k = 1}^K z_{ik} \\bigl(-\\frac{d}{2}\\ln (2\\pi) + \\frac{1}{2} \\ln \\bigl|\\boldsymbol \\Sigma_k \\bigr|^{-1} - \\frac{1}{2}(\\boldsymbol x_i - \\boldsymbol \\mu_k)^T \\boldsymbol \\Sigma_k^{-1}(\\boldsymbol x_i - \\boldsymbol \\mu_k) \\bigr)\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e対数尤度の隠れ変数に関する期待値をとります．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{align}\nL \u0026amp;= E_z \\bigl\\{\\tilde{L} \\bigr\\} \\\\\n\u0026amp;\\\\\n\u0026amp;= \\sum_{i = 1}^N \\sum_{k = 1}^K E_{z_{ik}} \\bigl\\{z_{ik} \\bigr\\} \\ln \\pi_k + \\sum_{i = 1}^N \\sum_{k = 1}^K E_{z_{ik}} \\bigl\\{z_{ik} \\bigr\\} \\bigl(-\\frac{d}{2}\\ln (2\\pi) + \\frac{1}{2} \\ln \\bigl|\\boldsymbol \\Sigma_k \\bigr|^{-1} - \\frac{1}{2}(\\boldsymbol x_i - \\boldsymbol \\mu_k)^T \\boldsymbol \\Sigma_k^{-1}(\\boldsymbol x_i - \\boldsymbol \\mu_k) \\bigr)\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e隠れ変数に関する期待値は，式(*)より以下のようになり，隠れ変数の事後確率となります．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\\begin{align}\nE_{z_{ik}} \\bigl\\{z_{ik} \\bigr\\} \u0026amp;= \\sum_{z_{ik} = \\{0, 1\\}} z_{ik}p(z_{ik} \\ | \\ \\boldsymbol x_i, \\pi_k, \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k) \\\\\n\u0026amp;\\\\\n\u0026amp;= 1 \\times p(z_{ik} = 1 \\ | \\ \\boldsymbol x_i) \\\\\n\u0026amp;\\\\\n\u0026amp; = \\frac{p(z_{ik} = 1)p(\\boldsymbol x_i \\ | \\ z_{ik} = 1)}{\\sum_{j = 1}^K p(z_{ij} = 1)p(\\boldsymbol x \\ | \\ z_{ij} = 1)} \\\\\n\u0026amp;\\\\\n\u0026amp;= \\frac{\\pi_kN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k)}{\\sum_{j = 1}^K \\pi_jN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_j, \\boldsymbol \\Sigma_j)} \\\\\n\u0026amp;\\\\\n\u0026amp;= \\gamma(z_{ik})\n\\end{align}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e$L$ の隠れ変数の期待値を事後確率で置換した関数を \u003cstrong\u003eQ関数\u003c/strong\u003e と呼びます．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"math\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003eQ = \\sum_{i = 1}^N \\sum_{k = 1}^K \\gamma(z_{ik}) \\ln \\pi_k + \\sum_{i = 1}^N \\sum_{k = 1}^K \\gamma(z_{ik}) \\ln \\pi_k \\bigl(-\\frac{d}{2}\\ln (2\\pi) + \\frac{1}{2} \\ln \\bigl|\\boldsymbol \\Sigma_k \\bigr|^{-1} - \\frac{1}{2}(\\boldsymbol x_i - \\boldsymbol \\mu_k)^T \\boldsymbol \\Sigma_k^{-1}(\\boldsymbol x_i - \\boldsymbol \\mu_k) \\bigr)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"emアルゴリズムによるパラメータ推定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#em%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0%E3%81%AB%E3%82%88%E3%82%8B%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eEMアルゴリズムによるパラメータ推定\u003c/h1\u003e\n\n\u003cp\u003e隠れ変数がある確率モデルのパラメータの最尤推定値を求める手法として \u003cstrong\u003eEMアルゴリズム\u003c/strong\u003e を用います．\u003cbr\u003e\nEMアルゴリズムは2つのステップで構成されます．\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eExpectationステップ：隠れ変数に関する期待値を取る操作．モデルパラメータを固定して隠れ変数の事後確率を求める．\u003c/li\u003e\n\u003cli\u003eMaximizationステップ：Eステップで求めた隠れ変数の事後確率を用いてQ関数を最大にするモデルパラメータを求める．\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eEMアルゴリズムは完全データの対数尤度に変化がなくなるまで，EステップおよびMステップを繰り返します．\u003cbr\u003e\n収束値は初期値に依存するため，局所最適解しか得られません．\u003cbr\u003e\n初期値を変えて複数回EMアルゴリズムを使って最尤推定値を求め，その中から良いものを選択する必要があります．\u003cbr\u003e\nEMアルゴリズムをまとめると，次のようになります．\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e$\\pi_k, \\ \\boldsymbol \\mu_k, \\ \\boldsymbol \\Sigma_k$ の初期化\u003c/li\u003e\n\u003cli\u003eEステップ：現在のパラメータ $\\pi_k, \\ \\boldsymbol \\mu_k, \\ \\boldsymbol \\Sigma_k$ を用いた事後確率 $\\gamma(z_{ik})$ の推定\u003cbr\u003e\n$$\\gamma(z_{ik}) = \\frac{\\pi_kN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_k, \\boldsymbol \\Sigma_k)}{\\sum_{j = 1}^K \\pi_jN(\\boldsymbol x \\ | \\ \\boldsymbol \\mu_j, \\boldsymbol \\Sigma_j)}$$\u003c/li\u003e\n\u003cli\u003eMステップ：推定した $\\gamma(z_{ik})$ を用いたモデルパラメータの再推定\u003cbr\u003e\n$$\n\\begin{align}\n\u0026amp; N_k = \\sum_{i = 1}^N \\gamma(z_{ik})  \\\\\n\u0026amp; \\\\\n\u0026amp; \\boldsymbol \\mu_k = \\frac{1}{N_k} \\sum_{i = 1}^N \\gamma(z_{ik}) \\boldsymbol x_i  \\\\\n\u0026amp; \\\\\n\u0026amp; \\boldsymbol \\Sigma_k = \\frac{1}{N_k} \\sum_{i = 1}^N \\gamma(z_{ik}) (\\boldsymbol x_i - \\boldsymbol \\mu_k)(\\boldsymbol x_i - \\boldsymbol \\mu_k)^T  \\\\\n\u0026amp; \\\\\n\u0026amp; \\pi_k = \\frac{N_k}{N}\u003cbr\u003e\n\\end{align}\n$$\u003c/li\u003e\n\u003cli\u003e終了判定：完全データの対数尤度が収束していない場合2.から再計算．収束していれば終了．\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"pythonでの実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#python%E3%81%A7%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003epythonでの実装\u003c/h1\u003e\n\n\u003cp\u003e以下のように実装しました．\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"python\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003emixturesofgaussian.py\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003enumpy\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003ematplotlib\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003epyplot\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003esys\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecreate_data\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[],\u003c/span\u003e \u003cspan class=\"p\"\u003e[],\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eloc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mf\"\u003e10.0\u003c/span\u003e \u003cspan class=\"c1\"\u003e# range: -5.0 - 5.0\n\u003c/span\u003e        \u003cspan class=\"n\"\u003escale\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mf\"\u003e3.0\u003c/span\u003e \u003cspan class=\"c1\"\u003e# range: 0.0 - 3.0\n\u003c/span\u003e        \u003cspan class=\"n\"\u003eX\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enormal\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eloc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eloc\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003escale\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003escale\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eN\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emu_star\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eloc\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003escale\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003egaussian\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eexp\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esqrt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ef\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eestimate_posterior_likelihood\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egf\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"n\"\u003el\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ezeros\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003eenumerate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003el\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e:]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003el\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evectorize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003elambda\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"n\"\u003el\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eestimate_gmm_parameter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eN\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003emu\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egamma\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003eN\u003c/span\u003e\n    \u003cspan class=\"n\"\u003esigma\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egamma\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereshape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaxis\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003eN\u003c/span\u003e\n    \u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eN\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecalc_Q\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eQ\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egamma\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e\u003cspan class=\"p\"\u003e)))).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003eenumerate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eQ\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e:]\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e**\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eQ\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003e__name__\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e'__main__'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e# data\n\u003c/span\u003e    \u003cspan class=\"n\"\u003eK\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eN\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1000\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eK\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecreate_data\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e# termination condition\n\u003c/span\u003e    \u003cspan class=\"n\"\u003eepsilon\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.000001\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e# initialize gmm parameter\n\u003c/span\u003e    \u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003emu\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandn\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003esigma\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003eabs\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erandn\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eQ\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003esys\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efloat_info\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003emax\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e# EM algorithm\n\u003c/span\u003e    \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e \u003cspan class=\"ow\"\u003eor\u003c/span\u003e \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"n\"\u003eepsilon\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003egf\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egaussian\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# E step: estimate posterior probability of hidden variable gamma\n\u003c/span\u003e        \u003cspan class=\"n\"\u003egamma\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eestimate_posterior_likelihood\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egf\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# M step: miximize Q function by estimating mu, sigma and pi\n\u003c/span\u003e        \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eestimate_gmm_parameter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"c1\"\u003e# calculate Q function\n\u003c/span\u003e        \u003cspan class=\"n\"\u003eQ_new\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecalc_Q\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egamma\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edelta\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eQ_new\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003eQ\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eQ\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eQ_new\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e# result\n\u003c/span\u003e    \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"sa\"\u003eu\u003c/span\u003e\u003cspan class=\"s\"\u003e'mu*: %s, simga*: %s'\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earound\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e))),\u003c/span\u003e \u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earound\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esigma_star\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e))))\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"sa\"\u003eu\u003c/span\u003e\u003cspan class=\"s\"\u003e'mu : %s, sgima : %s'\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earound\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e))),\u003c/span\u003e \u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earound\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e))))\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e# plot\n\u003c/span\u003e    \u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebins\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epyplot\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehist\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e50\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003enormed\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ealpha\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eseq\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003earange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e15\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e15\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.02\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eK\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003epyplot\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eplot\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eseq\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egaussian\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emu\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003esigma\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e])(\u003c/span\u003e\u003cspan class=\"n\"\u003eseq\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003elinewidth\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e2.0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003epyplot\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esavefig\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e'gmm_graph.png'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003epyplot\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshow\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"結果\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B5%90%E6%9E%9C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e結果\u003c/h1\u003e\n\n\u003cp\u003e以下のような結果が得られました．\u003cbr\u003e\n妥当な推定ができていそうです．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://camo.qiitausercontent.com/6705b6b07c1ef715e568be76aa00a4025447b58c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f38323532372f62323232353966642d333438642d383238652d666339302d6663623539333162333565362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg width=\"600\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F82527%2Fb22259fd-348d-828e-fc90-fcb5931b35e6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=5d4abd0202383ea56c5a540ef89563e7\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/82527/b22259fd-348d-828e-fc90-fcb5931b35e6.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F82527%2Fb22259fd-348d-828e-fc90-fcb5931b35e6.png?ixlib=rb-4.0.0\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=173846dbc77d16b2119919f2db253e25 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"おわりに\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eおわりに\u003c/h1\u003e\n\n\u003cp\u003epythonで混合正規分布を実装することができました．\u003cbr\u003e\nMステップにおける各パラメータの導出方法やEMアルゴリズムの性質など理解できていない部分があるので，\u003cbr\u003e\n今後勉強して追記します．\u003c/p\u003e\n","createdAt":"2016-08-01T02:19:33Z","elapsedYearsFromLastModifiedAt":5,"encryptedId":"aee+k5q1IX/fvYAC0bM9HuCB/VP/fTsy--lXoznHkm+h7hdVL0--skK+/Q9kwIOIAuJNIhE6QA==","isBanned":false,"isDeprecated":true,"isDestroyableByViewer":false,"isEditRequestReadableByViewer":true,"isEditRequestSendableByViewer":true,"isLikableByViewer":true,"isLikedByViewer":false,"isPublic":true,"isSlide":false,"isStockableByViewer":true,"isStockedByViewer":false,"isSubscribableByViewer":false,"isSubscribedByViewer":false,"isUpdatableByViewer":false,"isUpdated":true,"lastModifiedAt":"2016-12-05T12:14:50Z","likesCount":77,"linkUrl":"https://qiita.com/taka256/items/3e8b127620ac92a32864","organization":{"description":"We delight people beyond their wildest dreams.","encryptedId":"zafTCV8o01fIYbPJQhHsz7pSaA2ucweq7x8=--MZ2mMqN2TXFJr6zd--BkOoCUs87fMMO+SsV6r5zA==","isFollowableByViewer":true,"isFollowedByViewer":false,"logoUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/77fe0bc145892664d307e63dcfbc7a381345ca47/original.jpg?1539161148","name":"株式会社ディー・エヌ・エー","url":"https://dena.com/jp/","urlName":"dena_coltd"},"stockedCount":67,"title":"pythonで混合正規分布実装","toc":"\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"\u003eはじめに\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83\"\u003e混合正規分布\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"#%E6%B7%B7%E5%90%88%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%83%A2%E3%83%87%E3%83%AB\"\u003e混合正規分布モデル\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E9%9A%A0%E3%82%8C%E5%A4%89%E6%95%B0%E3%81%A8%E4%BA%8B%E5%BE%8C%E7%A2%BA%E7%8E%87\"\u003e隠れ変数と事後確率\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E5%AF%BE%E6%95%B0%E5%B0%A4%E5%BA%A6%E3%81%A8q%E9%96%A2%E6%95%B0\"\u003e対数尤度とQ関数\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#em%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0%E3%81%AB%E3%82%88%E3%82%8B%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%8E%A8%E5%AE%9A\"\u003eEMアルゴリズムによるパラメータ推定\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#python%E3%81%A7%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003epythonでの実装\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E7%B5%90%E6%9E%9C\"\u003e結果\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"\u003eおわりに\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","totalPv":26595,"uuid":"3e8b127620ac92a32864","banReason":null,"adventCalendarItem":null,"author":{"encryptedId":"GOlDq/QJ0VpiAQzGJq8tT3n1hlU=--7kXBc8bG27CzYhcm--ompo0Gq4R7Avt5VJq3K+GA==","originalId":82527,"description":"","facebookUrl":null,"githubUrl":"https://github.com/shota-takayama","isBlockingViewer":false,"isFollowableByViewer":true,"isFollowedByViewer":false,"isTweetWebNotificationReceivable":true,"linkedinUrl":null,"name":"ta-ka","profileImageUrl":"https://qiita-image-store.s3.amazonaws.com/0/82527/profile-images/1473702483","profileImageUrlW48":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F82527%2Fprofile-images%2F1473702483?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=48\u0026s=470c586311b6245a8c74b3a8c359c643","profileImageUrlW75":"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F82527%2Fprofile-images%2F1473702483?ixlib=rb-4.0.0\u0026auto=compress%2Cformat\u0026lossless=0\u0026w=75\u0026s=788d3bbf0da2db131c8f9a34b13c9400","urlName":"taka256","websiteUrl":"","twitterUrl":"https://twitter.com/shota_takayama","twitterUrlName":"shota_takayama","revealedOrganizations":{"edges":[{"node":{"encryptedId":"UyqKxFG0Knce6SsWVh3fGpbKfMYWwdNWPOs=--Vctt1DH1MO4gOI5T--QEPqzPBdZmyVuqMHXSl26Q==","isFollowableByViewer":true,"isFollowedByViewer":false,"name":"株式会社ディー・エヌ・エー","logoUrl":"https://s3-ap-northeast-1.amazonaws.com/qiita-organization-image/77fe0bc145892664d307e63dcfbc7a381345ca47/original.jpg?1539161148","urlName":"dena_coltd","description":"We delight people beyond their wildest dreams.","url":"https://dena.com/jp/"}}]}},"tags":[{"name":"Python","urlName":"python"},{"name":"機械学習","urlName":"%e6%a9%9f%e6%a2%b0%e5%ad%a6%e7%bf%92"}],"followingLikers":{"edges":[]},"comments":{"totalCount":0}},"comments":[],"client":null,"adsEventEmitter":null}}</script><iframe src="./pythonで混合正規分布実装 - Qiita_files/container.html" style="visibility: hidden; display: none;"></iframe></div><iframe name="google_ads_top_frame" id="google_ads_top_frame" style="display: none; position: fixed; left: -999px; top: -999px; width: 0px; height: 0px;" src="./pythonで混合正規分布実装 - Qiita_files/saved_resource(3).html"></iframe><div id="itm_4330" style="visibility: hidden; display: none;"></div><img src="./pythonで混合正規分布実装 - Qiita_files/pixel" width="1" height="1" style="display: none;"><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size3, sans-serif;"></div></div><img src="./pythonで混合正規分布実装 - Qiita_files/rep" style="display: none;"><iframe src="./pythonで混合正規分布実装 - Qiita_files/pixel.html" style="display: none;"></iframe><iframe src="./pythonで混合正規分布実装 - Qiita_files/pixel(1).html" style="display: none;"></iframe><iframe src="./pythonで混合正規分布実装 - Qiita_files/pixel(2).html" style="display: none;"></iframe><iframe src="./pythonで混合正規分布実装 - Qiita_files/pixel(3).html" style="display: none;"></iframe><iframe src="./pythonで混合正規分布実装 - Qiita_files/pixel(4).html" style="display: none;"></iframe><iframe src="./pythonで混合正規分布実装 - Qiita_files/aframe.html" width="0" height="0" style="display: none;"></iframe></body></html>